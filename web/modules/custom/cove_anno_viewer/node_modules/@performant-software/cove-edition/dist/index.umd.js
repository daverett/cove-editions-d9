(function(At,W){typeof exports=="object"&&typeof module<"u"?W(exports,require("react"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","react-dom"],W):(At=typeof globalThis<"u"?globalThis:At||self,W(At["cove-edition"]={},At.React,At.ReactDOM))})(this,function(At,W,_s){"use strict";function si(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const n in e)if(n!=="default"){const r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:()=>e[n]})}}return t.default=e,Object.freeze(t)}const D=si(W),li=si(_s);var to={exports:{}},pn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ci;function Ps(){if(ci)return pn;ci=1;var e=W,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(l,c,u){var d,f={},p=null,h=null;u!==void 0&&(p=""+u),c.key!==void 0&&(p=""+c.key),c.ref!==void 0&&(h=c.ref);for(d in c)r.call(c,d)&&!i.hasOwnProperty(d)&&(f[d]=c[d]);if(l&&l.defaultProps)for(d in c=l.defaultProps,c)f[d]===void 0&&(f[d]=c[d]);return{$$typeof:t,type:l,key:p,ref:h,props:f,_owner:o.current}}return pn.Fragment=n,pn.jsx=s,pn.jsxs=s,pn}var hn={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ui;function js(){return ui||(ui=1,process.env.NODE_ENV!=="production"&&function(){var e=W,t=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.for("react.offscreen"),m=Symbol.iterator,v="@@iterator";function w(a){if(a===null||typeof a!="object")return null;var y=m&&a[m]||a[v];return typeof y=="function"?y:null}var b=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function g(a){{for(var y=arguments.length,E=new Array(y>1?y-1:0),k=1;k<y;k++)E[k-1]=arguments[k];x("error",a,E)}}function x(a,y,E){{var k=b.ReactDebugCurrentFrame,U=k.getStackAddendum();U!==""&&(y+="%s",E=E.concat([U]));var V=E.map(function(I){return String(I)});V.unshift("Warning: "+y),Function.prototype.apply.call(console[a],console,V)}}var S=!1,A=!1,P=!1,_=!1,C=!1,M;M=Symbol.for("react.module.reference");function R(a){return!!(typeof a=="string"||typeof a=="function"||a===r||a===i||C||a===o||a===u||a===d||_||a===h||S||A||P||typeof a=="object"&&a!==null&&(a.$$typeof===p||a.$$typeof===f||a.$$typeof===s||a.$$typeof===l||a.$$typeof===c||a.$$typeof===M||a.getModuleId!==void 0))}function O(a,y,E){var k=a.displayName;if(k)return k;var U=y.displayName||y.name||"";return U!==""?E+"("+U+")":E}function $(a){return a.displayName||"Context"}function T(a){if(a==null)return null;if(typeof a.tag=="number"&&g("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case r:return"Fragment";case n:return"Portal";case i:return"Profiler";case o:return"StrictMode";case u:return"Suspense";case d:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case l:var y=a;return $(y)+".Consumer";case s:var E=a;return $(E._context)+".Provider";case c:return O(a,a.render,"ForwardRef");case f:var k=a.displayName||null;return k!==null?k:T(a.type)||"Memo";case p:{var U=a,V=U._payload,I=U._init;try{return T(I(V))}catch{return null}}}return null}var j=Object.assign,L=0,Y,q,X,K,ne,Z,ue;function Ae(){}Ae.__reactDisabledLog=!0;function Re(){{if(L===0){Y=console.log,q=console.info,X=console.warn,K=console.error,ne=console.group,Z=console.groupCollapsed,ue=console.groupEnd;var a={configurable:!0,enumerable:!0,value:Ae,writable:!0};Object.defineProperties(console,{info:a,log:a,warn:a,error:a,group:a,groupCollapsed:a,groupEnd:a})}L++}}function ae(){{if(L--,L===0){var a={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:j({},a,{value:Y}),info:j({},a,{value:q}),warn:j({},a,{value:X}),error:j({},a,{value:K}),group:j({},a,{value:ne}),groupCollapsed:j({},a,{value:Z}),groupEnd:j({},a,{value:ue})})}L<0&&g("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var fe=b.ReactCurrentDispatcher,he;function J(a,y,E){{if(he===void 0)try{throw Error()}catch(U){var k=U.stack.trim().match(/\n( *(at )?)/);he=k&&k[1]||""}return`
`+he+a}}var H=!1,Q;{var re=typeof WeakMap=="function"?WeakMap:Map;Q=new re}function ee(a,y){if(!a||H)return"";{var E=Q.get(a);if(E!==void 0)return E}var k;H=!0;var U=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var V;V=fe.current,fe.current=null,Re();try{if(y){var I=function(){throw Error()};if(Object.defineProperty(I.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(I,[])}catch(oe){k=oe}Reflect.construct(a,[],I)}else{try{I.call()}catch(oe){k=oe}a.call(I.prototype)}}else{try{throw Error()}catch(oe){k=oe}a()}}catch(oe){if(oe&&k&&typeof oe.stack=="string"){for(var N=oe.stack.split(`
`),te=k.stack.split(`
`),z=N.length-1,G=te.length-1;z>=1&&G>=0&&N[z]!==te[G];)G--;for(;z>=1&&G>=0;z--,G--)if(N[z]!==te[G]){if(z!==1||G!==1)do if(z--,G--,G<0||N[z]!==te[G]){var le=`
`+N[z].replace(" at new "," at ");return a.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",a.displayName)),typeof a=="function"&&Q.set(a,le),le}while(z>=1&&G>=0);break}}}finally{H=!1,fe.current=V,ae(),Error.prepareStackTrace=U}var Oe=a?a.displayName||a.name:"",Ee=Oe?J(Oe):"";return typeof a=="function"&&Q.set(a,Ee),Ee}function ie(a,y,E){return ee(a,!1)}function pe(a){var y=a.prototype;return!!(y&&y.isReactComponent)}function ce(a,y,E){if(a==null)return"";if(typeof a=="function")return ee(a,pe(a));if(typeof a=="string")return J(a);switch(a){case u:return J("Suspense");case d:return J("SuspenseList")}if(typeof a=="object")switch(a.$$typeof){case c:return ie(a.render);case f:return ce(a.type,y,E);case p:{var k=a,U=k._payload,V=k._init;try{return ce(V(U),y,E)}catch{}}}return""}var se=Object.prototype.hasOwnProperty,Te={},_e=b.ReactDebugCurrentFrame;function Ce(a){if(a){var y=a._owner,E=ce(a.type,a._source,y?y.type:null);_e.setExtraStackFrame(E)}else _e.setExtraStackFrame(null)}function ut(a,y,E,k,U){{var V=Function.call.bind(se);for(var I in a)if(V(a,I)){var N=void 0;try{if(typeof a[I]!="function"){var te=Error((k||"React class")+": "+E+" type `"+I+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof a[I]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw te.name="Invariant Violation",te}N=a[I](y,I,k,E,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(z){N=z}N&&!(N instanceof Error)&&(Ce(U),g("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",k||"React class",E,I,typeof N),Ce(null)),N instanceof Error&&!(N.message in Te)&&(Te[N.message]=!0,Ce(U),g("Failed %s type: %s",E,N.message),Ce(null))}}}var qe=Array.isArray;function ke(a){return qe(a)}function _t(a){{var y=typeof Symbol=="function"&&Symbol.toStringTag,E=y&&a[Symbol.toStringTag]||a.constructor.name||"Object";return E}}function Xn(a){try{return Pt(a),!1}catch{return!0}}function Pt(a){return""+a}function jt(a){if(Xn(a))return g("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",_t(a)),Pt(a)}var Fe=b.ReactCurrentOwner,zn={key:!0,ref:!0,__self:!0,__source:!0},Nt,Lt,Qe;Qe={};function qn(a){if(se.call(a,"ref")){var y=Object.getOwnPropertyDescriptor(a,"ref").get;if(y&&y.isReactWarning)return!1}return a.ref!==void 0}function Gn(a){if(se.call(a,"key")){var y=Object.getOwnPropertyDescriptor(a,"key").get;if(y&&y.isReactWarning)return!1}return a.key!==void 0}function Jn(a,y){if(typeof a.ref=="string"&&Fe.current&&y&&Fe.current.stateNode!==y){var E=T(Fe.current.type);Qe[E]||(g('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',T(Fe.current.type),a.ref),Qe[E]=!0)}}function Zn(a,y){{var E=function(){Nt||(Nt=!0,g("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",y))};E.isReactWarning=!0,Object.defineProperty(a,"key",{get:E,configurable:!0})}}function Qn(a,y){{var E=function(){Lt||(Lt=!0,g("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",y))};E.isReactWarning=!0,Object.defineProperty(a,"ref",{get:E,configurable:!0})}}var er=function(a,y,E,k,U,V,I){var N={$$typeof:t,type:a,key:y,ref:E,props:I,_owner:V};return N._store={},Object.defineProperty(N._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(N,"_self",{configurable:!1,enumerable:!1,writable:!1,value:k}),Object.defineProperty(N,"_source",{configurable:!1,enumerable:!1,writable:!1,value:U}),Object.freeze&&(Object.freeze(N.props),Object.freeze(N)),N};function tr(a,y,E,k,U){{var V,I={},N=null,te=null;E!==void 0&&(jt(E),N=""+E),Gn(y)&&(jt(y.key),N=""+y.key),qn(y)&&(te=y.ref,Jn(y,U));for(V in y)se.call(y,V)&&!zn.hasOwnProperty(V)&&(I[V]=y[V]);if(a&&a.defaultProps){var z=a.defaultProps;for(V in z)I[V]===void 0&&(I[V]=z[V])}if(N||te){var G=typeof a=="function"?a.displayName||a.name||"Unknown":a;N&&Zn(I,G),te&&Qn(I,G)}return er(a,N,te,U,k,Fe.current,I)}}var et=b.ReactCurrentOwner,It=b.ReactDebugCurrentFrame;function Se(a){if(a){var y=a._owner,E=ce(a.type,a._source,y?y.type:null);It.setExtraStackFrame(E)}else It.setExtraStackFrame(null)}var tt;tt=!1;function nt(a){return typeof a=="object"&&a!==null&&a.$$typeof===t}function Dt(){{if(et.current){var a=T(et.current.type);if(a)return`

Check the render method of \``+a+"`."}return""}}function nr(a){return""}var Mt={};function rr(a){{var y=Dt();if(!y){var E=typeof a=="string"?a:a.displayName||a.name;E&&(y=`

Check the top-level render call using <`+E+">.")}return y}}function Ft(a,y){{if(!a._store||a._store.validated||a.key!=null)return;a._store.validated=!0;var E=rr(y);if(Mt[E])return;Mt[E]=!0;var k="";a&&a._owner&&a._owner!==et.current&&(k=" It was passed a child from "+T(a._owner.type)+"."),Se(a),g('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',E,k),Se(null)}}function Bt(a,y){{if(typeof a!="object")return;if(ke(a))for(var E=0;E<a.length;E++){var k=a[E];nt(k)&&Ft(k,y)}else if(nt(a))a._store&&(a._store.validated=!0);else if(a){var U=w(a);if(typeof U=="function"&&U!==a.entries)for(var V=U.call(a),I;!(I=V.next()).done;)nt(I.value)&&Ft(I.value,y)}}}function or(a){{var y=a.type;if(y==null||typeof y=="string")return;var E;if(typeof y=="function")E=y.propTypes;else if(typeof y=="object"&&(y.$$typeof===c||y.$$typeof===f))E=y.propTypes;else return;if(E){var k=T(y);ut(E,a.props,"prop",k,a)}else if(y.PropTypes!==void 0&&!tt){tt=!0;var U=T(y);g("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",U||"Unknown")}typeof y.getDefaultProps=="function"&&!y.getDefaultProps.isReactClassApproved&&g("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function ir(a){{for(var y=Object.keys(a.props),E=0;E<y.length;E++){var k=y[E];if(k!=="children"&&k!=="key"){Se(a),g("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",k),Se(null);break}}a.ref!==null&&(Se(a),g("Invalid attribute `ref` supplied to `React.Fragment`."),Se(null))}}var Ut={};function Vt(a,y,E,k,U,V){{var I=R(a);if(!I){var N="";(a===void 0||typeof a=="object"&&a!==null&&Object.keys(a).length===0)&&(N+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var te=nr();te?N+=te:N+=Dt();var z;a===null?z="null":ke(a)?z="array":a!==void 0&&a.$$typeof===t?(z="<"+(T(a.type)||"Unknown")+" />",N=" Did you accidentally export a JSX literal instead of a component?"):z=typeof a,g("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",z,N)}var G=tr(a,y,E,U,V);if(G==null)return G;if(I){var le=y.children;if(le!==void 0)if(k)if(ke(le)){for(var Oe=0;Oe<le.length;Oe++)Bt(le[Oe],a);Object.freeze&&Object.freeze(le)}else g("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Bt(le,a)}if(se.call(y,"key")){var Ee=T(a),oe=Object.keys(y).filter(function(fr){return fr!=="key"}),rt=oe.length>0?"{key: someKey, "+oe.join(": ..., ")+": ...}":"{key: someKey}";if(!Ut[Ee+rt]){var ur=oe.length>0?"{"+oe.join(": ..., ")+": ...}":"{}";g(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,rt,Ee,ur,Ee),Ut[Ee+rt]=!0}}return a===r?ir(G):or(G),G}}function ar(a,y,E){return Vt(a,y,E,!0)}function sr(a,y,E){return Vt(a,y,E,!1)}var lr=sr,cr=ar;hn.Fragment=r,hn.jsx=lr,hn.jsxs=cr}()),hn}process.env.NODE_ENV==="production"?to.exports=Ps():to.exports=js();var F=to.exports,no={exports:{}},gn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fi;function Ns(){if(fi)return gn;fi=1;var e=W,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(l,c,u){var d,f={},p=null,h=null;u!==void 0&&(p=""+u),c.key!==void 0&&(p=""+c.key),c.ref!==void 0&&(h=c.ref);for(d in c)r.call(c,d)&&!i.hasOwnProperty(d)&&(f[d]=c[d]);if(l&&l.defaultProps)for(d in c=l.defaultProps,c)f[d]===void 0&&(f[d]=c[d]);return{$$typeof:t,type:l,key:p,ref:h,props:f,_owner:o.current}}return gn.Fragment=n,gn.jsx=s,gn.jsxs=s,gn}var mn={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var di;function Ls(){return di||(di=1,process.env.NODE_ENV!=="production"&&function(){var e=W,t=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.for("react.offscreen"),m=Symbol.iterator,v="@@iterator";function w(a){if(a===null||typeof a!="object")return null;var y=m&&a[m]||a[v];return typeof y=="function"?y:null}var b=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function g(a){{for(var y=arguments.length,E=new Array(y>1?y-1:0),k=1;k<y;k++)E[k-1]=arguments[k];x("error",a,E)}}function x(a,y,E){{var k=b.ReactDebugCurrentFrame,U=k.getStackAddendum();U!==""&&(y+="%s",E=E.concat([U]));var V=E.map(function(I){return String(I)});V.unshift("Warning: "+y),Function.prototype.apply.call(console[a],console,V)}}var S=!1,A=!1,P=!1,_=!1,C=!1,M;M=Symbol.for("react.module.reference");function R(a){return!!(typeof a=="string"||typeof a=="function"||a===r||a===i||C||a===o||a===u||a===d||_||a===h||S||A||P||typeof a=="object"&&a!==null&&(a.$$typeof===p||a.$$typeof===f||a.$$typeof===s||a.$$typeof===l||a.$$typeof===c||a.$$typeof===M||a.getModuleId!==void 0))}function O(a,y,E){var k=a.displayName;if(k)return k;var U=y.displayName||y.name||"";return U!==""?E+"("+U+")":E}function $(a){return a.displayName||"Context"}function T(a){if(a==null)return null;if(typeof a.tag=="number"&&g("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case r:return"Fragment";case n:return"Portal";case i:return"Profiler";case o:return"StrictMode";case u:return"Suspense";case d:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case l:var y=a;return $(y)+".Consumer";case s:var E=a;return $(E._context)+".Provider";case c:return O(a,a.render,"ForwardRef");case f:var k=a.displayName||null;return k!==null?k:T(a.type)||"Memo";case p:{var U=a,V=U._payload,I=U._init;try{return T(I(V))}catch{return null}}}return null}var j=Object.assign,L=0,Y,q,X,K,ne,Z,ue;function Ae(){}Ae.__reactDisabledLog=!0;function Re(){{if(L===0){Y=console.log,q=console.info,X=console.warn,K=console.error,ne=console.group,Z=console.groupCollapsed,ue=console.groupEnd;var a={configurable:!0,enumerable:!0,value:Ae,writable:!0};Object.defineProperties(console,{info:a,log:a,warn:a,error:a,group:a,groupCollapsed:a,groupEnd:a})}L++}}function ae(){{if(L--,L===0){var a={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:j({},a,{value:Y}),info:j({},a,{value:q}),warn:j({},a,{value:X}),error:j({},a,{value:K}),group:j({},a,{value:ne}),groupCollapsed:j({},a,{value:Z}),groupEnd:j({},a,{value:ue})})}L<0&&g("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var fe=b.ReactCurrentDispatcher,he;function J(a,y,E){{if(he===void 0)try{throw Error()}catch(U){var k=U.stack.trim().match(/\n( *(at )?)/);he=k&&k[1]||""}return`
`+he+a}}var H=!1,Q;{var re=typeof WeakMap=="function"?WeakMap:Map;Q=new re}function ee(a,y){if(!a||H)return"";{var E=Q.get(a);if(E!==void 0)return E}var k;H=!0;var U=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var V;V=fe.current,fe.current=null,Re();try{if(y){var I=function(){throw Error()};if(Object.defineProperty(I.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(I,[])}catch(oe){k=oe}Reflect.construct(a,[],I)}else{try{I.call()}catch(oe){k=oe}a.call(I.prototype)}}else{try{throw Error()}catch(oe){k=oe}a()}}catch(oe){if(oe&&k&&typeof oe.stack=="string"){for(var N=oe.stack.split(`
`),te=k.stack.split(`
`),z=N.length-1,G=te.length-1;z>=1&&G>=0&&N[z]!==te[G];)G--;for(;z>=1&&G>=0;z--,G--)if(N[z]!==te[G]){if(z!==1||G!==1)do if(z--,G--,G<0||N[z]!==te[G]){var le=`
`+N[z].replace(" at new "," at ");return a.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",a.displayName)),typeof a=="function"&&Q.set(a,le),le}while(z>=1&&G>=0);break}}}finally{H=!1,fe.current=V,ae(),Error.prepareStackTrace=U}var Oe=a?a.displayName||a.name:"",Ee=Oe?J(Oe):"";return typeof a=="function"&&Q.set(a,Ee),Ee}function ie(a,y,E){return ee(a,!1)}function pe(a){var y=a.prototype;return!!(y&&y.isReactComponent)}function ce(a,y,E){if(a==null)return"";if(typeof a=="function")return ee(a,pe(a));if(typeof a=="string")return J(a);switch(a){case u:return J("Suspense");case d:return J("SuspenseList")}if(typeof a=="object")switch(a.$$typeof){case c:return ie(a.render);case f:return ce(a.type,y,E);case p:{var k=a,U=k._payload,V=k._init;try{return ce(V(U),y,E)}catch{}}}return""}var se=Object.prototype.hasOwnProperty,Te={},_e=b.ReactDebugCurrentFrame;function Ce(a){if(a){var y=a._owner,E=ce(a.type,a._source,y?y.type:null);_e.setExtraStackFrame(E)}else _e.setExtraStackFrame(null)}function ut(a,y,E,k,U){{var V=Function.call.bind(se);for(var I in a)if(V(a,I)){var N=void 0;try{if(typeof a[I]!="function"){var te=Error((k||"React class")+": "+E+" type `"+I+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof a[I]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw te.name="Invariant Violation",te}N=a[I](y,I,k,E,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(z){N=z}N&&!(N instanceof Error)&&(Ce(U),g("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",k||"React class",E,I,typeof N),Ce(null)),N instanceof Error&&!(N.message in Te)&&(Te[N.message]=!0,Ce(U),g("Failed %s type: %s",E,N.message),Ce(null))}}}var qe=Array.isArray;function ke(a){return qe(a)}function _t(a){{var y=typeof Symbol=="function"&&Symbol.toStringTag,E=y&&a[Symbol.toStringTag]||a.constructor.name||"Object";return E}}function Xn(a){try{return Pt(a),!1}catch{return!0}}function Pt(a){return""+a}function jt(a){if(Xn(a))return g("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",_t(a)),Pt(a)}var Fe=b.ReactCurrentOwner,zn={key:!0,ref:!0,__self:!0,__source:!0},Nt,Lt,Qe;Qe={};function qn(a){if(se.call(a,"ref")){var y=Object.getOwnPropertyDescriptor(a,"ref").get;if(y&&y.isReactWarning)return!1}return a.ref!==void 0}function Gn(a){if(se.call(a,"key")){var y=Object.getOwnPropertyDescriptor(a,"key").get;if(y&&y.isReactWarning)return!1}return a.key!==void 0}function Jn(a,y){if(typeof a.ref=="string"&&Fe.current&&y&&Fe.current.stateNode!==y){var E=T(Fe.current.type);Qe[E]||(g('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',T(Fe.current.type),a.ref),Qe[E]=!0)}}function Zn(a,y){{var E=function(){Nt||(Nt=!0,g("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",y))};E.isReactWarning=!0,Object.defineProperty(a,"key",{get:E,configurable:!0})}}function Qn(a,y){{var E=function(){Lt||(Lt=!0,g("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",y))};E.isReactWarning=!0,Object.defineProperty(a,"ref",{get:E,configurable:!0})}}var er=function(a,y,E,k,U,V,I){var N={$$typeof:t,type:a,key:y,ref:E,props:I,_owner:V};return N._store={},Object.defineProperty(N._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(N,"_self",{configurable:!1,enumerable:!1,writable:!1,value:k}),Object.defineProperty(N,"_source",{configurable:!1,enumerable:!1,writable:!1,value:U}),Object.freeze&&(Object.freeze(N.props),Object.freeze(N)),N};function tr(a,y,E,k,U){{var V,I={},N=null,te=null;E!==void 0&&(jt(E),N=""+E),Gn(y)&&(jt(y.key),N=""+y.key),qn(y)&&(te=y.ref,Jn(y,U));for(V in y)se.call(y,V)&&!zn.hasOwnProperty(V)&&(I[V]=y[V]);if(a&&a.defaultProps){var z=a.defaultProps;for(V in z)I[V]===void 0&&(I[V]=z[V])}if(N||te){var G=typeof a=="function"?a.displayName||a.name||"Unknown":a;N&&Zn(I,G),te&&Qn(I,G)}return er(a,N,te,U,k,Fe.current,I)}}var et=b.ReactCurrentOwner,It=b.ReactDebugCurrentFrame;function Se(a){if(a){var y=a._owner,E=ce(a.type,a._source,y?y.type:null);It.setExtraStackFrame(E)}else It.setExtraStackFrame(null)}var tt;tt=!1;function nt(a){return typeof a=="object"&&a!==null&&a.$$typeof===t}function Dt(){{if(et.current){var a=T(et.current.type);if(a)return`

Check the render method of \``+a+"`."}return""}}function nr(a){return""}var Mt={};function rr(a){{var y=Dt();if(!y){var E=typeof a=="string"?a:a.displayName||a.name;E&&(y=`

Check the top-level render call using <`+E+">.")}return y}}function Ft(a,y){{if(!a._store||a._store.validated||a.key!=null)return;a._store.validated=!0;var E=rr(y);if(Mt[E])return;Mt[E]=!0;var k="";a&&a._owner&&a._owner!==et.current&&(k=" It was passed a child from "+T(a._owner.type)+"."),Se(a),g('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',E,k),Se(null)}}function Bt(a,y){{if(typeof a!="object")return;if(ke(a))for(var E=0;E<a.length;E++){var k=a[E];nt(k)&&Ft(k,y)}else if(nt(a))a._store&&(a._store.validated=!0);else if(a){var U=w(a);if(typeof U=="function"&&U!==a.entries)for(var V=U.call(a),I;!(I=V.next()).done;)nt(I.value)&&Ft(I.value,y)}}}function or(a){{var y=a.type;if(y==null||typeof y=="string")return;var E;if(typeof y=="function")E=y.propTypes;else if(typeof y=="object"&&(y.$$typeof===c||y.$$typeof===f))E=y.propTypes;else return;if(E){var k=T(y);ut(E,a.props,"prop",k,a)}else if(y.PropTypes!==void 0&&!tt){tt=!0;var U=T(y);g("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",U||"Unknown")}typeof y.getDefaultProps=="function"&&!y.getDefaultProps.isReactClassApproved&&g("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function ir(a){{for(var y=Object.keys(a.props),E=0;E<y.length;E++){var k=y[E];if(k!=="children"&&k!=="key"){Se(a),g("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",k),Se(null);break}}a.ref!==null&&(Se(a),g("Invalid attribute `ref` supplied to `React.Fragment`."),Se(null))}}var Ut={};function Vt(a,y,E,k,U,V){{var I=R(a);if(!I){var N="";(a===void 0||typeof a=="object"&&a!==null&&Object.keys(a).length===0)&&(N+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var te=nr();te?N+=te:N+=Dt();var z;a===null?z="null":ke(a)?z="array":a!==void 0&&a.$$typeof===t?(z="<"+(T(a.type)||"Unknown")+" />",N=" Did you accidentally export a JSX literal instead of a component?"):z=typeof a,g("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",z,N)}var G=tr(a,y,E,U,V);if(G==null)return G;if(I){var le=y.children;if(le!==void 0)if(k)if(ke(le)){for(var Oe=0;Oe<le.length;Oe++)Bt(le[Oe],a);Object.freeze&&Object.freeze(le)}else g("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Bt(le,a)}if(se.call(y,"key")){var Ee=T(a),oe=Object.keys(y).filter(function(fr){return fr!=="key"}),rt=oe.length>0?"{key: someKey, "+oe.join(": ..., ")+": ...}":"{key: someKey}";if(!Ut[Ee+rt]){var ur=oe.length>0?"{"+oe.join(": ..., ")+": ...}":"{}";g(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,rt,Ee,ur,Ee),Ut[Ee+rt]=!0}}return a===r?ir(G):or(G),G}}function ar(a,y,E){return Vt(a,y,E,!0)}function sr(a,y,E){return Vt(a,y,E,!1)}var lr=sr,cr=ar;mn.Fragment=r,mn.jsx=lr,mn.jsxs=cr}()),mn}process.env.NODE_ENV==="production"?no.exports=Ns():no.exports=Ls();var Is=no.exports;const Ds=[];for(let e=0;e<256;++e)Ds.push((e+256).toString(16).slice(1));typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Ms="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";((e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+=Ms[n[e]&63];return t})();const dr=W.createContext({anno:void 0,setAnno:void 0,annotations:[],selection:{selected:[]}}),Fs=W.forwardRef((e,t)=>{const[n,r]=W.useState(null),[o,i]=W.useState([]),[s,l]=W.useState({selected:[]});return W.useImperativeHandle(t,()=>n),W.useEffect(()=>{if(n){const{selection:c,store:u,hover:d}=n.state;u.all().length>0&&i(u.all());const f=()=>i(()=>u.all());u.observe(f);let p;const h=c.subscribe(({selected:m,...v})=>{p&&u.unobserve(p);const w=(m||[]).map(({id:b,editable:g})=>({annotation:u.getAnnotation(b),editable:g}));l({selected:w,...v}),p=b=>{const{updated:g}=b.changes;l(x=>({...x,selected:x.selected.map(({annotation:S,editable:A})=>{const P=g.find(_=>_.oldValue.id===S.id);return P?{annotation:P.newValue,editable:A}:{annotation:S,editable:A}})}))},u.observe(p,{annotations:m.map(({id:b})=>b)})});return()=>{u.unobserve(f),h()}}},[n]),Is.jsx(dr.Provider,{value:{anno:n,setAnno:r,annotations:o,selection:s},children:e.children})}),pi=()=>{const{anno:e}=W.useContext(dr);return e},hi=()=>{const{selection:e}=W.useContext(dr);return e};var Bs=Object.defineProperty,Us=(e,t,n)=>t in e?Bs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,gi=(e,t,n)=>Us(e,typeof t!="symbol"?t+"":t,n);function vn(){}function ro(e,t){for(const n in t)e[n]=t[n];return e}function mi(e){return e()}function vi(){return Object.create(null)}function ft(e){e.forEach(mi)}function Be(e){return typeof e=="function"}function pr(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Vs(e){return Object.keys(e).length===0}function Ys(e,t,n,r){if(e){const o=yi(e,t,n,r);return e[0](o)}}function yi(e,t,n,r){return e[1]&&r?ro(n.ctx.slice(),e[1](r(t))):n.ctx}function Hs(e,t,n,r){if(e[2]&&r){const o=e[2](r(n));if(t.dirty===void 0)return o;if(typeof o=="object"){const i=[],s=Math.max(t.dirty.length,o.length);for(let l=0;l<s;l+=1)i[l]=t.dirty[l]|o[l];return i}return t.dirty|o}return t.dirty}function Ws(e,t,n,r,o,i){if(o){const s=yi(t,n,r,i);e.p(s,o)}}function Ks(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let r=0;r<n;r++)t[r]=-1;return t}return-1}function bi(e){const t={};for(const n in e)n[0]!=="$"&&(t[n]=e[n]);return t}function hr(e){return e??""}function wi(e,t){e.appendChild(t)}function me(e,t,n){e.insertBefore(t,n||null)}function ge(e){e.parentNode&&e.parentNode.removeChild(e)}function Xs(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function Ue(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function xi(e){return document.createTextNode(e)}function Ge(){return xi(" ")}function Ei(){return xi("")}function Pe(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function B(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function zs(e){return Array.from(e.childNodes)}function Ai(e,t,n){e.classList.toggle(t,!!n)}function qs(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}let yn;function bn(e){yn=e}function Gs(){if(!yn)throw new Error("Function called outside component initialization");return yn}function Js(){const e=Gs();return(t,n,{cancelable:r=!1}={})=>{const o=e.$$.callbacks[t];if(o){const i=qs(t,n,{cancelable:r});return o.slice().forEach(s=>{s.call(e,i)}),!i.defaultPrevented}return!0}}function dt(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(r=>r.call(this,t))}const Jt=[],Si=[];let Zt=[];const Oi=[],Zs=Promise.resolve();let oo=!1;function Qs(){oo||(oo=!0,Zs.then(Ri))}function io(e){Zt.push(e)}const ao=new Set;let Qt=0;function Ri(){if(Qt!==0)return;const e=yn;do{try{for(;Qt<Jt.length;){const t=Jt[Qt];Qt++,bn(t),el(t.$$)}}catch(t){throw Jt.length=0,Qt=0,t}for(bn(null),Jt.length=0,Qt=0;Si.length;)Si.pop()();for(let t=0;t<Zt.length;t+=1){const n=Zt[t];ao.has(n)||(ao.add(n),n())}Zt.length=0}while(Jt.length);for(;Oi.length;)Oi.pop()();oo=!1,ao.clear(),bn(e)}function el(e){if(e.fragment!==null){e.update(),ft(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(io)}}function tl(e){const t=[],n=[];Zt.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),Zt=t}const gr=new Set;let Yt;function nl(){Yt={r:0,c:[],p:Yt}}function rl(){Yt.r||ft(Yt.c),Yt=Yt.p}function Ke(e,t){e&&e.i&&(gr.delete(e),e.i(t))}function ot(e,t,n,r){if(e&&e.o){if(gr.has(e))return;gr.add(e),Yt.c.push(()=>{gr.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function Ti(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Ht(e){e&&e.c()}function St(e,t,n){const{fragment:r,after_update:o}=e.$$;r&&r.m(t,n),io(()=>{const i=e.$$.on_mount.map(mi).filter(Be);e.$$.on_destroy?e.$$.on_destroy.push(...i):ft(i),e.$$.on_mount=[]}),o.forEach(io)}function Ot(e,t){const n=e.$$;n.fragment!==null&&(tl(n.after_update),ft(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ol(e,t){e.$$.dirty[0]===-1&&(Jt.push(e),Qs(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function mr(e,t,n,r,o,i,s=null,l=[-1]){const c=yn;bn(e);const u=e.$$={fragment:null,ctx:[],props:i,update:vn,not_equal:o,bound:vi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:vi(),dirty:l,skip_bound:!1,root:t.target||c.$$.root};s&&s(u.root);let d=!1;if(u.ctx=n?n(e,t.props||{},(f,p,...h)=>{const m=h.length?h[0]:p;return u.ctx&&o(u.ctx[f],u.ctx[f]=m)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](m),d&&ol(e,f)),p}):[],u.update(),d=!0,ft(u.before_update),u.fragment=r?r(u.ctx):!1,t.target){if(t.hydrate){const f=zs(t.target);u.fragment&&u.fragment.l(f),f.forEach(ge)}else u.fragment&&u.fragment.c();t.intro&&Ke(e.$$.fragment),St(e,t.target,t.anchor),Ri()}bn(c)}let vr=class{constructor(){gi(this,"$$"),gi(this,"$$set")}$destroy(){Ot(this,1),this.$destroy=vn}$on(t,n){if(!Be(n))return vn;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(t){this.$$set&&!Vs(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}};const il="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(il);var en=(e=>(e.ELLIPSE="ELLIPSE",e.POLYGON="POLYGON",e.RECTANGLE="RECTANGLE",e))(en||{});const so=(e,t)=>t,al=e=>{let t=1/0,n=1/0,r=-1/0,o=-1/0;return e.forEach(([i,s])=>{t=Math.min(t,i),n=Math.min(n,s),r=Math.max(r,i),o=Math.max(o,s)}),{minX:t,minY:n,maxX:r,maxY:o}},sl={area:e=>Math.PI*e.geometry.rx*e.geometry.ry,intersects:(e,t,n)=>{const{cx:r,cy:o,rx:i,ry:s}=e.geometry,l=0,c=Math.cos(l),u=Math.sin(l),d=t-r,f=n-o,p=c*d+u*f,h=u*d-c*f;return p*p/(i*i)+h*h/(s*s)<=1}};so(en.ELLIPSE,sl);const ll={area:e=>{const{points:t}=e.geometry;let n=0,r=t.length-1;for(let o=0;o<t.length;o++)n+=(t[r][0]+t[o][0])*(t[r][1]-t[o][1]),r=o;return Math.abs(.5*n)},intersects:(e,t,n)=>{const{points:r}=e.geometry;let o=!1;for(let i=0,s=r.length-1;i<r.length;s=i++){const l=r[i][0],c=r[i][1],u=r[s][0],d=r[s][1];c>n!=d>n&&t<(u-l)*(n-c)/(d-c)+l&&(o=!o)}return o}};so(en.POLYGON,ll);const cl={area:e=>e.geometry.w*e.geometry.h,intersects:(e,t,n)=>t>=e.geometry.x&&t<=e.geometry.x+e.geometry.w&&n>=e.geometry.y&&n<=e.geometry.y+e.geometry.h};so(en.RECTANGLE,cl);const ul=[];for(let e=0;e<256;++e)ul.push((e+256).toString(16).slice(1));typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const fl=[];for(let e=0;e<256;++e)fl.push((e+256).toString(16).slice(1));typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const dl="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";((e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+=dl[n[e]&63];return t})();function Ci(e,t,n){const r=e.slice();return r[10]=t[n],r[12]=n,r}function ki(e){let t,n;return t=new wn({props:{x:e[10][0],y:e[10][1],scale:e[3]}}),t.$on("pointerdown",function(){Be(e[9](`HANDLE-${e[12]}`))&&e[9](`HANDLE-${e[12]}`).apply(this,arguments)}),{c(){Ht(t.$$.fragment)},m(r,o){St(t,r,o),n=!0},p(r,o){e=r;const i={};o&16&&(i.x=e[10][0]),o&16&&(i.y=e[10][1]),o&8&&(i.scale=e[3]),t.$set(i)},i(r){n||(Ke(t.$$.fragment,r),n=!0)},o(r){ot(t.$$.fragment,r),n=!1},d(r){Ot(t,r)}}}function pl(e){let t,n,r,o,i,s,l,c,u,d,f,p=Ti(e[4].points),h=[];for(let v=0;v<p.length;v+=1)h[v]=ki(Ci(e,p,v));const m=v=>ot(h[v],1,1,()=>{h[v]=null});return{c(){t=Ue("polygon"),o=Ge(),i=Ue("polygon"),l=Ge();for(let v=0;v<h.length;v+=1)h[v].c();c=Ei(),B(t,"class","a9s-outer"),B(t,"style",n=e[1]?"display:none;":void 0),B(t,"points",r=e[4].points.map($i).join(" ")),B(i,"class","a9s-inner a9s-shape-handle"),B(i,"style",e[1]),B(i,"points",s=e[4].points.map(_i).join(" "))},m(v,w){me(v,t,w),me(v,o,w),me(v,i,w),me(v,l,w);for(let b=0;b<h.length;b+=1)h[b]&&h[b].m(v,w);me(v,c,w),u=!0,d||(f=[Pe(t,"pointerdown",function(){Be(e[9]("SHAPE"))&&e[9]("SHAPE").apply(this,arguments)}),Pe(i,"pointerdown",function(){Be(e[9]("SHAPE"))&&e[9]("SHAPE").apply(this,arguments)})],d=!0)},p(v,w){if(e=v,(!u||w&2&&n!==(n=e[1]?"display:none;":void 0))&&B(t,"style",n),(!u||w&16&&r!==(r=e[4].points.map($i).join(" ")))&&B(t,"points",r),(!u||w&2)&&B(i,"style",e[1]),(!u||w&16&&s!==(s=e[4].points.map(_i).join(" ")))&&B(i,"points",s),w&536){p=Ti(e[4].points);let b;for(b=0;b<p.length;b+=1){const g=Ci(e,p,b);h[b]?(h[b].p(g,w),Ke(h[b],1)):(h[b]=ki(g),h[b].c(),Ke(h[b],1),h[b].m(c.parentNode,c))}for(nl(),b=p.length;b<h.length;b+=1)m(b);rl()}},i(v){if(!u){for(let w=0;w<p.length;w+=1)Ke(h[w]);u=!0}},o(v){h=h.filter(Boolean);for(let w=0;w<h.length;w+=1)ot(h[w]);u=!1},d(v){v&&(ge(t),ge(o),ge(i),ge(l),ge(c)),Xs(h,v),d=!1,ft(f)}}}function hl(e){let t,n;return t=new ji({props:{shape:e[0],transform:e[2],editor:e[5],$$slots:{default:[pl,({grab:r})=>({9:r}),({grab:r})=>r?512:0]},$$scope:{ctx:e}}}),t.$on("change",e[6]),t.$on("grab",e[7]),t.$on("release",e[8]),{c(){Ht(t.$$.fragment)},m(r,o){St(t,r,o),n=!0},p(r,[o]){const i={};o&1&&(i.shape=r[0]),o&4&&(i.transform=r[2]),o&8730&&(i.$$scope={dirty:o,ctx:r}),t.$set(i)},i(r){n||(Ke(t.$$.fragment,r),n=!0)},o(r){ot(t.$$.fragment,r),n=!1},d(r){Ot(t,r)}}}const $i=e=>e.join(","),_i=e=>e.join(",");function gl(e,t,n){let r,{shape:o}=t,{computedStyle:i}=t,{transform:s}=t,{viewportScale:l=1}=t;const c=(p,h,m)=>{let v;const w=p.geometry;h==="SHAPE"?v=w.points.map(([g,x])=>[g+m[0],x+m[1]]):v=w.points.map(([g,x],S)=>h===`HANDLE-${S}`?[g+m[0],x+m[1]]:[g,x]);const b=al(v);return{...p,geometry:{points:v,bounds:b}}};function u(p){dt.call(this,e,p)}function d(p){dt.call(this,e,p)}function f(p){dt.call(this,e,p)}return e.$$set=p=>{"shape"in p&&n(0,o=p.shape),"computedStyle"in p&&n(1,i=p.computedStyle),"transform"in p&&n(2,s=p.transform),"viewportScale"in p&&n(3,l=p.viewportScale)},e.$$.update=()=>{e.$$.dirty&1&&n(4,r=o.geometry)},[o,i,s,l,r,c,u,d,f]}class ml extends vr{constructor(t){super(),mr(this,t,gl,hl,pr,{shape:0,computedStyle:1,transform:2,viewportScale:3})}}const vl=typeof window>"u"||typeof navigator>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;function yl(e){let t,n,r,o,i,s;return{c(){t=Ue("rect"),B(t,"class",n=hr(`a9s-handle ${e[8].class||""}`.trim())+" svelte-1sgkh33"),B(t,"x",r=e[0]-e[5]/2),B(t,"y",o=e[1]-e[5]/2),B(t,"width",e[5]),B(t,"height",e[5])},m(l,c){me(l,t,c),i||(s=Pe(t,"pointerdown",e[11]),i=!0)},p(l,c){c&256&&n!==(n=hr(`a9s-handle ${l[8].class||""}`.trim())+" svelte-1sgkh33")&&B(t,"class",n),c&33&&r!==(r=l[0]-l[5]/2)&&B(t,"x",r),c&34&&o!==(o=l[1]-l[5]/2)&&B(t,"y",o),c&32&&B(t,"width",l[5]),c&32&&B(t,"height",l[5])},d(l){l&&ge(t),i=!1,s()}}}function bl(e){let t,n,r,o,i,s,l,c,u;return{c(){t=Ue("g"),n=Ue("circle"),o=Ue("rect"),B(n,"cx",e[0]),B(n,"cy",e[1]),B(n,"r",r=e[3]/e[2]),B(n,"class","a9s-touch-halo svelte-1sgkh33"),Ai(n,"touched",e[4]),B(o,"class",i=hr(`a9s-handle ${e[8].class||""}`.trim())+" svelte-1sgkh33"),B(o,"x",s=e[0]-e[5]/2),B(o,"y",l=e[1]-e[5]/2),B(o,"width",e[5]),B(o,"height",e[5]),B(t,"class","a9s-touch-handle")},m(d,f){me(d,t,f),wi(t,n),wi(t,o),c||(u=[Pe(n,"pointerdown",e[10]),Pe(n,"pointerdown",e[6]),Pe(n,"pointerup",e[7]),Pe(o,"pointerdown",e[9]),Pe(o,"pointerdown",e[6]),Pe(o,"pointerup",e[7])],c=!0)},p(d,f){f&1&&B(n,"cx",d[0]),f&2&&B(n,"cy",d[1]),f&12&&r!==(r=d[3]/d[2])&&B(n,"r",r),f&16&&Ai(n,"touched",d[4]),f&256&&i!==(i=hr(`a9s-handle ${d[8].class||""}`.trim())+" svelte-1sgkh33")&&B(o,"class",i),f&33&&s!==(s=d[0]-d[5]/2)&&B(o,"x",s),f&34&&l!==(l=d[1]-d[5]/2)&&B(o,"y",l),f&32&&B(o,"width",d[5]),f&32&&B(o,"height",d[5])},d(d){d&&ge(t),c=!1,ft(u)}}}function wl(e){let t;function n(o,i){return vl?bl:yl}let r=n()(e);return{c(){r.c(),t=Ei()},m(o,i){r.m(o,i),me(o,t,i)},p(o,[i]){r.p(o,i)},i:vn,o:vn,d(o){o&&ge(t),r.d(o)}}}function xl(e,t,n){let r,{x:o}=t,{y:i}=t,{scale:s}=t,{radius:l=30}=t,c=!1;const u=m=>{m.pointerType==="touch"&&n(4,c=!0)},d=()=>n(4,c=!1);function f(m){dt.call(this,e,m)}function p(m){dt.call(this,e,m)}function h(m){dt.call(this,e,m)}return e.$$set=m=>{n(8,t=ro(ro({},t),bi(m))),"x"in m&&n(0,o=m.x),"y"in m&&n(1,i=m.y),"scale"in m&&n(2,s=m.scale),"radius"in m&&n(3,l=m.radius)},e.$$.update=()=>{e.$$.dirty&4&&n(5,r=10/s)},t=bi(t),[o,i,s,l,c,r,u,d,t,f,p,h]}let wn=class extends vr{constructor(t){super(),mr(this,t,xl,wl,pr,{x:0,y:1,scale:2,radius:3})}};function El(e){let t,n,r,o,i,s,l,c,u,d,f,p,h,m,v,w,b,g,x,S,A,P,_,C,M,R,O,$,T,j,L,Y,q,X,K,ne,Z,ue,Ae,Re,ae,fe,he;return X=new wn({props:{class:"a9s-corner-handle-topleft",x:e[4].x,y:e[4].y,scale:e[3]}}),X.$on("pointerdown",function(){Be(e[9]("TOP_LEFT"))&&e[9]("TOP_LEFT").apply(this,arguments)}),ne=new wn({props:{class:"a9s-corner-handle-topright",x:e[4].x+e[4].w,y:e[4].y,scale:e[3]}}),ne.$on("pointerdown",function(){Be(e[9]("TOP_RIGHT"))&&e[9]("TOP_RIGHT").apply(this,arguments)}),ue=new wn({props:{class:"a9s-corner-handle-bottomright",x:e[4].x+e[4].w,y:e[4].y+e[4].h,scale:e[3]}}),ue.$on("pointerdown",function(){Be(e[9]("BOTTOM_RIGHT"))&&e[9]("BOTTOM_RIGHT").apply(this,arguments)}),Re=new wn({props:{class:"a9s-corner-handle-bottomleft",x:e[4].x,y:e[4].y+e[4].h,scale:e[3]}}),Re.$on("pointerdown",function(){Be(e[9]("BOTTOM_LEFT"))&&e[9]("BOTTOM_LEFT").apply(this,arguments)}),{c(){t=Ue("rect"),l=Ge(),c=Ue("rect"),h=Ge(),m=Ue("rect"),g=Ge(),x=Ue("rect"),_=Ge(),C=Ue("rect"),$=Ge(),T=Ue("rect"),q=Ge(),Ht(X.$$.fragment),K=Ge(),Ht(ne.$$.fragment),Z=Ge(),Ht(ue.$$.fragment),Ae=Ge(),Ht(Re.$$.fragment),B(t,"class","a9s-outer"),B(t,"style",n=e[1]?"display:none;":void 0),B(t,"x",r=e[4].x),B(t,"y",o=e[4].y),B(t,"width",i=e[4].w),B(t,"height",s=e[4].h),B(c,"class","a9s-inner a9s-shape-handle"),B(c,"style",e[1]),B(c,"x",u=e[4].x),B(c,"y",d=e[4].y),B(c,"width",f=e[4].w),B(c,"height",p=e[4].h),B(m,"class","a9s-edge-handle a9s-edge-handle-top"),B(m,"x",v=e[4].x),B(m,"y",w=e[4].y),B(m,"height",1),B(m,"width",b=e[4].w),B(x,"class","a9s-edge-handle a9s-edge-handle-right"),B(x,"x",S=e[4].x+e[4].w),B(x,"y",A=e[4].y),B(x,"height",P=e[4].h),B(x,"width",1),B(C,"class","a9s-edge-handle a9s-edge-handle-bottom"),B(C,"x",M=e[4].x),B(C,"y",R=e[4].y+e[4].h),B(C,"height",1),B(C,"width",O=e[4].w),B(T,"class","a9s-edge-handle a9s-edge-handle-left"),B(T,"x",j=e[4].x),B(T,"y",L=e[4].y),B(T,"height",Y=e[4].h),B(T,"width",1)},m(J,H){me(J,t,H),me(J,l,H),me(J,c,H),me(J,h,H),me(J,m,H),me(J,g,H),me(J,x,H),me(J,_,H),me(J,C,H),me(J,$,H),me(J,T,H),me(J,q,H),St(X,J,H),me(J,K,H),St(ne,J,H),me(J,Z,H),St(ue,J,H),me(J,Ae,H),St(Re,J,H),ae=!0,fe||(he=[Pe(t,"pointerdown",function(){Be(e[9]("SHAPE"))&&e[9]("SHAPE").apply(this,arguments)}),Pe(c,"pointerdown",function(){Be(e[9]("SHAPE"))&&e[9]("SHAPE").apply(this,arguments)}),Pe(m,"pointerdown",function(){Be(e[9]("TOP"))&&e[9]("TOP").apply(this,arguments)}),Pe(x,"pointerdown",function(){Be(e[9]("RIGHT"))&&e[9]("RIGHT").apply(this,arguments)}),Pe(C,"pointerdown",function(){Be(e[9]("BOTTOM"))&&e[9]("BOTTOM").apply(this,arguments)}),Pe(T,"pointerdown",function(){Be(e[9]("LEFT"))&&e[9]("LEFT").apply(this,arguments)})],fe=!0)},p(J,H){e=J,(!ae||H&2&&n!==(n=e[1]?"display:none;":void 0))&&B(t,"style",n),(!ae||H&16&&r!==(r=e[4].x))&&B(t,"x",r),(!ae||H&16&&o!==(o=e[4].y))&&B(t,"y",o),(!ae||H&16&&i!==(i=e[4].w))&&B(t,"width",i),(!ae||H&16&&s!==(s=e[4].h))&&B(t,"height",s),(!ae||H&2)&&B(c,"style",e[1]),(!ae||H&16&&u!==(u=e[4].x))&&B(c,"x",u),(!ae||H&16&&d!==(d=e[4].y))&&B(c,"y",d),(!ae||H&16&&f!==(f=e[4].w))&&B(c,"width",f),(!ae||H&16&&p!==(p=e[4].h))&&B(c,"height",p),(!ae||H&16&&v!==(v=e[4].x))&&B(m,"x",v),(!ae||H&16&&w!==(w=e[4].y))&&B(m,"y",w),(!ae||H&16&&b!==(b=e[4].w))&&B(m,"width",b),(!ae||H&16&&S!==(S=e[4].x+e[4].w))&&B(x,"x",S),(!ae||H&16&&A!==(A=e[4].y))&&B(x,"y",A),(!ae||H&16&&P!==(P=e[4].h))&&B(x,"height",P),(!ae||H&16&&M!==(M=e[4].x))&&B(C,"x",M),(!ae||H&16&&R!==(R=e[4].y+e[4].h))&&B(C,"y",R),(!ae||H&16&&O!==(O=e[4].w))&&B(C,"width",O),(!ae||H&16&&j!==(j=e[4].x))&&B(T,"x",j),(!ae||H&16&&L!==(L=e[4].y))&&B(T,"y",L),(!ae||H&16&&Y!==(Y=e[4].h))&&B(T,"height",Y);const Q={};H&16&&(Q.x=e[4].x),H&16&&(Q.y=e[4].y),H&8&&(Q.scale=e[3]),X.$set(Q);const re={};H&16&&(re.x=e[4].x+e[4].w),H&16&&(re.y=e[4].y),H&8&&(re.scale=e[3]),ne.$set(re);const ee={};H&16&&(ee.x=e[4].x+e[4].w),H&16&&(ee.y=e[4].y+e[4].h),H&8&&(ee.scale=e[3]),ue.$set(ee);const ie={};H&16&&(ie.x=e[4].x),H&16&&(ie.y=e[4].y+e[4].h),H&8&&(ie.scale=e[3]),Re.$set(ie)},i(J){ae||(Ke(X.$$.fragment,J),Ke(ne.$$.fragment,J),Ke(ue.$$.fragment,J),Ke(Re.$$.fragment,J),ae=!0)},o(J){ot(X.$$.fragment,J),ot(ne.$$.fragment,J),ot(ue.$$.fragment,J),ot(Re.$$.fragment,J),ae=!1},d(J){J&&(ge(t),ge(l),ge(c),ge(h),ge(m),ge(g),ge(x),ge(_),ge(C),ge($),ge(T),ge(q),ge(K),ge(Z),ge(Ae)),Ot(X,J),Ot(ne,J),Ot(ue,J),Ot(Re,J),fe=!1,ft(he)}}}function Al(e){let t,n;return t=new ji({props:{shape:e[0],transform:e[2],editor:e[5],$$slots:{default:[El,({grab:r})=>({9:r}),({grab:r})=>r?512:0]},$$scope:{ctx:e}}}),t.$on("grab",e[6]),t.$on("change",e[7]),t.$on("release",e[8]),{c(){Ht(t.$$.fragment)},m(r,o){St(t,r,o),n=!0},p(r,[o]){const i={};o&1&&(i.shape=r[0]),o&4&&(i.transform=r[2]),o&1562&&(i.$$scope={dirty:o,ctx:r}),t.$set(i)},i(r){n||(Ke(t.$$.fragment,r),n=!0)},o(r){ot(t.$$.fragment,r),n=!1},d(r){Ot(t,r)}}}function Sl(e,t,n){let r,{shape:o}=t,{computedStyle:i}=t,{transform:s}=t,{viewportScale:l=1}=t;const c=(p,h,m)=>{const v=p.geometry.bounds;let[w,b]=[v.minX,v.minY],[g,x]=[v.maxX,v.maxY];const[S,A]=m;if(h==="SHAPE")w+=S,g+=S,b+=A,x+=A;else{switch(h){case"TOP":case"TOP_LEFT":case"TOP_RIGHT":{b+=A;break}case"BOTTOM":case"BOTTOM_LEFT":case"BOTTOM_RIGHT":{x+=A;break}}switch(h){case"LEFT":case"TOP_LEFT":case"BOTTOM_LEFT":{w+=S;break}case"RIGHT":case"TOP_RIGHT":case"BOTTOM_RIGHT":{g+=S;break}}}const P=Math.min(w,g),_=Math.min(b,x),C=Math.abs(g-w),M=Math.abs(x-b);return{...p,geometry:{x:P,y:_,w:C,h:M,bounds:{minX:P,minY:_,maxX:P+C,maxY:_+M}}}};function u(p){dt.call(this,e,p)}function d(p){dt.call(this,e,p)}function f(p){dt.call(this,e,p)}return e.$$set=p=>{"shape"in p&&n(0,o=p.shape),"computedStyle"in p&&n(1,i=p.computedStyle),"transform"in p&&n(2,s=p.transform),"viewportScale"in p&&n(3,l=p.viewportScale)},e.$$.update=()=>{e.$$.dirty&1&&n(4,r=o.geometry)},[o,i,s,l,r,c,u,d,f]}class Ol extends vr{constructor(t){super(),mr(this,t,Sl,Al,pr,{shape:0,computedStyle:1,transform:2,viewportScale:3})}}en.RECTANGLE,en.POLYGON;const Rl=e=>({}),Pi=e=>({grab:e[0]});function Tl(e){let t,n,r,o;const i=e[7].default,s=Ys(i,e,e[6],Pi);return{c(){t=Ue("g"),s&&s.c(),B(t,"class","a9s-annotation selected")},m(l,c){me(l,t,c),s&&s.m(t,null),n=!0,r||(o=[Pe(t,"pointerup",e[2]),Pe(t,"pointermove",e[1])],r=!0)},p(l,[c]){s&&s.p&&(!n||c&64)&&Ws(s,i,l,l[6],n?Hs(i,l[6],c,Rl):Ks(l[6]),Pi)},i(l){n||(Ke(s,l),n=!0)},o(l){ot(s,l),n=!1},d(l){l&&ge(t),s&&s.d(l),r=!1,ft(o)}}}function Cl(e,t,n){let{$$slots:r={},$$scope:o}=t;const i=Js();let{shape:s}=t,{editor:l}=t,{transform:c}=t,u,d,f;const p=v=>w=>{u=v,d=c.elementToImage(w.offsetX,w.offsetY),f=s,w.target.setPointerCapture(w.pointerId),i("grab",w)},h=v=>{if(u){const[w,b]=c.elementToImage(v.offsetX,v.offsetY),g=[w-d[0],b-d[1]];n(3,s=l(f,u,g)),i("change",s)}},m=v=>{v.target.releasePointerCapture(v.pointerId),u=void 0,f=s,i("release",v)};return e.$$set=v=>{"shape"in v&&n(3,s=v.shape),"editor"in v&&n(4,l=v.editor),"transform"in v&&n(5,c=v.transform),"$$scope"in v&&n(6,o=v.$$scope)},[p,h,m,s,l,c,o,r]}let ji=class extends vr{constructor(t){super(),mr(this,t,Cl,Tl,pr,{shape:3,editor:4,transform:5})}};typeof navigator>"u"||navigator.userAgent.indexOf("Mac OS X");var yr={exports:{}},xn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ni;function kl(){if(Ni)return xn;Ni=1;var e=W,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(l,c,u){var d,f={},p=null,h=null;u!==void 0&&(p=""+u),c.key!==void 0&&(p=""+c.key),c.ref!==void 0&&(h=c.ref);for(d in c)r.call(c,d)&&!i.hasOwnProperty(d)&&(f[d]=c[d]);if(l&&l.defaultProps)for(d in c=l.defaultProps,c)f[d]===void 0&&(f[d]=c[d]);return{$$typeof:t,type:l,key:p,ref:h,props:f,_owner:o.current}}return xn.Fragment=n,xn.jsx=s,xn.jsxs=s,xn}var En={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Li;function $l(){return Li||(Li=1,process.env.NODE_ENV!=="production"&&function(){var e=W,t=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.for("react.offscreen"),m=Symbol.iterator,v="@@iterator";function w(a){if(a===null||typeof a!="object")return null;var y=m&&a[m]||a[v];return typeof y=="function"?y:null}var b=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function g(a){{for(var y=arguments.length,E=new Array(y>1?y-1:0),k=1;k<y;k++)E[k-1]=arguments[k];x("error",a,E)}}function x(a,y,E){{var k=b.ReactDebugCurrentFrame,U=k.getStackAddendum();U!==""&&(y+="%s",E=E.concat([U]));var V=E.map(function(I){return String(I)});V.unshift("Warning: "+y),Function.prototype.apply.call(console[a],console,V)}}var S=!1,A=!1,P=!1,_=!1,C=!1,M;M=Symbol.for("react.module.reference");function R(a){return!!(typeof a=="string"||typeof a=="function"||a===r||a===i||C||a===o||a===u||a===d||_||a===h||S||A||P||typeof a=="object"&&a!==null&&(a.$$typeof===p||a.$$typeof===f||a.$$typeof===s||a.$$typeof===l||a.$$typeof===c||a.$$typeof===M||a.getModuleId!==void 0))}function O(a,y,E){var k=a.displayName;if(k)return k;var U=y.displayName||y.name||"";return U!==""?E+"("+U+")":E}function $(a){return a.displayName||"Context"}function T(a){if(a==null)return null;if(typeof a.tag=="number"&&g("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case r:return"Fragment";case n:return"Portal";case i:return"Profiler";case o:return"StrictMode";case u:return"Suspense";case d:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case l:var y=a;return $(y)+".Consumer";case s:var E=a;return $(E._context)+".Provider";case c:return O(a,a.render,"ForwardRef");case f:var k=a.displayName||null;return k!==null?k:T(a.type)||"Memo";case p:{var U=a,V=U._payload,I=U._init;try{return T(I(V))}catch{return null}}}return null}var j=Object.assign,L=0,Y,q,X,K,ne,Z,ue;function Ae(){}Ae.__reactDisabledLog=!0;function Re(){{if(L===0){Y=console.log,q=console.info,X=console.warn,K=console.error,ne=console.group,Z=console.groupCollapsed,ue=console.groupEnd;var a={configurable:!0,enumerable:!0,value:Ae,writable:!0};Object.defineProperties(console,{info:a,log:a,warn:a,error:a,group:a,groupCollapsed:a,groupEnd:a})}L++}}function ae(){{if(L--,L===0){var a={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:j({},a,{value:Y}),info:j({},a,{value:q}),warn:j({},a,{value:X}),error:j({},a,{value:K}),group:j({},a,{value:ne}),groupCollapsed:j({},a,{value:Z}),groupEnd:j({},a,{value:ue})})}L<0&&g("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var fe=b.ReactCurrentDispatcher,he;function J(a,y,E){{if(he===void 0)try{throw Error()}catch(U){var k=U.stack.trim().match(/\n( *(at )?)/);he=k&&k[1]||""}return`
`+he+a}}var H=!1,Q;{var re=typeof WeakMap=="function"?WeakMap:Map;Q=new re}function ee(a,y){if(!a||H)return"";{var E=Q.get(a);if(E!==void 0)return E}var k;H=!0;var U=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var V;V=fe.current,fe.current=null,Re();try{if(y){var I=function(){throw Error()};if(Object.defineProperty(I.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(I,[])}catch(oe){k=oe}Reflect.construct(a,[],I)}else{try{I.call()}catch(oe){k=oe}a.call(I.prototype)}}else{try{throw Error()}catch(oe){k=oe}a()}}catch(oe){if(oe&&k&&typeof oe.stack=="string"){for(var N=oe.stack.split(`
`),te=k.stack.split(`
`),z=N.length-1,G=te.length-1;z>=1&&G>=0&&N[z]!==te[G];)G--;for(;z>=1&&G>=0;z--,G--)if(N[z]!==te[G]){if(z!==1||G!==1)do if(z--,G--,G<0||N[z]!==te[G]){var le=`
`+N[z].replace(" at new "," at ");return a.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",a.displayName)),typeof a=="function"&&Q.set(a,le),le}while(z>=1&&G>=0);break}}}finally{H=!1,fe.current=V,ae(),Error.prepareStackTrace=U}var Oe=a?a.displayName||a.name:"",Ee=Oe?J(Oe):"";return typeof a=="function"&&Q.set(a,Ee),Ee}function ie(a,y,E){return ee(a,!1)}function pe(a){var y=a.prototype;return!!(y&&y.isReactComponent)}function ce(a,y,E){if(a==null)return"";if(typeof a=="function")return ee(a,pe(a));if(typeof a=="string")return J(a);switch(a){case u:return J("Suspense");case d:return J("SuspenseList")}if(typeof a=="object")switch(a.$$typeof){case c:return ie(a.render);case f:return ce(a.type,y,E);case p:{var k=a,U=k._payload,V=k._init;try{return ce(V(U),y,E)}catch{}}}return""}var se=Object.prototype.hasOwnProperty,Te={},_e=b.ReactDebugCurrentFrame;function Ce(a){if(a){var y=a._owner,E=ce(a.type,a._source,y?y.type:null);_e.setExtraStackFrame(E)}else _e.setExtraStackFrame(null)}function ut(a,y,E,k,U){{var V=Function.call.bind(se);for(var I in a)if(V(a,I)){var N=void 0;try{if(typeof a[I]!="function"){var te=Error((k||"React class")+": "+E+" type `"+I+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof a[I]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw te.name="Invariant Violation",te}N=a[I](y,I,k,E,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(z){N=z}N&&!(N instanceof Error)&&(Ce(U),g("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",k||"React class",E,I,typeof N),Ce(null)),N instanceof Error&&!(N.message in Te)&&(Te[N.message]=!0,Ce(U),g("Failed %s type: %s",E,N.message),Ce(null))}}}var qe=Array.isArray;function ke(a){return qe(a)}function _t(a){{var y=typeof Symbol=="function"&&Symbol.toStringTag,E=y&&a[Symbol.toStringTag]||a.constructor.name||"Object";return E}}function Xn(a){try{return Pt(a),!1}catch{return!0}}function Pt(a){return""+a}function jt(a){if(Xn(a))return g("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",_t(a)),Pt(a)}var Fe=b.ReactCurrentOwner,zn={key:!0,ref:!0,__self:!0,__source:!0},Nt,Lt,Qe;Qe={};function qn(a){if(se.call(a,"ref")){var y=Object.getOwnPropertyDescriptor(a,"ref").get;if(y&&y.isReactWarning)return!1}return a.ref!==void 0}function Gn(a){if(se.call(a,"key")){var y=Object.getOwnPropertyDescriptor(a,"key").get;if(y&&y.isReactWarning)return!1}return a.key!==void 0}function Jn(a,y){if(typeof a.ref=="string"&&Fe.current&&y&&Fe.current.stateNode!==y){var E=T(Fe.current.type);Qe[E]||(g('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',T(Fe.current.type),a.ref),Qe[E]=!0)}}function Zn(a,y){{var E=function(){Nt||(Nt=!0,g("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",y))};E.isReactWarning=!0,Object.defineProperty(a,"key",{get:E,configurable:!0})}}function Qn(a,y){{var E=function(){Lt||(Lt=!0,g("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",y))};E.isReactWarning=!0,Object.defineProperty(a,"ref",{get:E,configurable:!0})}}var er=function(a,y,E,k,U,V,I){var N={$$typeof:t,type:a,key:y,ref:E,props:I,_owner:V};return N._store={},Object.defineProperty(N._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(N,"_self",{configurable:!1,enumerable:!1,writable:!1,value:k}),Object.defineProperty(N,"_source",{configurable:!1,enumerable:!1,writable:!1,value:U}),Object.freeze&&(Object.freeze(N.props),Object.freeze(N)),N};function tr(a,y,E,k,U){{var V,I={},N=null,te=null;E!==void 0&&(jt(E),N=""+E),Gn(y)&&(jt(y.key),N=""+y.key),qn(y)&&(te=y.ref,Jn(y,U));for(V in y)se.call(y,V)&&!zn.hasOwnProperty(V)&&(I[V]=y[V]);if(a&&a.defaultProps){var z=a.defaultProps;for(V in z)I[V]===void 0&&(I[V]=z[V])}if(N||te){var G=typeof a=="function"?a.displayName||a.name||"Unknown":a;N&&Zn(I,G),te&&Qn(I,G)}return er(a,N,te,U,k,Fe.current,I)}}var et=b.ReactCurrentOwner,It=b.ReactDebugCurrentFrame;function Se(a){if(a){var y=a._owner,E=ce(a.type,a._source,y?y.type:null);It.setExtraStackFrame(E)}else It.setExtraStackFrame(null)}var tt;tt=!1;function nt(a){return typeof a=="object"&&a!==null&&a.$$typeof===t}function Dt(){{if(et.current){var a=T(et.current.type);if(a)return`

Check the render method of \``+a+"`."}return""}}function nr(a){return""}var Mt={};function rr(a){{var y=Dt();if(!y){var E=typeof a=="string"?a:a.displayName||a.name;E&&(y=`

Check the top-level render call using <`+E+">.")}return y}}function Ft(a,y){{if(!a._store||a._store.validated||a.key!=null)return;a._store.validated=!0;var E=rr(y);if(Mt[E])return;Mt[E]=!0;var k="";a&&a._owner&&a._owner!==et.current&&(k=" It was passed a child from "+T(a._owner.type)+"."),Se(a),g('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',E,k),Se(null)}}function Bt(a,y){{if(typeof a!="object")return;if(ke(a))for(var E=0;E<a.length;E++){var k=a[E];nt(k)&&Ft(k,y)}else if(nt(a))a._store&&(a._store.validated=!0);else if(a){var U=w(a);if(typeof U=="function"&&U!==a.entries)for(var V=U.call(a),I;!(I=V.next()).done;)nt(I.value)&&Ft(I.value,y)}}}function or(a){{var y=a.type;if(y==null||typeof y=="string")return;var E;if(typeof y=="function")E=y.propTypes;else if(typeof y=="object"&&(y.$$typeof===c||y.$$typeof===f))E=y.propTypes;else return;if(E){var k=T(y);ut(E,a.props,"prop",k,a)}else if(y.PropTypes!==void 0&&!tt){tt=!0;var U=T(y);g("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",U||"Unknown")}typeof y.getDefaultProps=="function"&&!y.getDefaultProps.isReactClassApproved&&g("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function ir(a){{for(var y=Object.keys(a.props),E=0;E<y.length;E++){var k=y[E];if(k!=="children"&&k!=="key"){Se(a),g("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",k),Se(null);break}}a.ref!==null&&(Se(a),g("Invalid attribute `ref` supplied to `React.Fragment`."),Se(null))}}var Ut={};function Vt(a,y,E,k,U,V){{var I=R(a);if(!I){var N="";(a===void 0||typeof a=="object"&&a!==null&&Object.keys(a).length===0)&&(N+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var te=nr();te?N+=te:N+=Dt();var z;a===null?z="null":ke(a)?z="array":a!==void 0&&a.$$typeof===t?(z="<"+(T(a.type)||"Unknown")+" />",N=" Did you accidentally export a JSX literal instead of a component?"):z=typeof a,g("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",z,N)}var G=tr(a,y,E,U,V);if(G==null)return G;if(I){var le=y.children;if(le!==void 0)if(k)if(ke(le)){for(var Oe=0;Oe<le.length;Oe++)Bt(le[Oe],a);Object.freeze&&Object.freeze(le)}else g("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Bt(le,a)}if(se.call(y,"key")){var Ee=T(a),oe=Object.keys(y).filter(function(fr){return fr!=="key"}),rt=oe.length>0?"{key: someKey, "+oe.join(": ..., ")+": ...}":"{key: someKey}";if(!Ut[Ee+rt]){var ur=oe.length>0?"{"+oe.join(": ..., ")+": ...}":"{}";g(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,rt,Ee,ur,Ee),Ut[Ee+rt]=!0}}return a===r?ir(G):or(G),G}}function ar(a,y,E){return Vt(a,y,E,!0)}function sr(a,y,E){return Vt(a,y,E,!1)}var lr=sr,cr=ar;En.Fragment=r,En.jsx=lr,En.jsxs=cr}()),En}var Ii;function _l(){return Ii||(Ii=1,process.env.NODE_ENV==="production"?yr.exports=kl():yr.exports=$l()),yr.exports}var pt=_l();const Pl={namespaces:{tei:"http://www.tei-c.org/ns/1.0",teieg:"http://www.tei-c.org/ns/Examples",rng:"http://relaxng.org/ns/structure/1.0"},tei:{eg:["<pre>","</pre>"],ptr:['<a href="$rw@target">$@target</a>'],ref:[["[target]",['<a href="$rw@target">',"</a>"]]],graphic:function(e){let t=new Image;return t.src=this.rw(e.getAttribute("url")),e.hasAttribute("width")&&t.setAttribute("width",e.getAttribute("width")),e.hasAttribute("height")&&t.setAttribute("height",e.getAttribute("height")),t},list:[["[type=gloss]",function(e){const t=e.ownerDocument;let n=t.createElement("dl");for(let r of Array.from(e.children))if(r.nodeType==1){if(r.localName=="tei-label"){let o=t.createElement("dt");o.innerHTML=r.innerHTML,n.appendChild(o)}if(r.localName=="tei-item"){let o=t.createElement("dd");o.innerHTML=r.innerHTML,n.appendChild(o)}}return n}]],note:[["[place=end]",function(e){const t=e.ownerDocument;this.noteIndex?this.noteIndex++:this.noteIndex=1;let n="_note_"+this.noteIndex,r=t.createElement("a");r.setAttribute("id","src"+n),r.setAttribute("href","#"+n),r.innerHTML=this.noteIndex;let o=t.createElement("sup");o.appendChild(r);let i=t.querySelector("ol.notes");i||(i=t.createElement("ol"),i.setAttribute("class","notes"),this.dom.appendChild(i));let s=t.createElement("li");return s.id=n,s.innerHTML=e.innerHTML,i.appendChild(s),o}],["_",["(",")"]]],teiHeader:function(e){this.hideContent(e,!1)},title:[["tei-titlestmt>tei-title",function(e){const t=e.ownerDocument;let n=t.createElement("title");n.innerHTML=e.innerText,t.querySelector("head").appendChild(n)}]]},teieg:{egXML:function(e){const t=e.ownerDocument;let n=t.createElement("pre"),r=t.createElement("code");n.appendChild(r);let o=this.serialize(e,!0).replace(/</g,"&lt;"),i=o.match(/^[\t ]+/);return i&&(o=o.replace(new RegExp("^"+i[0],"mg"),"")),r.innerHTML=o,n}}};function jl(e,t){let n=1,r=e;for(;r&&r.previousElementSibling!==null&&(!t||r.previousElementSibling.localName==t)&&(n++,r=r.previousElementSibling,!!r.previousElementSibling););return n}function Di(e){const t=e.ownerDocument;let n=r=>{let o;switch(r.nodeType){case 1:o=t.createElement(r.nodeName);break;case 9:o=t.implementation.createDocument();break;case 11:o=t.createDocumentFragment();break;default:o=r.cloneNode(!0)}if(r.attributes)for(let i of Array.from(r.attributes))i.name!=="data-processed"&&o.setAttribute(i.name,i.value);for(let i of Array.from(r.childNodes))if(i.nodeType==1)if(i.hasAttribute("data-original")){for(let s of Array.from(i.childNodes)){let l=o.appendChild(n(s));l.nodeType===1&&l.hasAttribute("data-origid")&&(l.setAttribute("id",l.getAttribute("data-origid")),l.removeAttribute("data-origid"))}return o}else i.hasAttribute("data-origname")&&o.appendChild(n(i));else o.appendChild(i.cloneNode());return o};return n(e)}function Mi(e){return e.replace(/ .*$/,"")}function Fi(e,t=!0){const n=e.ownerDocument;if(e.childNodes.length>0){let r=n.createElement("cetei-original");e.appendChild(r),r.setAttribute("hidden",""),r.setAttribute("data-original","");for(let o of Array.from(e.childNodes))if(o!==r){if(o.nodeType===1){o.setAttribute("data-processed","");for(let i of o.querySelectorAll("*"))i.setAttribute("data-processed","")}r.appendChild(e.removeChild(o))}if(t)for(let o of Array.from(r.querySelectorAll("*")))o.hasAttribute("id")&&(o.setAttribute("data-origid",o.getAttribute("id")),o.removeAttribute("id"))}}function Nl(e){return this.rw(this.first(e))}function Ll(e,t){let n="";for(let r=0;r<t;r++)n+=e;return n}function Il(e){let t=this.prefixDefs[e.substring(0,e.indexOf(":"))];return e.replace(new RegExp(t.matchPattern),t.replacementPattern)}function Dl(e){return this.prefixDefs[e]}function Ml(e){return e.match(/^(?:http|mailto|file|\/|#).*$/)?e:this.base+Mi(e)}function Fl(e,t,n){return br(Di(e),t,n)}function br(e,t,n){let r="";const o=i=>!/[^\t\n\r ]/.test(i);if((e.nodeType===9||e.nodeType===11)&&(r+=`<?xml version="1.0" encoding="UTF-8"?>
`),!t&&e.nodeType==1){typeof n=="string"&&n!==""?r+=`
`+n+"<":r+="<",r+=e.getAttribute("data-origname");let i=e.hasAttribute("data-origatts")?e.getAttribute("data-origatts").split(" "):[];for(let s of Array.from(e.attributes))!s.name.startsWith("data-")&&!["id","lang","class"].includes(s.name)&&(r+=" "+i.find(function(l){return l.toLowerCase()==s.name})+'="'+s.value+'"'),s.name=="data-xmlns"&&(r+=' xmlns="'+s.value+'"');e.childNodes.length>0?r+=">":r+="/>"}for(let i of Array.from(e.childNodes))switch(i.nodeType){case 1:typeof n=="string"?r+=br(i,!1,n+"  "):r+=br(i,!1,n);break;case 7:r+=`<?${i.nodeName} ${i.nodeValue}?>`,(e.nodeType===9||e.nodeType===11)&&(r+=`
`);break;case 8:r+=`<!--${i.nodeValue}-->`,(e.nodeType===9||e.nodeType===11)&&(r+=`
`);break;default:if(t&&o(i.nodeValue)&&(r+=i.nodeValue.replace(/^\s*\n/,"")),typeof n=="string"&&o(i.nodeValue))break;r+=i.nodeValue}return!t&&e.nodeType==1&&e.childNodes.length>0&&(typeof n=="string"?r+=`
`+n+"</":r+="</",r+=e.getAttribute("data-origname")+">"),(e.nodeType===9||e.nodeType===11)&&(r+=`
`),r}function lo(e,t,n){const r=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];let o="";const i=s=>!/[^\t\n\r ]/.test(s);if(!t&&e.nodeType==1){typeof n=="string"&&n!==""?o+=`
`+n+"<":o+="<",o+=e.nodeName;for(let s of Array.from(e.attributes))o+=" "+s.name+'="'+s.value+'"';o+=">"}for(let s of Array.from(e.childNodes))switch(s.nodeType){case 1:typeof n=="string"?o+=lo(s,!1,n+"  "):o+=lo(s,!1,n);break;case 7:o+=`<?${s.nodeName} ${s.nodeValue}?>`,(e.nodeType===9||e.nodeType===11)&&(o+=`
`);break;case 8:o+=`<!--${s.nodeValue}-->`,(e.nodeType===9||e.nodeType===11)&&(o+=`
`);break;default:if(t&&i(s.nodeValue)&&(o+=s.nodeValue.replace(/^\s*\n/,"")),typeof n=="string"&&i(s.nodeValue))break;o+=s.nodeValue.replace(/</g,"&lt;")}return r.includes(e.nodeName)||!t&&e.nodeType==1&&(typeof n=="string"?o+=`
${n}</`:o+="</",o+=`${e.nodeName}>`),(e.nodeType===9||e.nodeType===11)&&(o+=`
`),o}function Bl(e){return e.replace(/&gt;/,">").replace(/&quot;/,'"').replace(/&apos;/,"'").replace(/&amp;/,"&")}function wr(e){return e.includes(":"),e.replace(/:/,"-").toLowerCase()}function Bi(e,t=null,n=!1){try{window.customElements.define(wr(e),class extends HTMLElement{constructor(){super(),this.matches(":defined")||t&&(t.call(this),this.setAttribute("data-processed",""))}connectedCallback(){this.hasAttribute("data-processed")||t&&(t.call(this),this.setAttribute("data-processed",""))}})}catch(r){n&&(console.log(wr(e)+" couldn't be registered or is already registered."),console.log(r))}}const co=Object.freeze(Object.defineProperty({__proto__:null,copyAndReset:Di,defineCustomElement:Bi,first:Mi,getOrdinality:jl,getPrefixDef:Dl,hideContent:Fi,normalizeURI:Nl,repeat:Ll,resetAndSerialize:Fl,resolveURI:Il,rw:Ml,serialize:br,serializeHTML:lo,tagName:wr,unEscapeEntities:Bl},Symbol.toStringTag,{value:"Module"}));function Ul(e){if(e.namespaces)for(let t of Object.keys(e.namespaces))!this.namespaces.has(e.namespaces[t])&&!Array.from(this.namespaces.values()).includes(t)&&this.namespaces.set(e.namespaces[t],t);for(let t of this.namespaces.values())if(e[t])for(let n of Object.keys(e[t]))this.behaviors[`${t}:${n}`]=e[t][n];if(e.functions)for(let t of Object.keys(e.functions))this.utilities[t]=e.functions[t].bind(this.utilities);e.handlers&&console.log("Behavior handlers are no longer used."),e.fallbacks&&console.log("Fallback behaviors are no longer used.")}function Vl(e,t,n){let r;if(e===Object(e))for(let o of Object.keys(e))this.namespaces.has(e[o])||(this.namespaces.set(e[o],o),r=o);else r=e;this.behaviors[`${r}:${t}`]=n}function Yl(e,t){let n;if(e===Object(e))for(let r of Object.keys(e))this.namespaces.has(e[r])||(this.namespaces.set(e[r],r),n=r);else n=e;delete this.behaviors[`${n}:${t}`]}function Hl(e,t){const n=e.documentElement;let r=1,o=function(s){return t.has(s.namespaceURI?s.namespaceURI:"")||t.set(s.namespaceURI,"ns"+r++),t.get(s.namespaceURI?s.namespaceURI:"")+":"+s.localName};const i=new Set(Array.from(n.querySelectorAll("*"),o));return i.add(o(n)),i}function Wl(e){return new Set(Array.from(e.querySelectorAll("*[data-origname]"),t=>t.localName.replace(/(\w+)-.+/,"$1:")+t.getAttribute("data-origname")))}class tn{constructor(t){this.options=t||{},this.document=this.options.documentObject?this.options.documentObject:void 0,this.document===void 0&&(typeof window<"u"&&window.document?this.document=window.document:typeof global<"u"&&global.document&&(this.document=global.document)),this.addBehaviors=Ul.bind(this),this.addBehavior=Vl.bind(this),this.removeBehavior=Yl.bind(this),this.utilities={};for(const n of Object.keys(co))["getPrefixDef","rw","resolveURI"].includes(n)?this.utilities[n]=co[n].bind(this):this.utilities[n]=co[n];if(this.els=[],this.namespaces=new Map,this.behaviors={},this.hasStyle=!1,this.prefixDefs=[],this.debug=this.options.debug===!0,this.discardContent=this.options.discardContent===!0,this.options.base)this.base=this.options.base;else try{window&&(this.base=window.location.href.replace(/\/[^\/]*$/,"/"))}catch{this.base=""}this.options.omitDefaultBehaviors||this.addBehaviors(Pl),this.options.ignoreFragmentId&&window&&window.removeEventListener("ceteiceanload",tn.restorePosition)}async getHTML5(t,n,r){window&&window.location.href.startsWith(this.base)&&t.indexOf("/")>=0&&(this.base=t.replace(/\/[^\/]*$/,"/"));try{const o=await fetch(t);if(o.ok){const i=await o.text();return this.makeHTML5(i,n,r)}else console.log(`Could not get XML file ${t}.
Server returned ${o.status}: ${o.statusText}`)}catch(o){console.log(o)}}makeHTML5(t,n,r){return this.XML_dom=new DOMParser().parseFromString(t,"text/xml"),this.domToHTML5(this.XML_dom,n,r)}preprocess(t,n,r){this.els=Hl(t,this.namespaces);let o=i=>{let s;if(this.namespaces.has(i.namespaceURI?i.namespaceURI:"")){let l=this.namespaces.get(i.namespaceURI?i.namespaceURI:"");s=this.document.createElement(`${l}-${i.localName.toLowerCase()}`)}else s=this.document.importNode(i,!1);for(let l of Array.from(i.attributes))l.name=="xmlns"?s.setAttribute("data-xmlns",l.value):s.setAttribute(l.name,l.value),l.name=="xml:id"&&s.setAttribute("id",l.value),l.name=="xml:lang"&&s.setAttribute("lang",l.value),l.name=="rendition"&&s.setAttribute("class",l.value.replace(/#/g,""));if(s.setAttribute("data-origname",i.localName),i.hasAttributes()&&s.setAttribute("data-origatts",i.getAttributeNames().join(" ")),i.childNodes.length==0&&s.setAttribute("data-empty",""),i.localName=="head"){let l=t.evaluate("count(ancestor::*[tei:head])",i,function(c){if(c=="tei")return"http://www.tei-c.org/ns/1.0"},1,null);s.setAttribute("data-level",l.numberValue)}if(i.localName=="tagsDecl"){let l=this.document.createElement("style");for(let c of Array.from(i.childNodes))if(c.nodeType==1&&c.localName=="rendition"&&c.getAttribute("scheme")=="css"){let u="";c.hasAttribute("selector")?(u+=c.getAttribute("selector").replace(/([^#, >]+\w*)/g,"tei-$1").replace(/#tei-/g,"#")+`{
`,u+=c.textContent):(u+="."+c.getAttribute("xml:id")+`{
`,u+=c.textContent),u+=`
}
`,l.appendChild(this.document.createTextNode(u))}l.childNodes.length>0&&(s.appendChild(l),this.hasStyle=!0)}i.localName=="prefixDef"&&(this.prefixDefs.push(i.getAttribute("ident")),this.prefixDefs[i.getAttribute("ident")]={matchPattern:i.getAttribute("matchPattern"),replacementPattern:i.getAttribute("replacementPattern")});for(let l of Array.from(i.childNodes))l.nodeType==1?s.appendChild(o(l)):s.appendChild(l.cloneNode());return r&&r(s,i),s};this.dom=this.document.createDocumentFragment();for(let i of Array.from(t.childNodes))i.nodeType==1&&this.dom.appendChild(o(i)),i.nodeType==7&&this.dom.appendChild(this.document.importNode(i,!0)),i.nodeType==8&&this.dom.appendChild(this.document.importNode(i,!0));if(this.utilities.dom=this.dom.firstElementChild,n)n(this.dom,this),window&&window.dispatchEvent(An);else return typeof window<"u"&&window.dispatchEvent(An),this.dom}domToHTML5(t,n,r){if(this.preprocess(t,null,r),this.applyBehaviors(),this.done=!0,n)n(this.dom,this),window&&window.dispatchEvent(An);else return typeof window<"u"&&window.dispatchEvent(An),this.dom}processPage(){this.els=Wl(this.document),this.applyBehaviors(),window&&window.dispatchEvent(An)}unsetNamespace(t){this.namespaces.delete(t)}setBaseUrl(t){this.base=t}append(t,n){let r=this;if(n&&!n.hasAttribute("data-processed")){let o=t.call(r.utilities,n);o&&r.appendBasic(n,o)}else return function(){if(!this.hasAttribute("data-processed")){let o=t.call(r.utilities,this);o&&r.appendBasic(this,o)}}}appendBasic(t,n){this.discardContent?t.innerHTML="":Fi(t,!0),t.appendChild(n)}bName(t){return t.tagName.substring(0,t.tagName.indexOf("-")).toLowerCase()+":"+t.getAttribute("data-origname")}childExists(t,n){return t&&t.nodeName==n?!0:t&&t.nextElementSibling&&this.childExists(t.nextElementSibling,n)}decorator(t){if(Array.isArray(t)&&t.length==0)return function(r){};if(Array.isArray(t)&&!Array.isArray(t[0]))return this.applyDecorator(t);let n=this;return function(r){for(let o of t)if(r.matches(o[0])||o[0]==="_")return Array.isArray(o[1])?n.decorator(o[1]).call(this,r):o[1].call(this,r)}}applyDecorator(t){let n=this;return function(r){let o=[];for(let i=0;i<t.length;i++)o.push(n.template(t[i],r));return n.insert(r,o)}}getFallback(t,n){if(t[n])return t[n]instanceof Function?t[n]:this.decorator(t[n])}getHandler(t,n){if(t[n])return t[n]instanceof Function?this.append(t[n]):this.append(this.decorator(t[n]))}insert(t,n){let r=this.document.createElement("cetei-content");for(let o of Array.from(t.childNodes))o.nodeType===1&&!o.hasAttribute("data-processed")&&this.processElement(o);if(n[0].match("<[^>]+>")&&n[1]&&n[1].match("<[^>]+>"))r.innerHTML=n[0]+t.innerHTML+(n[1]?n[1]:"");else{r.innerHTML=n[0],r.setAttribute("data-before",n[0].replace(/<[^>]+>/g,"").length);for(let o of Array.from(t.childNodes))r.appendChild(o.cloneNode(!0));n.length>1&&(r.innerHTML+=n[1],r.setAttribute("data-after",n[1].replace(/<[^>]+>/g,"").length))}return r.childNodes.length<2?r.firstChild:r}processElement(t){if(t.hasAttribute("data-origname")&&!t.hasAttribute("data-processed")){let n=this.getFallback(this.bName(t));n&&(this.append(n,t),t.setAttribute("data-processed",""))}for(let n of Array.from(t.childNodes))n.nodeType===1&&this.processElement(n)}template(t,n){let r=t;if(t.search(/\$(\w*)(@([a-zA-Z:]+))/)){let o=/\$(\w*)@([a-zA-Z:]+)/g,i;for(;i=o.exec(t);)n.hasAttribute(i[2])?i[1]&&this.utilities[i[1]]?r=r.replace(i[0],this.utilities[i[1]](n.getAttribute(i[2]))):r=r.replace(i[0],n.getAttribute(i[2])):r=r.replace(i[0],"")}return r}applyBehaviors(){typeof window<"u"&&window.customElements?this.define.call(this,this.els):this.fallback.call(this,this.els)}define(t){for(let n of t){const r=this.getHandler(this.behaviors,n);Bi(n,r,this.debug)}}fallback(t){for(let n of t){let r=this.getFallback(this.behaviors,n);if(r)for(let o of Array.from((this.dom&&!this.done?this.dom:this.document).querySelectorAll(wr(n))))o.hasAttribute("data-processed")||(this.append(r,o),o.setAttribute("data-processed",""))}}static savePosition(){window.sessionStorage.setItem(window.location+"-scroll",window.scrollY)}static restorePosition(){if(window.location.hash)setTimeout(function(){let t=this.document.querySelector(window.decodeURI(window.location.hash));t&&t.scrollIntoView()},100);else{let t;(t=window.sessionStorage.getItem(window.location+"-scroll"))&&(window.sessionStorage.removeItem(window.location+"-scroll"),setTimeout(function(){window.scrollTo(0,t)},100))}}}try{if(typeof window<"u"){window.CETEI=tn,window.addEventListener("beforeunload",tn.savePosition);var An=new Event("ceteiceanload");window.addEventListener("ceteiceanload",tn.restorePosition)}}catch(e){console.log(e)}const Ui={tei:{ref:e=>{const t=document.createElement("a");for(;e.firstChild;)t.appendChild(e.removeChild(e.firstChild));t.setAttribute("href",e.getAttribute("target")),e.appendChild(t)},graphic:e=>{var t;const n=new Image;n.src=(t=e.getAttribute("url"))==null?void 0:t.trim(),e.hasAttribute("width")&&n.setAttribute("width",e.getAttribute("width")),e.hasAttribute("height")&&n.setAttribute("height",e.getAttribute("height")),e.appendChild(n)},list:null,note:null,table:null,teiHeader:e=>{e.hidden=!0}}},Kl=e=>{const t=W.useRef(null);return W.useEffect(()=>{var n;if(e.tei){const r=new tn(e.initArgs);r.addBehaviors({...Ui,...e.behaviors||{},tei:{...Ui.tei,...((n=e.behaviors)==null?void 0:n.tei)||{}}}),r.makeHTML5(e.tei,o=>{t.current.appendChild(o),e.onLoad(t.current)})}return()=>{t.current.innerHTML=""}},[e.tei,JSON.stringify(e.initArgs),e.onLoad]),pt.jsx("div",{ref:t,className:"tei-container"})},Xl="not-annotatable",Vi=`.${Xl}`;/mac/i.test(navigator.userAgentData?navigator.userAgentData.platform:navigator.platform);const zl=e=>{const t=e.cloneContents();return t.querySelectorAll(Vi).forEach(n=>n.remove()),t},ql=e=>e.every(t=>t.range instanceof Range&&!t.range.collapsed),Gl=(e,t,n)=>{const r=document.createRange(),o=t;r.setStart(o,0),r.setEnd(e.startContainer,e.startOffset);const i=zl(r).textContent,s=e.toString(),l=i.length||0,c=l+s.length;return{quote:s,start:l,end:c,range:e}},Jl=(e,t)=>{var n,r;const{start:o,end:i}=e,s=e.offsetReference||t,l=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,p=>{var h;return(h=p.parentElement)!=null&&h.closest(Vi)?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT});let c=0;const u=document.createRange();let d=l.nextNode();d===null&&console.error("Could not revive annotation target. Content missing.");let f=!s;for(;d!==null;){if(f||(f=s==null?void 0:s.contains(d)),f){const p=((n=d.textContent)==null?void 0:n.length)||0;if(c+p>o){u.setStart(d,o-c);break}c+=p}d=l.nextNode()}for(;d!==null;){const p=((r=d.textContent)==null?void 0:r.length)||0;if(c+p>=i){u.setEnd(d,i-c);break}c+=p,d=l.nextNode()}return{...e,range:u}},Yi=(e,t)=>ql(e.selector)?e:{...e,selector:e.selector.map(n=>n.range instanceof Range&&!n.range.collapsed?n:Jl(n,t))},Zl=[];for(let e=0;e<256;++e)Zl.push((e+256).toString(16).slice(1));typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Ql=[];for(let e=0;e<256;++e)Ql.push((e+256).toString(16).slice(1));typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const ec="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";((e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=ec[n[e]&63];return t})();const uo=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function fo(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on".concat(t),n)}function Sn(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on".concat(t),n)}function Hi(e,t){const n=t.slice(0,t.length-1);for(let r=0;r<n.length;r++)n[r]=e[n[r].toLowerCase()];return n}function Wi(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");const t=e.split(",");let n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}function tc(e,t){const n=e.length>=t.length?e:t,r=e.length>=t.length?t:e;let o=!0;for(let i=0;i<n.length;i++)r.indexOf(n[i])===-1&&(o=!1);return o}const On={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":uo?173:189,"=":uo?61:187,";":uo?59:186,"'":222,"[":219,"]":221,"\\":220},it={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},xr={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},je={16:!1,18:!1,17:!1,91:!1},be={};for(let e=1;e<20;e++)On["f".concat(e)]=111+e;let ve=[],Rn=null,Ki="all";const ht=new Map,Tn=e=>On[e.toLowerCase()]||it[e.toLowerCase()]||e.toUpperCase().charCodeAt(0),nc=e=>Object.keys(On).find(t=>On[t]===e),rc=e=>Object.keys(it).find(t=>it[t]===e);function Xi(e){Ki=e||"all"}function Cn(){return Ki||"all"}function oc(){return ve.slice(0)}function ic(){return ve.map(e=>nc(e)||rc(e)||String.fromCharCode(e))}function ac(){const e=[];return Object.keys(be).forEach(t=>{be[t].forEach(n=>{let{key:r,scope:o,mods:i,shortcut:s}=n;e.push({scope:o,shortcut:s,mods:i,keys:r.split("+").map(l=>Tn(l))})})}),e}function sc(e){const t=e.target||e.srcElement,{tagName:n}=t;let r=!0;const o=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(t.type);return(t.isContentEditable||(o||n==="TEXTAREA"||n==="SELECT")&&!t.readOnly)&&(r=!1),r}function lc(e){return typeof e=="string"&&(e=Tn(e)),ve.indexOf(e)!==-1}function cc(e,t){let n,r;e||(e=Cn());for(const o in be)if(Object.prototype.hasOwnProperty.call(be,o))for(n=be[o],r=0;r<n.length;)n[r].scope===e?n.splice(r,1).forEach(i=>{let{element:s}=i;return po(s)}):r++;Cn()===e&&Xi(t||"all")}function uc(e){let t=e.keyCode||e.which||e.charCode;const n=ve.indexOf(t);if(n>=0&&ve.splice(n,1),e.key&&e.key.toLowerCase()==="meta"&&ve.splice(0,ve.length),(t===93||t===224)&&(t=91),t in je){je[t]=!1;for(const r in it)it[r]===t&&(Rt[r]=!1)}}function zi(e){if(typeof e>"u")Object.keys(be).forEach(o=>{Array.isArray(be[o])&&be[o].forEach(i=>Er(i)),delete be[o]}),po(null);else if(Array.isArray(e))e.forEach(o=>{o.key&&Er(o)});else if(typeof e=="object")e.key&&Er(e);else if(typeof e=="string"){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let[o,i]=n;typeof o=="function"&&(i=o,o=""),Er({key:e,scope:o,method:i,splitKey:"+"})}}const Er=e=>{let{key:t,scope:n,method:r,splitKey:o="+"}=e;Wi(t).forEach(i=>{const s=i.split(o),l=s.length,c=s[l-1],u=c==="*"?"*":Tn(c);if(!be[u])return;n||(n=Cn());const d=l>1?Hi(it,s):[],f=[];be[u]=be[u].filter(p=>{const h=(r?p.method===r:!0)&&p.scope===n&&tc(p.mods,d);return h&&f.push(p.element),!h}),f.forEach(p=>po(p))})};function qi(e,t,n,r){if(t.element!==r)return;let o;if(t.scope===n||t.scope==="all"){o=t.mods.length>0;for(const i in je)Object.prototype.hasOwnProperty.call(je,i)&&(!je[i]&&t.mods.indexOf(+i)>-1||je[i]&&t.mods.indexOf(+i)===-1)&&(o=!1);(t.mods.length===0&&!je[16]&&!je[18]&&!je[17]&&!je[91]||o||t.shortcut==="*")&&(t.keys=[],t.keys=t.keys.concat(ve),t.method(e,t)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function Gi(e,t){const n=be["*"];let r=e.keyCode||e.which||e.charCode;if(!Rt.filter.call(this,e))return;if((r===93||r===224)&&(r=91),ve.indexOf(r)===-1&&r!==229&&ve.push(r),["metaKey","ctrlKey","altKey","shiftKey"].forEach(l=>{const c=xr[l];e[l]&&ve.indexOf(c)===-1?ve.push(c):!e[l]&&ve.indexOf(c)>-1?ve.splice(ve.indexOf(c),1):l==="metaKey"&&e[l]&&(ve=ve.filter(u=>u in xr||u===r))}),r in je){je[r]=!0;for(const l in it)it[l]===r&&(Rt[l]=!0);if(!n)return}for(const l in je)Object.prototype.hasOwnProperty.call(je,l)&&(je[l]=e[xr[l]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(ve.indexOf(17)===-1&&ve.push(17),ve.indexOf(18)===-1&&ve.push(18),je[17]=!0,je[18]=!0);const o=Cn();if(n)for(let l=0;l<n.length;l++)n[l].scope===o&&(e.type==="keydown"&&n[l].keydown||e.type==="keyup"&&n[l].keyup)&&qi(e,n[l],o,t);if(!(r in be))return;const i=be[r],s=i.length;for(let l=0;l<s;l++)if((e.type==="keydown"&&i[l].keydown||e.type==="keyup"&&i[l].keyup)&&i[l].key){const c=i[l],{splitKey:u}=c,d=c.key.split(u),f=[];for(let p=0;p<d.length;p++)f.push(Tn(d[p]));f.sort().join("")===ve.sort().join("")&&qi(e,c,o,t)}}function Rt(e,t,n){ve=[];const r=Wi(e);let o=[],i="all",s=document,l=0,c=!1,u=!0,d="+",f=!1,p=!1;for(n===void 0&&typeof t=="function"&&(n=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(i=t.scope),t.element&&(s=t.element),t.keyup&&(c=t.keyup),t.keydown!==void 0&&(u=t.keydown),t.capture!==void 0&&(f=t.capture),typeof t.splitKey=="string"&&(d=t.splitKey),t.single===!0&&(p=!0)),typeof t=="string"&&(i=t),p&&zi(e,i);l<r.length;l++)e=r[l].split(d),o=[],e.length>1&&(o=Hi(it,e)),e=e[e.length-1],e=e==="*"?"*":Tn(e),e in be||(be[e]=[]),be[e].push({keyup:c,keydown:u,scope:i,mods:o,shortcut:r[l],method:n,key:r[l],splitKey:d,element:s});if(typeof s<"u"&&window){if(!ht.has(s)){const h=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return Gi(v,s)},m=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;Gi(v,s),uc(v)};ht.set(s,{keydownListener:h,keyupListenr:m,capture:f}),fo(s,"keydown",h,f),fo(s,"keyup",m,f)}if(!Rn){const h=()=>{ve=[]};Rn={listener:h,capture:f},fo(window,"focus",h,f)}}}function fc(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(be).forEach(n=>{be[n].filter(r=>r.scope===t&&r.shortcut===e).forEach(r=>{r&&r.method&&r.method()})})}function po(e){const t=Object.values(be).flat();if(t.findIndex(n=>{let{element:r}=n;return r===e})<0){const{keydownListener:n,keyupListenr:r,capture:o}=ht.get(e)||{};n&&r&&(Sn(e,"keyup",r,o),Sn(e,"keydown",n,o),ht.delete(e))}if((t.length<=0||ht.size<=0)&&(Object.keys(ht).forEach(n=>{const{keydownListener:r,keyupListenr:o,capture:i}=ht.get(n)||{};r&&o&&(Sn(n,"keyup",o,i),Sn(n,"keydown",r,i),ht.delete(n))}),ht.clear(),Object.keys(be).forEach(n=>delete be[n]),Rn)){const{listener:n,capture:r}=Rn;Sn(window,"focus",n,r),Rn=null}}const ho={getPressedKeyString:ic,setScope:Xi,getScope:Cn,deleteScope:cc,getPressedKeyCodes:oc,getAllKeyCodes:ac,isPressed:lc,filter:sc,trigger:fc,unbind:zi,keyMap:On,modifier:it,modifierMap:xr};for(const e in ho)Object.prototype.hasOwnProperty.call(ho,e)&&(Rt[e]=ho[e]);if(typeof window<"u"){const e=window.hotkeys;Rt.noConflict=t=>(t&&window.hotkeys===Rt&&(window.hotkeys=e),Rt),window.hotkeys=Rt}const dc=(e,t,n)=>{let r=e,o=n;const i=document.createNodeIterator(t,NodeFilter.SHOW_TEXT);let s=i.nextNode(),l=!0;do s instanceof Text&&(s.length<o?o-=s.length:(r=s,l=!1)),s=i.nextNode();while(s&&l);return{node:r,offset:o}},go=(e,t=[])=>{let n,r,o;if(e.nodeType===Node.ELEMENT_NODE&&e.hasAttribute("xml:id")?t.push("/"):e.parentNode&&(t=go(e.parentNode,t)),e.nodeType===Node.ELEMENT_NODE&&e.nodeName.toLowerCase().startsWith("tei-")){const i=e;i.hasAttribute("xml:id")?o=`[@xml:id='${i.getAttribute("xml:id")}']`:(n=`count(preceding-sibling::${i.localName})`,r=document.evaluate(n,e,null,XPathResult.NUMBER_TYPE,null).numberValue+1,o=`[${r}]`),t.push("/"),t.push(i.getAttribute("data-origname")+o)}return t},pc=(e,t,n)=>{const r=u=>u?u.nodeName.toLowerCase().indexOf("tei-")===0?u:r(u.parentNode):null,o=(u,d,f)=>{const p=document.createRange();return p.setStart(u,0),p.setEnd(d,f),p.toString().length},i=o(r(n.startContainer),n.startContainer,n.startOffset),s=o(r(n.endContainer),n.endContainer,n.endOffset),l=e.join("")+"::"+i,c=t.join("")+"::"+s;return{start:l,end:c}},hc=e=>{var t;const{range:n}=e,r=go(n.startContainer),o=go(n.endContainer),{start:i,end:s}=pc(r,o,n);return{start:e.start,startSelector:{type:"XPathSelector",value:i},end:e.end,endSelector:{type:"XPathSelector",value:s},quote:(t=e.quote)==null?void 0:t.replace(/\s+/g," "),range:n}},gc=(e,t)=>{var n,r;const o=Array.isArray(e.selector)?e.selector[0]:e.selector;if("start"in o&&"end"in o)return Yi(e,t);{const i=(n=o.startSelector)==null?void 0:n.value,s=(r=o.endSelector)==null?void 0:r.value;if(!i||!s)throw console.error(e),"Could not revive TEI target.";const l=b=>{const g=b.indexOf("::");if(g<0)return;const x=b.substring(0,g).replace(/\/([^[/]+)/g,(P,_)=>"/tei-"+_.toLowerCase()).replace(/xml:/g,""),S=document.evaluate("."+x,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,A=parseInt(b.substring(g+2));return[S,A]},[c,u]=l(i),[d,f]=l(s),p=document.createRange(),h=(b,g)=>b.firstChild instanceof Text&&b.firstChild.length>=g?{node:b.firstChild,offset:g}:dc(b.firstChild,b,g),m=h(c,u);p.setStart(m.node,m.offset);const v=h(d,f);p.setEnd(v.node,v.offset);const w=Gl(p,t);return Yi({...e,selector:[{...w,...o,range:p}]},t)}},Ji=e=>t=>{const n=gc(t,e);return{...t,selector:n.selector.map(hc)}},mc=e=>t=>({...t,target:Ji(e)(t.target)}),vc=e=>{const t=e.element,n=mc(t),r=Ji(t),o=e.state.store,i=o.addAnnotation;o.addAnnotation=(u,d)=>{const{selector:f}=u.target;return"startSelector"in f&&"start"in f?i(u,d):i(n(u),d)};const s=o.bulkAddAnnotation;o.bulkAddAnnotation=(u,d=!0,f)=>{const p=u.map(h=>{const{selector:m}=h.target;return"startSelector"in m&&"start"in m?h:n(h)});return s(p,d,f)};const l=o.updateAnnotation;o.updateAnnotation=(u,d)=>l(n(u),d);const c=o.updateTarget;return o.updateTarget=(u,d)=>c(r(u),d),{...e,state:{...e.state,store:o}}},mo="not-annotatable",nn=`.${mo}`,kn=e=>{var t;return!!(e instanceof HTMLElement?e.closest(nn):(t=e.parentElement)!=null&&t.closest(nn))},yc=e=>{const t=e.commonAncestorContainer;return!kn(t)},bc=e=>e.addEventListener("click",t=>{!t.target.closest(nn)&&!t.target.closest("a")&&t.preventDefault()}),vo=e=>({...e,type:e.type,x:e.x,y:e.y,clientX:e.clientX,clientY:e.clientY,offsetX:e.offsetX,offsetY:e.offsetY,screenX:e.screenX,screenY:e.screenY,isPrimary:e.isPrimary,altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,button:e.button,buttons:e.buttons,currentTarget:e.currentTarget,target:e.target,defaultPrevented:e.defaultPrevented,detail:e.detail,eventPhase:e.eventPhase,pointerId:e.pointerId,pointerType:e.pointerType,timeStamp:e.timeStamp}),Ar=e=>({...e,type:e.type,key:e.key,code:e.code,location:e.location,repeat:e.repeat,altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,currentTarget:e.currentTarget,target:e.target,defaultPrevented:e.defaultPrevented,detail:e.detail,timeStamp:e.timeStamp}),wc=/mac/i.test(navigator.userAgentData?navigator.userAgentData.platform:navigator.platform),xc=e=>{!e.hasAttribute("tabindex")&&e.tabIndex<0&&e.setAttribute("tabindex","-1"),e.classList.add("no-focus-outline")},yo=(e,t=10)=>{let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>e.apply(void 0,r),t)}},Ec=function*(e){const t=document.createNodeIterator(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,r=>r instanceof HTMLElement&&r.classList.contains(mo)&&!r.parentElement.closest(nn)&&e.intersectsNode(r)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP);let n;for(;n=t.nextNode();)n instanceof HTMLElement&&(yield n)},Ac=e=>{if(!yc(e))return[];const t=[];let n=null;for(const r of Ec(e)){let o;n?(o=document.createRange(),o.setStartAfter(n),o.setEndBefore(r)):(o=e.cloneRange(),o.setEndBefore(r)),o.collapsed||t.push(o),n=r}if(n){const r=e.cloneRange();r.setStartAfter(n),r.collapsed||t.push(r)}return t.length>0?t:[e]},Sc=e=>{const t=e.cloneContents();return t.querySelectorAll(nn).forEach(n=>n.remove()),t},gt=e=>e.every(t=>t.range instanceof Range&&!t.range.collapsed),Oc=/^\s*$/,Rc=e=>Oc.test(e.toString()),Tc=(e,t)=>{const n=i=>Math.round(i*10)/10,r={top:n(e.top),bottom:n(e.bottom),left:n(e.left),right:n(e.right)},o={top:n(t.top),bottom:n(t.bottom),left:n(t.left),right:n(t.right)};if(Math.abs(r.top-o.top)<.5&&Math.abs(r.bottom-o.bottom)<.5){if(Math.abs(r.left-o.right)<.5||Math.abs(r.right-o.left)<.5)return"inline-adjacent";if(r.left>=o.left&&r.right<=o.right)return"inline-is-contained";if(r.left<=o.left&&r.right>=o.right)return"inline-contains"}else if(r.top<=o.top&&r.bottom>=o.bottom){if(r.left<=o.left&&r.right>=o.right)return"block-contains"}else if(r.top>=o.top&&r.bottom<=o.bottom&&r.left>=o.left&&r.right<=o.right)return"block-is-contained"},Cc=(e,t)=>{const n=Math.min(e.left,t.left),r=Math.max(e.right,t.right),o=Math.min(e.top,t.top),i=Math.max(e.bottom,t.bottom);return new DOMRect(n,o,r-n,i-o)},kc=e=>e.reduce((t,n)=>{if(n.width===0||n.height===0)return t;let r=[...t],o=!1;for(const i of t){const s=Tc(n,i);if(s==="inline-adjacent"){r=r.map(l=>l===i?Cc(n,i):l),o=!0;break}else if(s==="inline-contains"){r=r.map(l=>l===i?n:l),o=!0;break}else if(s==="inline-is-contained"){o=!0;break}else if(s==="block-contains"||s==="block-is-contained"){n.width<i.width&&(r=r.map(l=>l===i?n:l)),o=!0;break}}return o?r:[...r,n]},[]),$c=e=>({length:e.length,item:t=>e[t],[Symbol.iterator]:function*(){for(let t=0;t<this.length;t++)yield this.item(t)}}),_c=(e,t,n)=>{const r=document.createRange(),o=n?e.startContainer.parentElement.closest(n):t;r.setStart(o,0),r.setEnd(e.startContainer,e.startOffset);const i=Sc(r).textContent,s=e.toString(),l=i.length||0,c=l+s.length;return n?{quote:s,start:l,end:c,range:e,offsetReference:o}:{quote:s,start:l,end:c,range:e}},Zi=(e,t)=>{var n,r;const{start:o,end:i}=e,s=e.offsetReference||t,l=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,p=>{var h;return(h=p.parentElement)!=null&&h.closest(nn)?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT});let c=0;const u=document.createRange();let d=l.nextNode();d===null&&console.error("Could not revive annotation target. Content missing.");let f=!s;for(;d!==null;){if(f||(f=s==null?void 0:s.contains(d)),f){const p=((n=d.textContent)==null?void 0:n.length)||0;if(c+p>o){u.setStart(d,o-c);break}c+=p}d=l.nextNode()}for(;d!==null;){const p=((r=d.textContent)==null?void 0:r.length)||0;if(c+p>=i){u.setEnd(d,i-c);break}c+=p,d=l.nextNode()}return{...e,range:u}},Sr=(e,t)=>gt(e.selector)?e:{...e,selector:e.selector.map(n=>n.range instanceof Range&&!n.range.collapsed?n:Zi(n,t))},bo=(e,t)=>gt(e.target.selector)?e:{...e,target:Sr(e.target,t)},Pc=(e,t)=>{const n=e.cloneRange();return t.contains(n.startContainer)||n.setStart(t,0),t.contains(n.endContainer)||n.setEnd(t,t.childNodes.length),n},Qi=e=>{if(e===null)return document.scrollingElement;const{overflowY:t}=window.getComputedStyle(e);return t!=="visible"&&t!=="hidden"&&e.scrollHeight>e.clientHeight?e:Qi(e.parentElement)},jc=(e,t)=>n=>{const r=typeof n=="string"?n:n.id,o=s=>{const l=i.getBoundingClientRect(),c=i.clientHeight,u=i.clientWidth,d=s.selector[0].range.getBoundingClientRect(),{width:f,height:p}=t.getAnnotationBounds(r),h=d.top-l.top,m=d.left-l.left,v=i.parentElement?i.scrollTop:0,w=i.parentElement?i.scrollLeft:0,b=h+v-(c-p)/2,g=m+w-(u-f)/2;i.scroll({top:b,left:g,behavior:"smooth"})},i=Qi(e);if(i){const s=t.getAnnotation(r),{range:l}=s.target.selector[0];if(l&&!l.collapsed)return o(s.target),!0;{const c=Sr(s.target,e),{range:u}=c.selector[0];if(u&&!u.collapsed)return o(c),!0}}return!1},Tt={fill:"rgb(0, 128, 255)",fillOpacity:.18},Or={fill:"rgb(0, 128, 255)",fillOpacity:.45},Nc=(e,t,n,r,o)=>{var i,s;const l=n?typeof n=="function"?n(e.annotation,e.state,o)||((i=e.state)!=null&&i.selected?Or:Tt):n:(s=e.state)!=null&&s.selected?Or:Tt;return r&&r.paint(e,t)||l},Lc=e=>{const{top:t,left:n}=e.getBoundingClientRect(),{innerWidth:r,innerHeight:o}=window,i=-n,s=-t,l=r-n,c=o-t;return{top:t,left:n,minX:i,minY:s,maxX:l,maxY:c}},Ic=e=>{let t=new Set;return n=>{const r=n.map(o=>o.id);(t.size!==r.length||r.some(o=>!t.has(o)))&&e.set(r),t=new Set(r)}},wo=(e,t,n,r)=>{const{store:o,selection:i,hover:s}=t;let l,c,u;const d=Ic(n),f=_=>{const{x:C,y:M}=e.getBoundingClientRect(),R=o.getAt(_.clientX-C,_.clientY-M,!1,c);R?s.current!==R.id&&(e.classList.add("hovered"),s.set(R.id)):s.current&&(e.classList.remove("hovered"),s.set(null))};e.addEventListener("pointermove",f);const p=(_=!1)=>{u&&u.clear();const C=Lc(e),{minX:M,minY:R,maxX:O,maxY:$}=C,T=c?o.getIntersecting(M,R,O,$).filter(({annotation:Y})=>c(Y)):o.getIntersecting(M,R,O,$),j=i.selected.map(({id:Y})=>Y),L=T.map(({annotation:Y,rects:q})=>{const X=j.includes(Y.id),K=Y.id===s.current;return{annotation:Y,rects:q,state:{selected:X,hover:K}}});r.redraw(L,C,l,u,_),setTimeout(()=>d(T.map(({annotation:Y})=>Y)),1)},h=_=>{u=_,p()},m=_=>{l=_,p()},v=_=>{c=_,p(!1)},w=()=>p();o.observe(w);const b=i.subscribe(()=>p()),g=()=>p(!0);document.addEventListener("scroll",g,{capture:!0,passive:!0});const x=yo(()=>{o.recalculatePositions(),u&&u.reset(),p()});window.addEventListener("resize",x);const S=new ResizeObserver(x);S.observe(e);const A={attributes:!0,childList:!0,subtree:!0},P=new MutationObserver(_=>{_.every(C=>C.target===e||e.contains(C.target))||p(!0)});return P.observe(document.body,A),{destroy:()=>{e.removeEventListener("pointermove",f),r.destroy(),o.unobserve(w),b(),document.removeEventListener("scroll",g),window.removeEventListener("resize",x),S.disconnect(),P.disconnect()},redraw:p,setStyle:m,setFilter:v,setPainter:h,setVisible:r.setVisible}},Dc=()=>{const e=document.createElement("canvas");return e.width=window.innerWidth,e.height=window.innerHeight,e.className="r6o-canvas-highlight-layer bg",e},Mc=(e,t)=>{e.width=window.innerWidth,e.height=window.innerHeight},Fc=e=>{e.classList.add("r6o-annotatable");const t=Dc(),n=t.getContext("2d");document.body.appendChild(t);const r=(i,s,l,c)=>requestAnimationFrame(()=>{const{width:u,height:d}=t;n.clearRect(-.5,-.5,u+1,d+1),c&&c.clear();const{top:f,left:p}=s;[...i].sort((h,m)=>{const{annotation:{target:{created:v}}}=h,{annotation:{target:{created:w}}}=m;return v.getTime()-w.getTime()}).forEach(h=>{var m;const v=l?typeof l=="function"?l(h.annotation,h.state):l:(m=h.state)!=null&&m.selected?Or:Tt,w=c&&c.paint(h,s)||v,b=h.rects.map(({x:g,y:x,width:S,height:A})=>({x:g+p,y:x+f,width:S,height:A}));if(n.fillStyle=w.fill,n.globalAlpha=w.fillOpacity||1,b.forEach(({x:g,y:x,width:S,height:A})=>n.fillRect(g,x,S,A)),w.underlineColor){n.globalAlpha=1,n.strokeStyle=w.underlineColor,n.lineWidth=w.underlineThickness??1;const g=w.underlineOffset??0;b.forEach(({x,y:S,width:A,height:P})=>{n.beginPath(),n.moveTo(x,S+P+g),n.lineTo(x+A,S+P+g),n.stroke()})}})}),o=yo(()=>{Mc(t)});return window.addEventListener("resize",o),{destroy:()=>{t.remove(),window.removeEventListener("resize",o)},setVisible:i=>{console.log("setVisible not implemented on Canvas renderer")},redraw:r}},Bc=(e,t,n)=>wo(e,t,n,Fc(e));var Uc={grad:.9,turn:360,rad:360/(2*Math.PI)},mt=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},$e=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=Math.pow(10,t)),Math.round(n*e)/n+0},Xe=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=1),e>n?n:e>t?e:t},ea=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},ta=function(e){return{r:Xe(e.r,0,255),g:Xe(e.g,0,255),b:Xe(e.b,0,255),a:Xe(e.a)}},xo=function(e){return{r:$e(e.r),g:$e(e.g),b:$e(e.b),a:$e(e.a,3)}},Vc=/^#([0-9a-f]{3,8})$/i,Rr=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},na=function(e){var t=e.r,n=e.g,r=e.b,o=e.a,i=Math.max(t,n,r),s=i-Math.min(t,n,r),l=s?i===t?(n-r)/s:i===n?2+(r-t)/s:4+(t-n)/s:0;return{h:60*(l<0?l+6:l),s:i?s/i*100:0,v:i/255*100,a:o}},ra=function(e){var t=e.h,n=e.s,r=e.v,o=e.a;t=t/360*6,n/=100,r/=100;var i=Math.floor(t),s=r*(1-n),l=r*(1-(t-i)*n),c=r*(1-(1-t+i)*n),u=i%6;return{r:255*[r,l,s,s,c,r][u],g:255*[c,r,r,l,s,s][u],b:255*[s,s,c,r,r,l][u],a:o}},oa=function(e){return{h:ea(e.h),s:Xe(e.s,0,100),l:Xe(e.l,0,100),a:Xe(e.a)}},ia=function(e){return{h:$e(e.h),s:$e(e.s),l:$e(e.l),a:$e(e.a,3)}},aa=function(e){return ra((n=(t=e).s,{h:t.h,s:(n*=((r=t.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:t.a}));var t,n,r},$n=function(e){return{h:(t=na(e)).h,s:(o=(200-(n=t.s))*(r=t.v)/100)>0&&o<200?n*r/100/(o<=100?o:200-o)*100:0,l:o/2,a:t.a};var t,n,r,o},Yc=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Hc=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Wc=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Kc=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,sa={string:[[function(e){var t=Vc.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?$e(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?$e(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=Wc.exec(e)||Kc.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:ta({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=Yc.exec(e)||Hc.exec(e);if(!t)return null;var n,r,o=oa({h:(n=t[1],r=t[2],r===void 0&&(r="deg"),Number(n)*(Uc[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return aa(o)},"hsl"]],object:[[function(e){var t=e.r,n=e.g,r=e.b,o=e.a,i=o===void 0?1:o;return mt(t)&&mt(n)&&mt(r)?ta({r:Number(t),g:Number(n),b:Number(r),a:Number(i)}):null},"rgb"],[function(e){var t=e.h,n=e.s,r=e.l,o=e.a,i=o===void 0?1:o;if(!mt(t)||!mt(n)||!mt(r))return null;var s=oa({h:Number(t),s:Number(n),l:Number(r),a:Number(i)});return aa(s)},"hsl"],[function(e){var t=e.h,n=e.s,r=e.v,o=e.a,i=o===void 0?1:o;if(!mt(t)||!mt(n)||!mt(r))return null;var s=function(l){return{h:ea(l.h),s:Xe(l.s,0,100),v:Xe(l.v,0,100),a:Xe(l.a)}}({h:Number(t),s:Number(n),v:Number(r),a:Number(i)});return ra(s)},"hsv"]]},la=function(e,t){for(var n=0;n<t.length;n++){var r=t[n][0](e);if(r)return[r,t[n][1]]}return[null,void 0]},Xc=function(e){return typeof e=="string"?la(e.trim(),sa.string):typeof e=="object"&&e!==null?la(e,sa.object):[null,void 0]},Eo=function(e,t){var n=$n(e);return{h:n.h,s:Xe(n.s+100*t,0,100),l:n.l,a:n.a}},Ao=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},ca=function(e,t){var n=$n(e);return{h:n.h,s:n.s,l:Xe(n.l+100*t,0,100),a:n.a}},ua=function(){function e(t){this.parsed=Xc(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return $e(Ao(this.rgba),2)},e.prototype.isDark=function(){return Ao(this.rgba)<.5},e.prototype.isLight=function(){return Ao(this.rgba)>=.5},e.prototype.toHex=function(){return t=xo(this.rgba),n=t.r,r=t.g,o=t.b,s=(i=t.a)<1?Rr($e(255*i)):"","#"+Rr(n)+Rr(r)+Rr(o)+s;var t,n,r,o,i,s},e.prototype.toRgb=function(){return xo(this.rgba)},e.prototype.toRgbString=function(){return t=xo(this.rgba),n=t.r,r=t.g,o=t.b,(i=t.a)<1?"rgba("+n+", "+r+", "+o+", "+i+")":"rgb("+n+", "+r+", "+o+")";var t,n,r,o,i},e.prototype.toHsl=function(){return ia($n(this.rgba))},e.prototype.toHslString=function(){return t=ia($n(this.rgba)),n=t.h,r=t.s,o=t.l,(i=t.a)<1?"hsla("+n+", "+r+"%, "+o+"%, "+i+")":"hsl("+n+", "+r+"%, "+o+"%)";var t,n,r,o,i},e.prototype.toHsv=function(){return t=na(this.rgba),{h:$e(t.h),s:$e(t.s),v:$e(t.v),a:$e(t.a,3)};var t},e.prototype.invert=function(){return Je({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),Je(Eo(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),Je(Eo(this.rgba,-t))},e.prototype.grayscale=function(){return Je(Eo(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),Je(ca(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),Je(ca(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?Je({r:(n=this.rgba).r,g:n.g,b:n.b,a:t}):$e(this.rgba.a,3);var n},e.prototype.hue=function(t){var n=$n(this.rgba);return typeof t=="number"?Je({h:t,s:n.s,l:n.l,a:n.a}):$e(n.h)},e.prototype.isEqual=function(t){return this.toHex()===Je(t).toHex()},e}(),Je=function(e){return e instanceof ua?e:new ua(e)};const zc=e=>[`background-color:${Je((e==null?void 0:e.fill)||Tt.fill).alpha((e==null?void 0:e.fillOpacity)===void 0?Tt.fillOpacity:e.fillOpacity).toHex()}`,e!=null&&e.underlineThickness?"text-decoration:underline":void 0,e!=null&&e.underlineColor?`text-decoration-color:${e.underlineColor}`:void 0,e!=null&&e.underlineOffset?`text-underline-offset:${e.underlineOffset}px`:void 0,e!=null&&e.underlineThickness?`text-decoration-thickness:${e.underlineThickness}px`:void 0].filter(Boolean).join(";"),qc=()=>{const e=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(e);let t=new Set;return{destroy:()=>{CSS.highlights.clear(),e.remove()},setVisible:n=>{console.log("setVisible not implemented on CSS Custom Highlights renderer")},redraw:(n,r,o,i)=>{i&&i.clear();const s=new Set(n.map(c=>c.annotation.id));Array.from(t).filter(c=>!s.has(c));const l=n.map(c=>{var u;const d=o?typeof o=="function"?o(c.annotation,c.state):o:(u=c.state)!=null&&u.selected?Or:Tt,f=i&&i.paint(c,r)||d;return`::highlight(_${c.annotation.id}) { ${zc(f)} }`});e.innerHTML=l.join(`
`),CSS.highlights.clear(),n.forEach(({annotation:c})=>{const u=c.target.selector.map(f=>f.range),d=new Highlight(...u);CSS.highlights.set(`_${c.id}`,d)}),t=s}}},Gc=(e,t,n)=>wo(e,t,n,qc());var fa=Object.prototype.hasOwnProperty;function So(e,t){var n,r;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((r=e.length)===t.length)for(;r--&&So(e[r],t[r]););return r===-1}if(!n||typeof e=="object"){r=0;for(n in e)if(fa.call(e,n)&&++r&&!fa.call(t,n)||!(n in t)||!So(e[n],t[n]))return!1;return Object.keys(t).length===r}}return e!==e&&t!==t}const Jc=(e,t)=>{const n=(i,s)=>i.x<=s.x+s.width&&i.x+i.width>=s.x&&i.y<=s.y+s.height&&i.y+i.height>=s.y,r=i=>i.rects.reduce((s,l)=>s+l.width,0),o=t.filter(({rects:i})=>i.some(s=>n(e,s)));return o.sort((i,s)=>r(s)-r(i)),o.findIndex(i=>i.rects.includes(e))},Zc=e=>{e.classList.add("r6o-annotatable");const t=document.createElement("div");t.className="r6o-span-highlight-layer",e.insertBefore(t,e.firstChild);let n=[];return{destroy:()=>{t.remove()},redraw:(r,o,i,s,l)=>{const c=!(So(n,r)&&l);!s&&!c||(c&&(t.innerHTML=""),[...r].sort((u,d)=>{const{annotation:{target:{created:f}}}=u,{annotation:{target:{created:p}}}=d;return f&&p?f.getTime()-p.getTime():0}).forEach(u=>{u.rects.map(d=>{const f=Jc(d,r),p=Nc(u,o,i,s,f);if(c){const h=document.createElement("span");h.className="r6o-annotation",h.dataset.annotation=u.annotation.id,h.style.left=`${d.x}px`,h.style.top=`${d.y}px`,h.style.width=`${d.width}px`,h.style.height=`${d.height}px`,h.style.backgroundColor=Je((p==null?void 0:p.fill)||Tt.fill).alpha((p==null?void 0:p.fillOpacity)===void 0?Tt.fillOpacity:p.fillOpacity).toHex(),p.underlineStyle&&(h.style.borderStyle=p.underlineStyle),p.underlineColor&&(h.style.borderColor=p.underlineColor),p.underlineThickness&&(h.style.borderBottomWidth=`${p.underlineThickness}px`),p.underlineOffset&&(h.style.paddingBottom=`${p.underlineOffset}px`),t.appendChild(h)}})}),n=r)},setVisible:r=>{r?t.classList.remove("hidden"):t.classList.add("hidden")}}},Qc=(e,t,n)=>wo(e,t,n,Zc(e)),Ne=[];for(let e=0;e<256;++e)Ne.push((e+256).toString(16).slice(1));function eu(e,t=0){return(Ne[e[t+0]]+Ne[e[t+1]]+Ne[e[t+2]]+Ne[e[t+3]]+"-"+Ne[e[t+4]]+Ne[e[t+5]]+"-"+Ne[e[t+6]]+Ne[e[t+7]]+"-"+Ne[e[t+8]]+Ne[e[t+9]]+"-"+Ne[e[t+10]]+Ne[e[t+11]]+Ne[e[t+12]]+Ne[e[t+13]]+Ne[e[t+14]]+Ne[e[t+15]]).toLowerCase()}let Oo;const tu=new Uint8Array(16);function nu(){if(!Oo){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Oo=crypto.getRandomValues.bind(crypto)}return Oo(tu)}const ru=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),da={randomUUID:ru};function ou(e,t,n){if(da.randomUUID&&!t&&!e)return da.randomUUID();e=e||{};const r=e.random||(e.rng||nu)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,eu(r)}var pa=Object.prototype.hasOwnProperty;function Wt(e,t){var n,r;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((r=e.length)===t.length)for(;r--&&Wt(e[r],t[r]););return r===-1}if(!n||typeof e=="object"){r=0;for(n in e)if(pa.call(e,n)&&++r&&!pa.call(t,n)||!(n in t)||!Wt(e[n],t[n]))return!1;return Object.keys(t).length===r}}return e!==e&&t!==t}function Ro(){}function iu(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}const rn=[];function To(e,t=Ro){let n;const r=new Set;function o(l){if(iu(e,l)&&(e=l,n)){const c=!rn.length;for(const u of r)u[1](),rn.push(u,e);if(c){for(let u=0;u<rn.length;u+=2)rn[u][0](rn[u+1]);rn.length=0}}}function i(l){o(l(e))}function s(l,c=Ro){const u=[l,c];return r.add(u),r.size===1&&(n=t(o,i)||Ro),l(e),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:o,update:i,subscribe:s}}const au=e=>{const{subscribe:t,set:n}=To();let r;return t(o=>r=o),e.observe(({changes:o})=>{if(r){(o.deleted||[]).some(s=>s.id===r)&&n(void 0);const i=(o.updated||[]).find(({oldValue:s})=>s.id===r);i&&n(i.newValue.id)}}),{get current(){return r},subscribe:t,set:n}},Tr={selected:[]},su=(e,t,n)=>{const{subscribe:r,set:o}=To(Tr);let i=t,s=Tr;r(m=>s=m);const l=()=>{Wt(s,Tr)||o(Tr)},c=()=>{var m;return((m=s.selected)==null?void 0:m.length)===0},u=m=>{if(c())return!1;const v=typeof m=="string"?m:m.id;return s.selected.some(w=>w.id===v)},d=(m,v)=>{let w;if(Array.isArray(m)){if(w=m.map(g=>e.getAnnotation(g)).filter(Boolean),w.length<m.length){console.warn("Invalid selection: "+m.filter(g=>!w.some(x=>x.id===g)));return}}else{const g=e.getAnnotation(m);if(!g){console.warn("Invalid selection: "+m);return}w=[g]}const b=w.reduce((g,x)=>{const S=ha(x,i);return S==="EDIT"?[...g,{id:x.id,editable:!0}]:S==="SELECT"?[...g,{id:x.id}]:g},[]);o({selected:b,event:v})},f=(m,v)=>{const w=Array.isArray(m)?m:[m],b=w.map(g=>e.getAnnotation(g)).filter(g=>!!g);o({selected:b.map(g=>{const x=v===void 0?ha(g,i)==="EDIT":v;return{id:g.id,editable:x}})}),b.length!==w.length&&console.warn("Invalid selection",m)},p=m=>{if(c())return!1;const{selected:v}=s;v.some(({id:w})=>m.includes(w))&&o({selected:v.filter(({id:w})=>!m.includes(w))})},h=m=>i=m;return e.observe(({changes:m})=>p((m.deleted||[]).map(v=>v.id))),{get event(){return s?s.event:null},get selected(){return s?[...s.selected]:null},get userSelectAction(){return i},clear:l,isEmpty:c,isSelected:u,setSelected:f,setUserSelectAction:h,subscribe:r,userSelect:d}},ha=(e,t,n)=>typeof t=="function"?t(e):t||"EDIT",Le=[];for(let e=0;e<256;++e)Le.push((e+256).toString(16).slice(1));function lu(e,t=0){return(Le[e[t+0]]+Le[e[t+1]]+Le[e[t+2]]+Le[e[t+3]]+"-"+Le[e[t+4]]+Le[e[t+5]]+"-"+Le[e[t+6]]+Le[e[t+7]]+"-"+Le[e[t+8]]+Le[e[t+9]]+"-"+Le[e[t+10]]+Le[e[t+11]]+Le[e[t+12]]+Le[e[t+13]]+Le[e[t+14]]+Le[e[t+15]]).toLowerCase()}let Co;const cu=new Uint8Array(16);function uu(){if(!Co){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Co=crypto.getRandomValues.bind(crypto)}return Co(cu)}const fu=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ga={randomUUID:fu};function du(e,t,n){if(ga.randomUUID&&!t&&!e)return ga.randomUUID();e=e||{};const r=e.random||(e.rng||uu)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,lu(r)}const ko=e=>{const t=n=>{const r={...n};return n.created&&typeof n.created=="string"&&(r.created=new Date(n.created)),n.updated&&typeof n.updated=="string"&&(r.updated=new Date(n.updated)),r};return{...e,bodies:(e.bodies||[]).map(t),target:t(e.target)}},pu=(e,t)=>{const n=new Set(e.bodies.map(r=>r.id));return t.bodies.filter(r=>!n.has(r.id))},hu=(e,t)=>{const n=new Set(t.bodies.map(r=>r.id));return e.bodies.filter(r=>!n.has(r.id))},gu=(e,t)=>t.bodies.map(n=>{const r=e.bodies.find(o=>o.id===n.id);return{newBody:n,oldBody:r&&!Wt(r,n)?r:void 0}}).filter(({oldBody:n})=>n).map(({oldBody:n,newBody:r})=>({oldBody:n,newBody:r})),mu=(e,t)=>!Wt(e.target,t.target),ma=(e,t)=>{const n=pu(e,t),r=hu(e,t),o=gu(e,t);return{oldValue:e,newValue:t,bodiesCreated:n.length>0?n:void 0,bodiesDeleted:r.length>0?r:void 0,bodiesUpdated:o.length>0?o:void 0,targetUpdated:mu(e,t)?{oldTarget:e.target,newTarget:t.target}:void 0}};var de=(e=>(e.LOCAL="LOCAL",e.REMOTE="REMOTE",e.SILENT="SILENT",e))(de||{});const vu=(e,t)=>{var n,r;const{changes:o,origin:i}=t;if(!(e.options.origin?e.options.origin===i:i!=="SILENT"))return!1;if(e.options.ignore){const{ignore:s}=e.options,l=c=>c&&c.length>0;if(!(l(o.created)||l(o.deleted))){const c=(n=o.updated)==null?void 0:n.some(d=>l(d.bodiesCreated)||l(d.bodiesDeleted)||l(d.bodiesUpdated)),u=(r=o.updated)==null?void 0:r.some(d=>d.targetUpdated);if(s==="BODY_ONLY"&&c&&!u||s==="TARGET_ONLY"&&u&&!c)return!1}}if(e.options.annotations){const s=new Set([...(o.created||[]).map(l=>l.id),...(o.deleted||[]).map(l=>l.id),...(o.updated||[]).map(({oldValue:l})=>l.id)]);return!!(Array.isArray(e.options.annotations)?e.options.annotations:[e.options.annotations]).find(l=>s.has(l))}else return!0},yu=(e,t)=>{const n=new Set((e.created||[]).map(f=>f.id)),r=new Set((e.updated||[]).map(({newValue:f})=>f.id)),o=new Set((t.created||[]).map(f=>f.id)),i=new Set((t.deleted||[]).map(f=>f.id)),s=new Set((t.updated||[]).map(({oldValue:f})=>f.id)),l=new Set((t.updated||[]).filter(({oldValue:f})=>n.has(f.id)||r.has(f.id)).map(({oldValue:f})=>f.id)),c=[...(e.created||[]).filter(f=>!i.has(f.id)).map(f=>s.has(f.id)?t.updated.find(({oldValue:p})=>p.id===f.id).newValue:f),...t.created||[]],u=[...(e.deleted||[]).filter(f=>!o.has(f.id)),...(t.deleted||[]).filter(f=>!n.has(f.id))],d=[...(e.updated||[]).filter(({newValue:f})=>!i.has(f.id)).map(f=>{const{oldValue:p,newValue:h}=f;if(s.has(h.id)){const m=t.updated.find(v=>v.oldValue.id===h.id).newValue;return ma(p,m)}else return f}),...(t.updated||[]).filter(({oldValue:f})=>!l.has(f.id))];return{created:c,deleted:u,updated:d}},$o=e=>{const t=e.id===void 0?du():e.id;return{...e,id:t,bodies:e.bodies===void 0?[]:e.bodies.map(n=>({...n,annotation:t})),target:{...e.target,annotation:t}}},bu=e=>e.id!==void 0,wu=()=>{const e=new Map,t=new Map,n=[],r=(R,O={})=>{n.push({onChange:R,options:O})},o=R=>{const O=n.findIndex($=>$.onChange==R);O>-1&&n.splice(O,1)},i=(R,O)=>{const $={origin:R,changes:{created:O.created||[],updated:O.updated||[],deleted:O.deleted||[]},state:[...e.values()]};n.forEach(T=>{vu(T,$)&&T.onChange($)})},s=(R,O=de.LOCAL)=>{if(R.id&&e.get(R.id))throw Error(`Cannot add annotation ${R.id} - exists already`);{const $=$o(R);e.set($.id,$),$.bodies.forEach(T=>t.set(T.id,$.id)),i(O,{created:[$]})}},l=(R,O)=>{const $=$o(typeof R=="string"?O:R),T=typeof R=="string"?R:R.id,j=T&&e.get(T);if(j){const L=ma(j,$);return T===$.id?e.set(T,$):(e.delete(T),e.set($.id,$)),j.bodies.forEach(Y=>t.delete(Y.id)),$.bodies.forEach(Y=>t.set(Y.id,$.id)),L}else console.warn(`Cannot update annotation ${T} - does not exist`)},c=(R,O=de.LOCAL,$=de.LOCAL)=>{const T=bu(O)?$:O,j=l(R,O);j&&i(T,{updated:[j]})},u=(R,O=de.LOCAL)=>{const $=R.reduce((T,j)=>{const L=l(j);return L?[...T,L]:T},[]);$.length>0&&i(O,{updated:$})},d=(R,O=de.LOCAL)=>{const $=e.get(R.annotation);if($){const T={...$,bodies:[...$.bodies,R]};e.set($.id,T),t.set(R.id,T.id),i(O,{updated:[{oldValue:$,newValue:T,bodiesCreated:[R]}]})}else console.warn(`Attempt to add body to missing annotation: ${R.annotation}`)},f=()=>[...e.values()],p=(R=de.LOCAL)=>{const O=[...e.values()];e.clear(),t.clear(),i(R,{deleted:O})},h=(R,O=!0,$=de.LOCAL)=>{const T=R.map($o);if(O){const j=[...e.values()];e.clear(),t.clear(),T.forEach(L=>{e.set(L.id,L),L.bodies.forEach(Y=>t.set(Y.id,L.id))}),i($,{created:T,deleted:j})}else{const j=R.reduce((L,Y)=>{const q=Y.id&&e.get(Y.id);return q?[...L,q]:L},[]);if(j.length>0)throw Error(`Bulk insert would overwrite the following annotations: ${j.map(L=>L.id).join(", ")}`);T.forEach(L=>{e.set(L.id,L),L.bodies.forEach(Y=>t.set(Y.id,L.id))}),i($,{created:T})}},m=R=>{const O=typeof R=="string"?R:R.id,$=e.get(O);if($)return e.delete(O),$.bodies.forEach(T=>t.delete(T.id)),$;console.warn(`Attempt to delete missing annotation: ${O}`)},v=(R,O=de.LOCAL)=>{const $=m(R);$&&i(O,{deleted:[$]})},w=(R,O=de.LOCAL)=>{const $=R.reduce((T,j)=>{const L=m(j);return L?[...T,L]:T},[]);$.length>0&&i(O,{deleted:$})},b=R=>{const O=e.get(R.annotation);if(O){const $=O.bodies.find(T=>T.id===R.id);if($){t.delete($.id);const T={...O,bodies:O.bodies.filter(j=>j.id!==R.id)};return e.set(O.id,T),{oldValue:O,newValue:T,bodiesDeleted:[$]}}else console.warn(`Attempt to delete missing body ${R.id} from annotation ${R.annotation}`)}else console.warn(`Attempt to delete body from missing annotation ${R.annotation}`)},g=(R,O=de.LOCAL)=>{const $=b(R);$&&i(O,{updated:[$]})},x=(R,O=de.LOCAL)=>{const $=R.map(T=>b(T)).filter(Boolean);$.length>0&&i(O,{updated:$})},S=R=>{const O=e.get(R);return O?{...O}:void 0},A=R=>{const O=t.get(R);if(O){const $=S(O).bodies.find(T=>T.id===R);if($)return $;console.error(`Store integrity error: body ${R} in index, but not in annotation`)}else console.warn(`Attempt to retrieve missing body: ${R}`)},P=(R,O)=>{if(R.annotation!==O.annotation)throw"Annotation integrity violation: annotation ID must be the same when updating bodies";const $=e.get(R.annotation);if($){const T=$.bodies.find(L=>L.id===R.id),j={...$,bodies:$.bodies.map(L=>L.id===T.id?O:L)};return e.set($.id,j),T.id!==O.id&&(t.delete(T.id),t.set(O.id,j.id)),{oldValue:$,newValue:j,bodiesUpdated:[{oldBody:T,newBody:O}]}}else console.warn(`Attempt to add body to missing annotation ${R.annotation}`)},_=(R,O,$=de.LOCAL)=>{const T=P(R,O);T&&i($,{updated:[T]})},C=(R,O=de.LOCAL)=>{const $=R.map(T=>P({id:T.id,annotation:T.annotation},T)).filter(Boolean);i(O,{updated:$})},M=R=>{const O=e.get(R.annotation);if(O){const $={...O,target:{...O.target,...R}};return e.set(O.id,$),{oldValue:O,newValue:$,targetUpdated:{oldTarget:O.target,newTarget:R}}}else console.warn(`Attempt to update target on missing annotation: ${R.annotation}`)};return{addAnnotation:s,addBody:d,all:f,bulkAddAnnotation:h,bulkDeleteAnnotation:w,bulkDeleteBodies:x,bulkUpdateAnnotation:u,bulkUpdateBodies:C,bulkUpdateTargets:(R,O=de.LOCAL)=>{const $=R.map(T=>M(T)).filter(Boolean);$.length>0&&i(O,{updated:$})},clear:p,deleteAnnotation:v,deleteBody:g,getAnnotation:S,getBody:A,observe:r,unobserve:o,updateAnnotation:c,updateBody:_,updateTarget:(R,O=de.LOCAL)=>{const $=M(R);$&&i(O,{updated:[$]})}}};let xu=()=>({emit(e,...t){for(let n=this.events[e]||[],r=0,o=n.length;r<o;r++)n[r](...t)},events:{},on(e,t){var n;return((n=this.events)[e]||(n[e]=[])).push(t),()=>{var r;this.events[e]=(r=this.events[e])==null?void 0:r.filter(o=>t!==o)}}});const Eu=250,Au=(e,t)=>{const n=xu(),r=[];let o=-1,i=!1,s=0;const l=m=>{if(!i){const{changes:v}=m,w=performance.now();if(w-s>Eu)r.splice(o+1),r.push(v),o=r.length-1;else{const b=r.length-1;r[b]=yu(r[b],v)}s=w}i=!1};e.observe(l,{origin:de.LOCAL});const c=m=>m&&m.length>0&&e.bulkDeleteAnnotation(m),u=m=>m&&m.length>0&&e.bulkAddAnnotation(m,!1),d=m=>m&&m.length>0&&e.bulkUpdateAnnotation(m.map(({oldValue:v})=>v)),f=m=>m&&m.length>0&&e.bulkUpdateAnnotation(m.map(({newValue:v})=>v)),p=m=>m&&m.length>0&&e.bulkAddAnnotation(m,!1),h=m=>m&&m.length>0&&e.bulkDeleteAnnotation(m);return{canRedo:()=>r.length-1>o,canUndo:()=>o>-1,destroy:()=>e.unobserve(l),getHistory:()=>({changes:[...r],pointer:o}),on:(m,v)=>n.on(m,v),redo:()=>{if(r.length-1>o){i=!0;const{created:m,updated:v,deleted:w}=r[o+1];u(m),f(v),h(w),n.emit("redo",r[o+1]),o+=1}},undo:()=>{if(o>-1){i=!0;const{created:m,updated:v,deleted:w}=r[o];c(m),d(v),p(w),n.emit("undo",r[o]),o-=1}}}},Su=()=>{const{subscribe:e,set:t}=To([]);return{subscribe:e,set:t}},Ou=(e,t,n,r)=>{const{hover:o,selection:i,store:s,viewport:l}=e,c=new Map;let u=[],d;const f=(v,w)=>{c.has(v)?c.get(v).push(w):c.set(v,[w])},p=(v,w)=>{const b=c.get(v);if(b){const g=b.indexOf(w);g!==-1&&b.splice(g,1)}},h=(v,w,b)=>{c.has(v)&&setTimeout(()=>{c.get(v).forEach(g=>{if(n){const x=Array.isArray(w)?w.map(A=>n.serialize(A)):n.serialize(w),S=b?b instanceof PointerEvent?b:n.serialize(b):void 0;g(x,S)}else g(w,b)})},1)};i.subscribe(({selected:v})=>{if(!(u.length===0&&v.length===0)){if(u.length===0&&v.length>0)u=v.map(({id:w})=>s.getAnnotation(w));else if(u.length>0&&v.length===0)u.forEach(w=>{const b=s.getAnnotation(w.id);b&&!Wt(b,w)&&h("updateAnnotation",b,w)}),u=[];else{const w=new Set(u.map(g=>g.id)),b=new Set(v.map(({id:g})=>g));u.filter(g=>!b.has(g.id)).forEach(g=>{const x=s.getAnnotation(g.id);x&&!Wt(x,g)&&h("updateAnnotation",x,g)}),u=[...u.filter(g=>b.has(g.id)),...v.filter(({id:g})=>!w.has(g)).map(({id:g})=>s.getAnnotation(g))]}h("selectionChanged",u)}}),o.subscribe(v=>{!d&&v?h("mouseEnterAnnotation",s.getAnnotation(v)):d&&!v?h("mouseLeaveAnnotation",s.getAnnotation(d)):d&&v&&(h("mouseLeaveAnnotation",s.getAnnotation(d)),h("mouseEnterAnnotation",s.getAnnotation(v))),d=v}),l==null||l.subscribe(v=>h("viewportIntersect",v.map(w=>s.getAnnotation(w)))),s.observe(v=>{const{created:w,deleted:b}=v.changes;(w||[]).forEach(g=>h("createAnnotation",g)),(b||[]).forEach(g=>h("deleteAnnotation",g)),(v.changes.updated||[]).filter(g=>[...g.bodiesCreated||[],...g.bodiesDeleted||[],...g.bodiesUpdated||[]].length>0).forEach(({oldValue:g,newValue:x})=>{const S=u.find(A=>A.id===g.id)||g;u=u.map(A=>A.id===g.id?x:A),h("updateAnnotation",x,S)})},{origin:de.LOCAL}),s.observe(v=>{if(u){const w=new Set(u.map(g=>g.id)),b=(v.changes.updated||[]).filter(({newValue:g})=>w.has(g.id)).map(({newValue:g})=>g);b.length>0&&(u=u.map(g=>b.find(x=>x.id===g.id)||g))}},{origin:de.REMOTE});const m=v=>w=>{const{updated:b}=w;v?(b||[]).forEach(g=>h("updateAnnotation",g.oldValue,g.newValue)):(b||[]).forEach(g=>h("updateAnnotation",g.newValue,g.oldValue))};return t.on("undo",m(!0)),t.on("redo",m(!1)),{on:f,off:p,emit:h}},Ru=e=>t=>t.reduce((n,r)=>{const{parsed:o,error:i}=e.parse(r);return i?{parsed:n.parsed,failed:[...n.failed,r]}:o?{parsed:[...n.parsed,o],failed:n.failed}:{...n}},{parsed:[],failed:[]}),Tu=(e,t,n)=>{const{store:r,selection:o}=e,i=b=>{if(n){const{parsed:g,error:x}=n.parse(b);g?r.addAnnotation(g,de.REMOTE):console.error(x)}else r.addAnnotation(ko(b),de.REMOTE)},s=()=>o.clear(),l=()=>r.clear(),c=b=>{const g=r.getAnnotation(b);return n&&g?n.serialize(g):g},u=()=>n?r.all().map(n.serialize):r.all(),d=()=>{var b;const g=(((b=o.selected)==null?void 0:b.map(x=>x.id))||[]).map(x=>r.getAnnotation(x)).filter(Boolean);return n?g.map(n.serialize):g},f=(b,g=!0)=>fetch(b).then(x=>x.json()).then(x=>(h(x,g),x)),p=b=>{if(typeof b=="string"){const g=r.getAnnotation(b);if(r.deleteAnnotation(b),g)return n?n.serialize(g):g}else{const g=n?n.parse(b).parsed:b;if(g)return r.deleteAnnotation(g),b}},h=(b,g=!0)=>{if(n){const x=n.parseAll||Ru(n),{parsed:S,failed:A}=x(b);A.length>0&&console.warn(`Discarded ${A.length} invalid annotations`,A),r.bulkAddAnnotation(S,g,de.REMOTE)}else r.bulkAddAnnotation(b.map(ko),g,de.REMOTE)},m=(b,g)=>{b?o.setSelected(b,g):o.clear()},v=b=>{o.clear(),o.setUserSelectAction(b)},w=b=>{if(n){const g=n.parse(b).parsed,x=n.serialize(r.getAnnotation(g.id));return r.updateAnnotation(g),x}else{const g=r.getAnnotation(b.id);return r.updateAnnotation(ko(b)),g}};return{addAnnotation:i,cancelSelected:s,canRedo:t.canRedo,canUndo:t.canUndo,clearAnnotations:l,getAnnotationById:c,getAnnotations:u,getHistory:t.getHistory,getSelected:d,loadAnnotations:f,redo:t.redo,removeAnnotation:p,setAnnotations:h,setSelected:m,setUserSelectAction:v,undo:t.undo,updateAnnotation:w}},Cu="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let ku=e=>crypto.getRandomValues(new Uint8Array(e)),$u=(e,t,n)=>{let r=(2<<Math.log2(e.length-1))-1,o=-~(1.6*r*t/e.length);return(i=t)=>{let s="";for(;;){let l=n(o),c=o|0;for(;c--;)if(s+=e[l[c]&r]||"",s.length>=i)return s}}},_u=(e,t=21)=>$u(e,t|0,ku),Pu=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=Cu[n[e]&63];return t};const ju=()=>({isGuest:!0,id:_u("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_",20)()});Pu();function va(e,t,n=0,r=e.length-1,o=Nu){for(;r>n;){if(r-n>600){const c=r-n+1,u=t-n+1,d=Math.log(c),f=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),h=Math.max(n,Math.floor(t-u*f/c+p)),m=Math.min(r,Math.floor(t+(c-u)*f/c+p));va(e,t,h,m,o)}const i=e[t];let s=n,l=r;for(_n(e,n,t),o(e[r],i)>0&&_n(e,n,r);s<l;){for(_n(e,s,l),s++,l--;o(e[s],i)<0;)s++;for(;o(e[l],i)>0;)l--}o(e[n],i)===0?_n(e,n,l):(l++,_n(e,l,r)),l<=t&&(n=l+1),t<=l&&(r=l-1)}}function _n(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Nu(e,t){return e<t?-1:e>t?1:0}class Lu{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let n=this.data;const r=[];if(!kr(t,n))return r;const o=this.toBBox,i=[];for(;n;){for(let s=0;s<n.children.length;s++){const l=n.children[s],c=n.leaf?o(l):l;kr(t,c)&&(n.leaf?r.push(l):Po(t,c)?this._all(l,r):i.push(l))}n=i.pop()}return r}collides(t){let n=this.data;if(!kr(t,n))return!1;const r=[];for(;n;){for(let o=0;o<n.children.length;o++){const i=n.children[o],s=n.leaf?this.toBBox(i):i;if(kr(t,s)){if(n.leaf||Po(t,s))return!0;r.push(i)}}n=r.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return this}let n=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=an([]),this}remove(t,n){if(!t)return this;let r=this.data;const o=this.toBBox(t),i=[],s=[];let l,c,u;for(;r||i.length;){if(r||(r=i.pop(),c=i[i.length-1],l=s.pop(),u=!0),r.leaf){const d=Iu(t,r.children,n);if(d!==-1)return r.children.splice(d,1),i.push(r),this._condense(i),this}!u&&!r.leaf&&Po(r,o)?(i.push(r),s.push(l),l=0,c=r,r=r.children[0]):c?(l++,r=c.children[l],u=!1):r=null}return this}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,n){const r=[];for(;t;)t.leaf?n.push(...t.children):r.push(...t.children),t=r.pop();return n}_build(t,n,r,o){const i=r-n+1;let s=this._maxEntries,l;if(i<=s)return l=an(t.slice(n,r+1)),on(l,this.toBBox),l;o||(o=Math.ceil(Math.log(i)/Math.log(s)),s=Math.ceil(i/Math.pow(s,o-1))),l=an([]),l.leaf=!1,l.height=o;const c=Math.ceil(i/s),u=c*Math.ceil(Math.sqrt(s));ya(t,n,r,u,this.compareMinX);for(let d=n;d<=r;d+=u){const f=Math.min(d+u-1,r);ya(t,d,f,c,this.compareMinY);for(let p=d;p<=f;p+=c){const h=Math.min(p+c-1,f);l.children.push(this._build(t,p,h,o-1))}}return on(l,this.toBBox),l}_chooseSubtree(t,n,r,o){for(;o.push(n),!(n.leaf||o.length-1===r);){let i=1/0,s=1/0,l;for(let c=0;c<n.children.length;c++){const u=n.children[c],d=_o(u),f=Fu(t,u)-d;f<s?(s=f,i=d<i?d:i,l=u):f===s&&d<i&&(i=d,l=u)}n=l||n.children[0]}return n}_insert(t,n,r){const o=r?t:this.toBBox(t),i=[],s=this._chooseSubtree(o,this.data,n,i);for(s.children.push(t),jn(s,o);n>=0&&i[n].children.length>this._maxEntries;)this._split(i,n),n--;this._adjustParentBBoxes(o,i,n)}_split(t,n){const r=t[n],o=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,o);const s=this._chooseSplitIndex(r,i,o),l=an(r.children.splice(s,r.children.length-s));l.height=r.height,l.leaf=r.leaf,on(r,this.toBBox),on(l,this.toBBox),n?t[n-1].children.push(l):this._splitRoot(r,l)}_splitRoot(t,n){this.data=an([t,n]),this.data.height=t.height+1,this.data.leaf=!1,on(this.data,this.toBBox)}_chooseSplitIndex(t,n,r){let o,i=1/0,s=1/0;for(let l=n;l<=r-n;l++){const c=Pn(t,0,l,this.toBBox),u=Pn(t,l,r,this.toBBox),d=Bu(c,u),f=_o(c)+_o(u);d<i?(i=d,o=l,s=f<s?f:s):d===i&&f<s&&(s=f,o=l)}return o||r-n}_chooseSplitAxis(t,n,r){const o=t.leaf?this.compareMinX:Du,i=t.leaf?this.compareMinY:Mu,s=this._allDistMargin(t,n,r,o),l=this._allDistMargin(t,n,r,i);s<l&&t.children.sort(o)}_allDistMargin(t,n,r,o){t.children.sort(o);const i=this.toBBox,s=Pn(t,0,n,i),l=Pn(t,r-n,r,i);let c=Cr(s)+Cr(l);for(let u=n;u<r-n;u++){const d=t.children[u];jn(s,t.leaf?i(d):d),c+=Cr(s)}for(let u=r-n-1;u>=n;u--){const d=t.children[u];jn(l,t.leaf?i(d):d),c+=Cr(l)}return c}_adjustParentBBoxes(t,n,r){for(let o=r;o>=0;o--)jn(n[o],t)}_condense(t){for(let n=t.length-1,r;n>=0;n--)t[n].children.length===0?n>0?(r=t[n-1].children,r.splice(r.indexOf(t[n]),1)):this.clear():on(t[n],this.toBBox)}}function Iu(e,t,n){if(!n)return t.indexOf(e);for(let r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function on(e,t){Pn(e,0,e.children.length,t,e)}function Pn(e,t,n,r,o){o||(o=an(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let i=t;i<n;i++){const s=e.children[i];jn(o,e.leaf?r(s):s)}return o}function jn(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function Du(e,t){return e.minX-t.minX}function Mu(e,t){return e.minY-t.minY}function _o(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Cr(e){return e.maxX-e.minX+(e.maxY-e.minY)}function Fu(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function Bu(e,t){const n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,i-r)}function Po(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function kr(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function an(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ya(e,t,n,r,o){const i=[t,n];for(;i.length;){if(n=i.pop(),t=i.pop(),n-t<=r)continue;const s=t+Math.ceil((n-t)/r/2)*r;va(e,s,t,n,o),i.push(t,s,s,n)}}const Uu=(e,t)=>{const n=new Lu,r=new Map,o=(m,v)=>{const w=m.selector.flatMap(g=>{const x=gt([g])?g.range:Zi(g,t).range;return Array.from(x.getClientRects())}),b=kc(w).map(({left:g,top:x,right:S,bottom:A})=>new DOMRect(g-v.left,x-v.top,S-g,A-x));return b.map(g=>{const{x,y:S,width:A,height:P}=g;return{minX:x,minY:S,maxX:x+A,maxY:S+P,annotation:{id:m.annotation,rects:b}}})},i=()=>[...r.values()],s=()=>{n.clear(),r.clear()},l=m=>{const v=o(m,t.getBoundingClientRect());v.length!==0&&(v.forEach(w=>n.insert(w)),r.set(m.annotation,v))},c=m=>{const v=r.get(m.annotation);v&&(v.forEach(w=>n.remove(w)),r.delete(m.annotation))},u=m=>{c(m),l(m)},d=(m,v=!0)=>{v&&s();const w=t.getBoundingClientRect(),b=m.map(x=>({target:x,rects:o(x,w)}));b.forEach(({target:x,rects:S})=>{S.length>0&&r.set(x.annotation,S)});const g=b.flatMap(({rects:x})=>x);n.load(g)},f=(m,v,w=!1)=>{const b=n.search({minX:m,minY:v,maxX:m,maxY:v}),g=x=>x.annotation.rects.reduce((S,A)=>S+A.width*A.height,0);return b.length>0?(b.sort((x,S)=>g(x)-g(S)),w?b.map(x=>x.annotation.id):[b[0].annotation.id]):[]},p=m=>{const v=h(m);if(v.length===0)return;let w=v[0].left,b=v[0].top,g=v[0].right,x=v[0].bottom;for(let S=1;S<v.length;S++){const A=v[S];w=Math.min(w,A.left),b=Math.min(b,A.top),g=Math.max(g,A.right),x=Math.max(x,A.bottom)}return new DOMRect(w,b,g-w,x-b)},h=m=>{const v=r.get(m);return v?v[0].annotation.rects:[]};return{all:i,clear:s,getAt:f,getAnnotationBounds:p,getAnnotationRects:h,getIntersecting:(m,v,w,b)=>{const g=n.search({minX:m,minY:v,maxX:w,maxY:b}),x=new Set(g.map(S=>S.annotation.id));return Array.from(x).map(S=>({annotation:e.getAnnotation(S),rects:h(S)})).filter(S=>!!S.annotation)},insert:l,recalculate:()=>d(e.all().map(m=>m.target),!0),remove:c,set:d,size:()=>n.all().length,update:u}},Vu=(e,t)=>{const n=wu(),r=Uu(n,e),o=su(n);o.setUserSelectAction(t);const i=au(n),s=Su(),l=(b,g=de.LOCAL)=>{const x=bo(b,e),S=gt(x.target.selector);return S&&n.addAnnotation(x,g),S},c=(b,g=!0,x=de.LOCAL)=>{const S=b.map(P=>bo(P,e)),A=S.filter(P=>!gt(P.target.selector));return n.bulkAddAnnotation(S,g,x),A},u=(b,g=de.LOCAL)=>{const x=b.map(A=>bo(A,e)),S=x.filter(A=>!gt(A.target.selector));return x.forEach(A=>{n.getAnnotation(A.id)?n.updateAnnotation(A,g):n.addAnnotation(A,g)}),S},d=(b,g=de.LOCAL)=>{const x=Sr(b,e);n.updateTarget(x,g)},f=(b,g=de.LOCAL)=>{const x=b.map(S=>Sr(S,e));n.bulkUpdateTargets(x,g)};function p(b,g,x,S){const A=x||!!S,P=r.getAt(b,g,A).map(C=>n.getAnnotation(C)),_=S?P.filter(S):P;if(_.length!==0)return x?_:_[0]}const h=b=>{if(r.getAnnotationRects(b).length!==0)return r.getAnnotationBounds(b)},m=(b,g,x,S)=>r.getIntersecting(b,g,x,S),v=b=>r.getAnnotationRects(b),w=()=>r.recalculate();return n.observe(({changes:b})=>{const g=(b.deleted||[]).filter(A=>gt(A.target.selector)),x=(b.created||[]).filter(A=>gt(A.target.selector)),S=(b.updated||[]).filter(A=>gt(A.newValue.target.selector));(g==null?void 0:g.length)>0&&g.forEach(A=>r.remove(A.target)),x.length>0&&r.set(x.map(A=>A.target),!1),(S==null?void 0:S.length)>0&&S.forEach(({newValue:A})=>r.update(A.target))}),{store:{...n,addAnnotation:l,bulkAddAnnotation:c,bulkUpdateTargets:f,bulkUpsertAnnotations:u,getAnnotationBounds:h,getAnnotationRects:v,getIntersecting:m,getAt:p,recalculatePositions:w,updateTarget:d},selection:o,hover:i,viewport:s}},Yu=()=>{const e=document.createElement("canvas");e.width=2*window.innerWidth,e.height=2*window.innerHeight,e.className="r6o-presence-layer";const t=e.getContext("2d");return t.scale(2,2),t.translate(.5,.5),e},Hu=(e,t={})=>{const n=Yu(),r=n.getContext("2d");document.body.appendChild(n);const o=new Map,i=s=>Array.from(o.entries()).filter(([l,c])=>c.presenceKey===s.presenceKey).map(([l,c])=>l);return e.on("selectionChange",(s,l)=>{i(s).forEach(c=>o.delete(c)),l&&l.forEach(c=>o.set(c,s))}),{clear:()=>{const{width:s,height:l}=n;r.clearRect(-.5,-.5,s+1,l+1)},destroy:()=>{n.remove()},paint:(s,l,c)=>{t.font&&(r.font=t.font);const u=o.get(s.annotation.id);if(u){const{height:d}=s.rects[0],f=s.rects[0].x+l.left,p=s.rects[0].y+l.top;r.fillStyle=u.appearance.color,r.fillRect(f-2,p-2.5,2,d+5);const h=r.measureText(u.appearance.label),m=h.width+6,v=h.actualBoundingBoxAscent+h.actualBoundingBoxDescent+8,w=h.fontBoundingBoxAscent?8:6.5;return r.fillRect(f-2,p-2.5-v,m,v),r.fillStyle="#fff",r.fillText(u.appearance.label,f+1,p-w),{fill:u.appearance.color,fillOpacity:c?.45:.18}}},reset:()=>{n.width=2*window.innerWidth,n.height=2*window.innerHeight;const s=n.getContext("2d");s.scale(2,2),s.translate(.5,.5)}}},jo=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function No(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on".concat(t),n)}function Nn(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on".concat(t),n)}function ba(e,t){const n=t.slice(0,t.length-1);for(let r=0;r<n.length;r++)n[r]=e[n[r].toLowerCase()];return n}function wa(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");const t=e.split(",");let n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}function Wu(e,t){const n=e.length>=t.length?e:t,r=e.length>=t.length?t:e;let o=!0;for(let i=0;i<n.length;i++)r.indexOf(n[i])===-1&&(o=!1);return o}const Ln={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":jo?173:189,"=":jo?61:187,";":jo?59:186,"'":222,"[":219,"]":221,"\\":220},at={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},$r={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Ie={16:!1,18:!1,17:!1,91:!1},we={};for(let e=1;e<20;e++)Ln["f".concat(e)]=111+e;let ye=[],In=null,xa="all";const vt=new Map,Dn=e=>Ln[e.toLowerCase()]||at[e.toLowerCase()]||e.toUpperCase().charCodeAt(0),Ku=e=>Object.keys(Ln).find(t=>Ln[t]===e),Xu=e=>Object.keys(at).find(t=>at[t]===e);function Ea(e){xa=e||"all"}function Mn(){return xa||"all"}function zu(){return ye.slice(0)}function qu(){return ye.map(e=>Ku(e)||Xu(e)||String.fromCharCode(e))}function Gu(){const e=[];return Object.keys(we).forEach(t=>{we[t].forEach(n=>{let{key:r,scope:o,mods:i,shortcut:s}=n;e.push({scope:o,shortcut:s,mods:i,keys:r.split("+").map(l=>Dn(l))})})}),e}function Ju(e){const t=e.target||e.srcElement,{tagName:n}=t;let r=!0;const o=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(t.type);return(t.isContentEditable||(o||n==="TEXTAREA"||n==="SELECT")&&!t.readOnly)&&(r=!1),r}function Zu(e){return typeof e=="string"&&(e=Dn(e)),ye.indexOf(e)!==-1}function Qu(e,t){let n,r;e||(e=Mn());for(const o in we)if(Object.prototype.hasOwnProperty.call(we,o))for(n=we[o],r=0;r<n.length;)n[r].scope===e?n.splice(r,1).forEach(i=>{let{element:s}=i;return Lo(s)}):r++;Mn()===e&&Ea(t||"all")}function ef(e){let t=e.keyCode||e.which||e.charCode;const n=ye.indexOf(t);if(n>=0&&ye.splice(n,1),e.key&&e.key.toLowerCase()==="meta"&&ye.splice(0,ye.length),(t===93||t===224)&&(t=91),t in Ie){Ie[t]=!1;for(const r in at)at[r]===t&&(ze[r]=!1)}}function Aa(e){if(typeof e>"u")Object.keys(we).forEach(o=>{Array.isArray(we[o])&&we[o].forEach(i=>_r(i)),delete we[o]}),Lo(null);else if(Array.isArray(e))e.forEach(o=>{o.key&&_r(o)});else if(typeof e=="object")e.key&&_r(e);else if(typeof e=="string"){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let[o,i]=n;typeof o=="function"&&(i=o,o=""),_r({key:e,scope:o,method:i,splitKey:"+"})}}const _r=e=>{let{key:t,scope:n,method:r,splitKey:o="+"}=e;wa(t).forEach(i=>{const s=i.split(o),l=s.length,c=s[l-1],u=c==="*"?"*":Dn(c);if(!we[u])return;n||(n=Mn());const d=l>1?ba(at,s):[],f=[];we[u]=we[u].filter(p=>{const h=(r?p.method===r:!0)&&p.scope===n&&Wu(p.mods,d);return h&&f.push(p.element),!h}),f.forEach(p=>Lo(p))})};function Sa(e,t,n,r){if(t.element!==r)return;let o;if(t.scope===n||t.scope==="all"){o=t.mods.length>0;for(const i in Ie)Object.prototype.hasOwnProperty.call(Ie,i)&&(!Ie[i]&&t.mods.indexOf(+i)>-1||Ie[i]&&t.mods.indexOf(+i)===-1)&&(o=!1);(t.mods.length===0&&!Ie[16]&&!Ie[18]&&!Ie[17]&&!Ie[91]||o||t.shortcut==="*")&&(t.keys=[],t.keys=t.keys.concat(ye),t.method(e,t)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function Oa(e,t){const n=we["*"];let r=e.keyCode||e.which||e.charCode;if(!ze.filter.call(this,e))return;if((r===93||r===224)&&(r=91),ye.indexOf(r)===-1&&r!==229&&ye.push(r),["metaKey","ctrlKey","altKey","shiftKey"].forEach(l=>{const c=$r[l];e[l]&&ye.indexOf(c)===-1?ye.push(c):!e[l]&&ye.indexOf(c)>-1?ye.splice(ye.indexOf(c),1):l==="metaKey"&&e[l]&&(ye=ye.filter(u=>u in $r||u===r))}),r in Ie){Ie[r]=!0;for(const l in at)at[l]===r&&(ze[l]=!0);if(!n)return}for(const l in Ie)Object.prototype.hasOwnProperty.call(Ie,l)&&(Ie[l]=e[$r[l]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(ye.indexOf(17)===-1&&ye.push(17),ye.indexOf(18)===-1&&ye.push(18),Ie[17]=!0,Ie[18]=!0);const o=Mn();if(n)for(let l=0;l<n.length;l++)n[l].scope===o&&(e.type==="keydown"&&n[l].keydown||e.type==="keyup"&&n[l].keyup)&&Sa(e,n[l],o,t);if(!(r in we))return;const i=we[r],s=i.length;for(let l=0;l<s;l++)if((e.type==="keydown"&&i[l].keydown||e.type==="keyup"&&i[l].keyup)&&i[l].key){const c=i[l],{splitKey:u}=c,d=c.key.split(u),f=[];for(let p=0;p<d.length;p++)f.push(Dn(d[p]));f.sort().join("")===ye.sort().join("")&&Sa(e,c,o,t)}}function ze(e,t,n){ye=[];const r=wa(e);let o=[],i="all",s=document,l=0,c=!1,u=!0,d="+",f=!1,p=!1;for(n===void 0&&typeof t=="function"&&(n=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(i=t.scope),t.element&&(s=t.element),t.keyup&&(c=t.keyup),t.keydown!==void 0&&(u=t.keydown),t.capture!==void 0&&(f=t.capture),typeof t.splitKey=="string"&&(d=t.splitKey),t.single===!0&&(p=!0)),typeof t=="string"&&(i=t),p&&Aa(e,i);l<r.length;l++)e=r[l].split(d),o=[],e.length>1&&(o=ba(at,e)),e=e[e.length-1],e=e==="*"?"*":Dn(e),e in we||(we[e]=[]),we[e].push({keyup:c,keydown:u,scope:i,mods:o,shortcut:r[l],method:n,key:r[l],splitKey:d,element:s});if(typeof s<"u"&&window){if(!vt.has(s)){const h=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return Oa(v,s)},m=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;Oa(v,s),ef(v)};vt.set(s,{keydownListener:h,keyupListenr:m,capture:f}),No(s,"keydown",h,f),No(s,"keyup",m,f)}if(!In){const h=()=>{ye=[]};In={listener:h,capture:f},No(window,"focus",h,f)}}}function tf(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(we).forEach(n=>{we[n].filter(r=>r.scope===t&&r.shortcut===e).forEach(r=>{r&&r.method&&r.method()})})}function Lo(e){const t=Object.values(we).flat();if(t.findIndex(n=>{let{element:r}=n;return r===e})<0){const{keydownListener:n,keyupListenr:r,capture:o}=vt.get(e)||{};n&&r&&(Nn(e,"keyup",r,o),Nn(e,"keydown",n,o),vt.delete(e))}if((t.length<=0||vt.size<=0)&&(Object.keys(vt).forEach(n=>{const{keydownListener:r,keyupListenr:o,capture:i}=vt.get(n)||{};r&&o&&(Nn(n,"keyup",o,i),Nn(n,"keydown",r,i),vt.delete(n))}),vt.clear(),Object.keys(we).forEach(n=>delete we[n]),In)){const{listener:n,capture:r}=In;Nn(window,"focus",n,r),In=null}}const Io={getPressedKeyString:qu,setScope:Ea,getScope:Mn,deleteScope:Qu,getPressedKeyCodes:zu,getAllKeyCodes:Gu,isPressed:Zu,filter:Ju,trigger:tf,unbind:Aa,keyMap:Ln,modifier:at,modifierMap:$r};for(const e in Io)Object.prototype.hasOwnProperty.call(Io,e)&&(ze[e]=Io[e]);if(typeof window<"u"){const e=window.hotkeys;ze.noConflict=t=>(t&&window.hotkeys===ze&&(window.hotkeys=e),ze),window.hotkeys=ze}const Ra=300,Ta=["up","down","left","right"],Ca=wc?"⌘+a":"ctrl+a",nf=[...Ta.map(e=>`shift+${e}`),Ca],rf=(e,t,n)=>{let r;const{annotatingEnabled:o,offsetReferenceSelector:i,selectionMode:s}=n,l=C=>r=C;let c;const u=C=>c=C,{store:d,selection:f}=t;let p,h,m;const v=C=>{h!==!1&&(p=kn(C.target)?void 0:{annotation:ou(),selector:[],creator:r,created:new Date})},w=yo(C=>{const M=document.getSelection();if(!(M!=null&&M.anchorNode))return;if(kn(M.anchorNode)){p=void 0;return}const R=C.timeStamp-((m==null?void 0:m.timeStamp)||C.timeStamp);if((m==null?void 0:m.type)==="pointerdown"&&(R<1e3&&!p||M.isCollapsed&&R<Ra)&&v(m||C),!p)return;if(M.isCollapsed){d.getAnnotation(p.annotation)&&(f.clear(),d.deleteAnnotation(p.annotation));return}const O=M.getRangeAt(0),$=Pc(O,e);if(Rc($))return;const T=Ac($.cloneRange());(T.length!==p.selector.length||T.some((j,L)=>{var Y;return j.toString()!==((Y=p.selector[L])==null?void 0:Y.quote)}))&&(p={...p,selector:T.map(j=>_c(j,e,i)),updated:new Date},d.getAnnotation(p.annotation)?d.updateTarget(p,de.LOCAL):f.clear())}),b=C=>{kn(C.target)||(m=vo(C),h=m.button===0)},g=C=>{if(kn(C.target)||!h)return;const M=()=>{const{x:O,y:$}=e.getBoundingClientRect(),T=C.target instanceof Node&&e.contains(C.target)&&d.getAt(C.clientX-O,C.clientY-$,s==="all",c);if(T){const{selected:j}=f,L=new Set(j.map(q=>q.id)),Y=Array.isArray(T)?T.map(q=>q.id):[T.id];(L.size!==Y.length||!Y.every(q=>L.has(q)))&&f.userSelect(Y,C)}else f.clear()},R=C.timeStamp-m.timeStamp;setTimeout(()=>{const O=document.getSelection();O!=null&&O.isCollapsed&&R<Ra?(p=void 0,M()):p&&p.selector.length>0&&(_(),f.userSelect(p.annotation,vo(C)))})},x=C=>{const M=document.getSelection();M!=null&&M.isCollapsed||((!p||p.selector.length===0)&&w(C),_(),f.userSelect(p.annotation,vo(C)))},S=C=>{C.key==="Shift"&&p&&(document.getSelection().isCollapsed||(_(),f.userSelect(p.annotation,Ar(C))))},A=C=>{const M=()=>setTimeout(()=>{(p==null?void 0:p.selector.length)>0&&(f.clear(),d.addAnnotation({id:p.annotation,bodies:[],target:p}),f.userSelect(p.annotation,Ar(C))),document.removeEventListener("selectionchange",M)},100);document.addEventListener("selectionchange",M),v(C)};ze(nf.join(","),{element:e,keydown:!0,keyup:!1},C=>{C.repeat||(m=Ar(C))}),ze(Ca,{keydown:!0,keyup:!1},C=>{m=Ar(C),A(C)});const P=C=>{C.repeat||C.target!==e&&C.target!==document.body||(p=void 0,f.clear())};ze(Ta.join(","),{keydown:!0,keyup:!1},P);const _=()=>{const C=d.getAnnotation(p.annotation);if(!C){d.addAnnotation({id:p.annotation,bodies:[],target:p});return}const{target:{updated:M}}=C,{updated:R}=p;(!M||!R||M<R)&&d.updateTarget(p)};return e.addEventListener("pointerdown",b),document.addEventListener("pointerup",g),document.addEventListener("contextmenu",x),o&&(e.addEventListener("keyup",S),e.addEventListener("selectstart",v),document.addEventListener("selectionchange",w)),{destroy:()=>{e.removeEventListener("pointerdown",b),document.removeEventListener("pointerup",g),document.removeEventListener("contextmenu",x),e.removeEventListener("keyup",S),e.removeEventListener("selectstart",v),document.removeEventListener("selectionchange",w),ze.unbind()},setFilter:u,setUser:l}},of=(e,t)=>({...e,annotatingEnabled:e.annotatingEnabled??t.annotatingEnabled,user:e.user||t.user}),ka="SPANS",af=(e,t={})=>{bc(e),xc(e);const n=of(t,{annotatingEnabled:!0,user:ju()}),r=Vu(e,n.userSelectAction),{selection:o,viewport:i}=r,s=r.store,l=Au(s),c=Ou(r,l,n.adapter);let u=n.user;const d=n.renderer==="CSS_HIGHLIGHTS"?CSS.highlights?"CSS_HIGHLIGHTS":ka:n.renderer||ka,f=d==="SPANS"?Qc(e,r,i):d==="CSS_HIGHLIGHTS"?Gc(e,r,i):d==="CANVAS"?Bc(e,r,i):void 0;if(!f)throw`Unknown renderer implementation: ${d}`;console.debug(`Using ${d} renderer`),n.style&&f.setStyle(n.style);const p=rf(e,r,n);return p.setUser(u),{...Tu(r,l,n.adapter),destroy:()=>{f.destroy(),p.destroy(),l.destroy()},element:e,getUser:()=>u,setFilter:h=>{f.setFilter(h),p.setFilter(h)},setStyle:h=>f.setStyle(h),setUser:h=>{u=h,p.setUser(h)},setSelected:h=>{h?o.setSelected(h):o.clear()},setPresenceProvider:h=>{h&&(f.setPainter(Hu(h,n.presence)),h.on("selectionChange",()=>f.redraw()))},setVisible:h=>f.setVisible(h),on:c.on,off:c.off,scrollIntoView:jc(e,s),state:r}},sf=e=>{const{children:t,...n}=e,{anno:r,setAnno:o}=W.useContext(dr),i=W.useCallback(s=>{const l=vc(af(s,n));o(l)},[]);return W.useEffect(()=>{r&&r.setStyle(e.style)},[e.style]),W.useEffect(()=>{r&&r.setFilter(e.filter)},[e.filter]),e.children?pt.jsx(pt.Fragment,{children:W.Children.toArray(e.children).map(s=>W.cloneElement(s,{onLoad:i}))}):null},$a=()=>{var e=navigator.userAgent||navigator.vendor||window.opera;return!!(/android/i.test(e)||/iPad|iPhone/.test(e)&&!window.MSStream)};function Pr(){return typeof window<"u"}function Ct(e){return _a(e)?(e.nodeName||"").toLowerCase():"#document"}function Ve(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function st(e){var t;return(t=(_a(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function _a(e){return Pr()?e instanceof Node||e instanceof Ve(e).Node:!1}function xe(e){return Pr()?e instanceof Element||e instanceof Ve(e).Element:!1}function De(e){return Pr()?e instanceof HTMLElement||e instanceof Ve(e).HTMLElement:!1}function Do(e){return!Pr()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ve(e).ShadowRoot}function Fn(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=Ye(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function lf(e){return["table","td","th"].includes(Ct(e))}function jr(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Mo(e){const t=Nr(),n=xe(e)?Ye(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function cf(e){let t=bt(e);for(;De(t)&&!yt(t);){if(Mo(t))return t;if(jr(t))return null;t=bt(t)}return null}function Nr(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function yt(e){return["html","body","#document"].includes(Ct(e))}function Ye(e){return Ve(e).getComputedStyle(e)}function Lr(e){return xe(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function bt(e){if(Ct(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Do(e)&&e.host||st(e);return Do(t)?t.host:t}function Pa(e){const t=bt(e);return yt(t)?e.ownerDocument?e.ownerDocument.body:e.body:De(t)&&Fn(t)?t:Pa(t)}function kt(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=Pa(e),i=o===((r=e.ownerDocument)==null?void 0:r.body),s=Ve(o);if(i){const l=Fo(s);return t.concat(s,s.visualViewport||[],Fn(o)?o:[],l&&n?kt(l):[])}return t.concat(o,kt(o,[],n))}function Fo(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Kt(e){let t=e.activeElement;for(;((n=t)==null||(n=n.shadowRoot)==null?void 0:n.activeElement)!=null;){var n;t=t.shadowRoot.activeElement}return t}function He(e,t){if(!e||!t)return!1;const n=t.getRootNode==null?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&Do(n)){let r=t;for(;r;){if(e===r)return!0;r=r.parentNode||r.host}}return!1}function uf(){const e=navigator.userAgentData;return e!=null&&e.platform?e.platform:navigator.platform}function ja(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(t=>{let{brand:n,version:r}=t;return n+"/"+r}).join(" "):navigator.userAgent}function ff(e){return e.mozInputSource===0&&e.isTrusted?!0:Bo()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function df(e){return hf()?!1:!Bo()&&e.width===0&&e.height===0||Bo()&&e.width===1&&e.height===1&&e.pressure===0&&e.detail===0&&e.pointerType==="mouse"||e.width<1&&e.height<1&&e.pressure===0&&e.detail===0&&e.pointerType==="touch"}function pf(){return/apple/i.test(navigator.vendor)}function Bo(){const e=/android/i;return e.test(uf())||e.test(ja())}function hf(){return ja().includes("jsdom/")}function gf(e){return"nativeEvent"in e}function mf(e){return e.matches("html,body")}function Ze(e){return(e==null?void 0:e.ownerDocument)||document}function Uo(e,t){if(t==null)return!1;if("composedPath"in e)return e.composedPath().includes(t);const n=e;return n.target!=null&&t.contains(n.target)}function Xt(e){return"composedPath"in e?e.composedPath()[0]:e.target}const vf="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function yf(e){return De(e)&&e.matches(vf)}function Vo(e){e.preventDefault(),e.stopPropagation()}function bf(e){return e?e.getAttribute("role")==="combobox"&&yf(e):!1}/*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var wf=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],Ir=wf.join(","),Na=typeof Element>"u",sn=Na?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Dr=!Na&&Element.prototype.getRootNode?function(e){var t;return e==null||(t=e.getRootNode)===null||t===void 0?void 0:t.call(e)}:function(e){return e==null?void 0:e.ownerDocument},Mr=function e(t,n){var r;n===void 0&&(n=!0);var o=t==null||(r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"inert"),i=o===""||o==="true",s=i||n&&t&&e(t.parentNode);return s},xf=function(t){var n,r=t==null||(n=t.getAttribute)===null||n===void 0?void 0:n.call(t,"contenteditable");return r===""||r==="true"},Ef=function(t,n,r){if(Mr(t))return[];var o=Array.prototype.slice.apply(t.querySelectorAll(Ir));return n&&sn.call(t,Ir)&&o.unshift(t),o=o.filter(r),o},Af=function e(t,n,r){for(var o=[],i=Array.from(t);i.length;){var s=i.shift();if(!Mr(s,!1))if(s.tagName==="SLOT"){var l=s.assignedElements(),c=l.length?l:s.children,u=e(c,!0,r);r.flatten?o.push.apply(o,u):o.push({scopeParent:s,candidates:u})}else{var d=sn.call(s,Ir);d&&r.filter(s)&&(n||!t.includes(s))&&o.push(s);var f=s.shadowRoot||typeof r.getShadowRoot=="function"&&r.getShadowRoot(s),p=!Mr(f,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(s));if(f&&p){var h=e(f===!0?s.children:f.children,!0,r);r.flatten?o.push.apply(o,h):o.push({scopeParent:s,candidates:h})}else i.unshift.apply(i,s.children)}}return o},La=function(t){return!isNaN(parseInt(t.getAttribute("tabindex"),10))},Ia=function(t){if(!t)throw new Error("No node provided");return t.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(t.tagName)||xf(t))&&!La(t)?0:t.tabIndex},Sf=function(t,n){var r=Ia(t);return r<0&&n&&!La(t)?0:r},Of=function(t,n){return t.tabIndex===n.tabIndex?t.documentOrder-n.documentOrder:t.tabIndex-n.tabIndex},Da=function(t){return t.tagName==="INPUT"},Rf=function(t){return Da(t)&&t.type==="hidden"},Tf=function(t){var n=t.tagName==="DETAILS"&&Array.prototype.slice.apply(t.children).some(function(r){return r.tagName==="SUMMARY"});return n},Cf=function(t,n){for(var r=0;r<t.length;r++)if(t[r].checked&&t[r].form===n)return t[r]},kf=function(t){if(!t.name)return!0;var n=t.form||Dr(t),r=function(l){return n.querySelectorAll('input[type="radio"][name="'+l+'"]')},o;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")o=r(window.CSS.escape(t.name));else try{o=r(t.name)}catch(s){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",s.message),!1}var i=Cf(o,t.form);return!i||i===t},$f=function(t){return Da(t)&&t.type==="radio"},_f=function(t){return $f(t)&&!kf(t)},Pf=function(t){var n,r=t&&Dr(t),o=(n=r)===null||n===void 0?void 0:n.host,i=!1;if(r&&r!==t){var s,l,c;for(i=!!((s=o)!==null&&s!==void 0&&(l=s.ownerDocument)!==null&&l!==void 0&&l.contains(o)||t!=null&&(c=t.ownerDocument)!==null&&c!==void 0&&c.contains(t));!i&&o;){var u,d,f;r=Dr(o),o=(u=r)===null||u===void 0?void 0:u.host,i=!!((d=o)!==null&&d!==void 0&&(f=d.ownerDocument)!==null&&f!==void 0&&f.contains(o))}}return i},Ma=function(t){var n=t.getBoundingClientRect(),r=n.width,o=n.height;return r===0&&o===0},jf=function(t,n){var r=n.displayCheck,o=n.getShadowRoot;if(getComputedStyle(t).visibility==="hidden")return!0;var i=sn.call(t,"details>summary:first-of-type"),s=i?t.parentElement:t;if(sn.call(s,"details:not([open]) *"))return!0;if(!r||r==="full"||r==="legacy-full"){if(typeof o=="function"){for(var l=t;t;){var c=t.parentElement,u=Dr(t);if(c&&!c.shadowRoot&&o(c)===!0)return Ma(t);t.assignedSlot?t=t.assignedSlot:!c&&u!==t.ownerDocument?t=u.host:t=c}t=l}if(Pf(t))return!t.getClientRects().length;if(r!=="legacy-full")return!0}else if(r==="non-zero-area")return Ma(t);return!1},Nf=function(t){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(t.tagName))for(var n=t.parentElement;n;){if(n.tagName==="FIELDSET"&&n.disabled){for(var r=0;r<n.children.length;r++){var o=n.children.item(r);if(o.tagName==="LEGEND")return sn.call(n,"fieldset[disabled] *")?!0:!o.contains(t)}return!0}n=n.parentElement}return!1},Lf=function(t,n){return!(n.disabled||Mr(n)||Rf(n)||jf(n,t)||Tf(n)||Nf(n))},Yo=function(t,n){return!(_f(n)||Ia(n)<0||!Lf(t,n))},If=function(t){var n=parseInt(t.getAttribute("tabindex"),10);return!!(isNaN(n)||n>=0)},Df=function e(t){var n=[],r=[];return t.forEach(function(o,i){var s=!!o.scopeParent,l=s?o.scopeParent:o,c=Sf(l,s),u=s?e(o.candidates):l;c===0?s?n.push.apply(n,u):n.push(l):r.push({documentOrder:i,tabIndex:c,item:o,isScope:s,content:u})}),r.sort(Of).reduce(function(o,i){return i.isScope?o.push.apply(o,i.content):o.push(i.content),o},[]).concat(n)},Fr=function(t,n){n=n||{};var r;return n.getShadowRoot?r=Af([t],n.includeContainer,{filter:Yo.bind(null,n),flatten:!1,getShadowRoot:n.getShadowRoot,shadowRootFilter:If}):r=Ef(t,n.includeContainer,Yo.bind(null,n)),Df(r)},Mf=function(t,n){if(n=n||{},!t)throw new Error("No node provided");return sn.call(t,Ir)===!1?!1:Yo(n,t)};const wt=Math.min,lt=Math.max,Br=Math.round,Ur=Math.floor,ct=e=>({x:e,y:e}),Ff={left:"right",right:"left",bottom:"top",top:"bottom"},Bf={start:"end",end:"start"};function Ho(e,t,n){return lt(e,wt(t,n))}function ln(e,t){return typeof e=="function"?e(t):e}function xt(e){return e.split("-")[0]}function Bn(e){return e.split("-")[1]}function Fa(e){return e==="x"?"y":"x"}function Wo(e){return e==="y"?"height":"width"}function zt(e){return["top","bottom"].includes(xt(e))?"y":"x"}function Ko(e){return Fa(zt(e))}function Uf(e,t,n){n===void 0&&(n=!1);const r=Bn(e),o=Ko(e),i=Wo(o);let s=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(s=Vr(s)),[s,Vr(s)]}function Vf(e){const t=Vr(e);return[Xo(e),t,Xo(t)]}function Xo(e){return e.replace(/start|end/g,t=>Bf[t])}function Yf(e,t,n){const r=["left","right"],o=["right","left"],i=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return n?t?o:r:t?r:o;case"left":case"right":return t?i:s;default:return[]}}function Hf(e,t,n,r){const o=Bn(e);let i=Yf(xt(e),n==="start",r);return o&&(i=i.map(s=>s+"-"+o),t&&(i=i.concat(i.map(Xo)))),i}function Vr(e){return e.replace(/left|right|bottom|top/g,t=>Ff[t])}function Wf(e){return{top:0,right:0,bottom:0,left:0,...e}}function zo(e){return typeof e!="number"?Wf(e):{top:e,right:e,bottom:e,left:e}}function cn(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function Ba(e,t,n){let{reference:r,floating:o}=e;const i=zt(t),s=Ko(t),l=Wo(s),c=xt(t),u=i==="y",d=r.x+r.width/2-o.width/2,f=r.y+r.height/2-o.height/2,p=r[l]/2-o[l]/2;let h;switch(c){case"top":h={x:d,y:r.y-o.height};break;case"bottom":h={x:d,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:f};break;case"left":h={x:r.x-o.width,y:f};break;default:h={x:r.x,y:r.y}}switch(Bn(t)){case"start":h[s]-=p*(n&&u?-1:1);break;case"end":h[s]+=p*(n&&u?-1:1);break}return h}const Kf=async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:s}=n,l=i.filter(Boolean),c=await(s.isRTL==null?void 0:s.isRTL(t));let u=await s.getElementRects({reference:e,floating:t,strategy:o}),{x:d,y:f}=Ba(u,r,c),p=r,h={},m=0;for(let v=0;v<l.length;v++){const{name:w,fn:b}=l[v],{x:g,y:x,data:S,reset:A}=await b({x:d,y:f,initialPlacement:r,placement:p,strategy:o,middlewareData:h,rects:u,platform:s,elements:{reference:e,floating:t}});d=g??d,f=x??f,h={...h,[w]:{...h[w],...S}},A&&m<=50&&(m++,typeof A=="object"&&(A.placement&&(p=A.placement),A.rects&&(u=A.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:o}):A.rects),{x:d,y:f}=Ba(u,p,c)),v=-1)}return{x:d,y:f,placement:p,strategy:o,middlewareData:h}};async function Ua(e,t){var n;t===void 0&&(t={});const{x:r,y:o,platform:i,rects:s,elements:l,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:f="floating",altBoundary:p=!1,padding:h=0}=ln(t,e),m=zo(h),w=l[p?f==="floating"?"reference":"floating":f],b=cn(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(w)))==null||n?w:w.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),g=f==="floating"?{x:r,y:o,width:s.floating.width,height:s.floating.height}:s.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),S=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},A=cn(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:g,offsetParent:x,strategy:c}):g);return{top:(b.top-A.top+m.top)/S.y,bottom:(A.bottom-b.bottom+m.bottom)/S.y,left:(b.left-A.left+m.left)/S.x,right:(A.right-b.right+m.right)/S.x}}const Xf=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:i,platform:s,elements:l,middlewareData:c}=t,{element:u,padding:d=0}=ln(e,t)||{};if(u==null)return{};const f=zo(d),p={x:n,y:r},h=Ko(o),m=Wo(h),v=await s.getDimensions(u),w=h==="y",b=w?"top":"left",g=w?"bottom":"right",x=w?"clientHeight":"clientWidth",S=i.reference[m]+i.reference[h]-p[h]-i.floating[m],A=p[h]-i.reference[h],P=await(s.getOffsetParent==null?void 0:s.getOffsetParent(u));let _=P?P[x]:0;(!_||!await(s.isElement==null?void 0:s.isElement(P)))&&(_=l.floating[x]||i.floating[m]);const C=S/2-A/2,M=_/2-v[m]/2-1,R=wt(f[b],M),O=wt(f[g],M),$=R,T=_-v[m]-O,j=_/2-v[m]/2+C,L=Ho($,j,T),Y=!c.arrow&&Bn(o)!=null&&j!==L&&i.reference[m]/2-(j<$?R:O)-v[m]/2<0,q=Y?j<$?j-$:j-T:0;return{[h]:p[h]+q,data:{[h]:L,centerOffset:j-L-q,...Y&&{alignmentOffset:q}},reset:Y}}}),zf=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:i,rects:s,initialPlacement:l,platform:c,elements:u}=t,{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:v=!0,...w}=ln(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const b=xt(o),g=zt(l),x=xt(l)===l,S=await(c.isRTL==null?void 0:c.isRTL(u.floating)),A=p||(x||!v?[Vr(l)]:Vf(l)),P=m!=="none";!p&&P&&A.push(...Hf(l,v,m,S));const _=[l,...A],C=await Ua(t,w),M=[];let R=((r=i.flip)==null?void 0:r.overflows)||[];if(d&&M.push(C[b]),f){const j=Uf(o,s,S);M.push(C[j[0]],C[j[1]])}if(R=[...R,{placement:o,overflows:M}],!M.every(j=>j<=0)){var O,$;const j=(((O=i.flip)==null?void 0:O.index)||0)+1,L=_[j];if(L)return{data:{index:j,overflows:R},reset:{placement:L}};let Y=($=R.filter(q=>q.overflows[0]<=0).sort((q,X)=>q.overflows[1]-X.overflows[1])[0])==null?void 0:$.placement;if(!Y)switch(h){case"bestFit":{var T;const q=(T=R.filter(X=>{if(P){const K=zt(X.placement);return K===g||K==="y"}return!0}).map(X=>[X.placement,X.overflows.filter(K=>K>0).reduce((K,ne)=>K+ne,0)]).sort((X,K)=>X[1]-K[1])[0])==null?void 0:T[0];q&&(Y=q);break}case"initialPlacement":Y=l;break}if(o!==Y)return{reset:{placement:Y}}}return{}}}};function Va(e){const t=wt(...e.map(i=>i.left)),n=wt(...e.map(i=>i.top)),r=lt(...e.map(i=>i.right)),o=lt(...e.map(i=>i.bottom));return{x:t,y:n,width:r-t,height:o-n}}function qf(e){const t=e.slice().sort((o,i)=>o.y-i.y),n=[];let r=null;for(let o=0;o<t.length;o++){const i=t[o];!r||i.y-r.y>r.height/2?n.push([i]):n[n.length-1].push(i),r=i}return n.map(o=>cn(Va(o)))}const Gf=function(e){return e===void 0&&(e={}),{name:"inline",options:e,async fn(t){const{placement:n,elements:r,rects:o,platform:i,strategy:s}=t,{padding:l=2,x:c,y:u}=ln(e,t),d=Array.from(await(i.getClientRects==null?void 0:i.getClientRects(r.reference))||[]),f=qf(d),p=cn(Va(d)),h=zo(l);function m(){if(f.length===2&&f[0].left>f[1].right&&c!=null&&u!=null)return f.find(w=>c>w.left-h.left&&c<w.right+h.right&&u>w.top-h.top&&u<w.bottom+h.bottom)||p;if(f.length>=2){if(zt(n)==="y"){const R=f[0],O=f[f.length-1],$=xt(n)==="top",T=R.top,j=O.bottom,L=$?R.left:O.left,Y=$?R.right:O.right,q=Y-L,X=j-T;return{top:T,bottom:j,left:L,right:Y,width:q,height:X,x:L,y:T}}const w=xt(n)==="left",b=lt(...f.map(R=>R.right)),g=wt(...f.map(R=>R.left)),x=f.filter(R=>w?R.left===g:R.right===b),S=x[0].top,A=x[x.length-1].bottom,P=g,_=b,C=_-P,M=A-S;return{top:S,bottom:A,left:P,right:_,width:C,height:M,x:P,y:S}}return p}const v=await i.getElementRects({reference:{getBoundingClientRect:m},floating:r.floating,strategy:s});return o.reference.x!==v.reference.x||o.reference.y!==v.reference.y||o.reference.width!==v.reference.width||o.reference.height!==v.reference.height?{reset:{rects:v}}:{}}}};async function Jf(e,t){const{placement:n,platform:r,elements:o}=e,i=await(r.isRTL==null?void 0:r.isRTL(o.floating)),s=xt(n),l=Bn(n),c=zt(n)==="y",u=["left","top"].includes(s)?-1:1,d=i&&c?-1:1,f=ln(t,e);let{mainAxis:p,crossAxis:h,alignmentAxis:m}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof m=="number"&&(h=l==="end"?m*-1:m),c?{x:h*d,y:p*u}:{x:p*u,y:h*d}}const Zf=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:i,placement:s,middlewareData:l}=t,c=await Jf(t,e);return s===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:o+c.x,y:i+c.y,data:{...c,placement:s}}}}},Qf=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:i=!0,crossAxis:s=!1,limiter:l={fn:w=>{let{x:b,y:g}=w;return{x:b,y:g}}},...c}=ln(e,t),u={x:n,y:r},d=await Ua(t,c),f=zt(xt(o)),p=Fa(f);let h=u[p],m=u[f];if(i){const w=p==="y"?"top":"left",b=p==="y"?"bottom":"right",g=h+d[w],x=h-d[b];h=Ho(g,h,x)}if(s){const w=f==="y"?"top":"left",b=f==="y"?"bottom":"right",g=m+d[w],x=m-d[b];m=Ho(g,m,x)}const v=l.fn({...t,[p]:h,[f]:m});return{...v,data:{x:v.x-n,y:v.y-r,enabled:{[p]:i,[f]:s}}}}}};function Ya(e){const t=Ye(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=De(e),i=o?e.offsetWidth:n,s=o?e.offsetHeight:r,l=Br(n)!==i||Br(r)!==s;return l&&(n=i,r=s),{width:n,height:r,$:l}}function qo(e){return xe(e)?e:e.contextElement}function un(e){const t=qo(e);if(!De(t))return ct(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:i}=Ya(t);let s=(i?Br(n.width):n.width)/r,l=(i?Br(n.height):n.height)/o;return(!s||!Number.isFinite(s))&&(s=1),(!l||!Number.isFinite(l))&&(l=1),{x:s,y:l}}const ed=ct(0);function Ha(e){const t=Ve(e);return!Nr()||!t.visualViewport?ed:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function td(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Ve(e)?!1:t}function qt(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),i=qo(e);let s=ct(1);t&&(r?xe(r)&&(s=un(r)):s=un(e));const l=td(i,n,r)?Ha(i):ct(0);let c=(o.left+l.x)/s.x,u=(o.top+l.y)/s.y,d=o.width/s.x,f=o.height/s.y;if(i){const p=Ve(i),h=r&&xe(r)?Ve(r):r;let m=p,v=Fo(m);for(;v&&r&&h!==m;){const w=un(v),b=v.getBoundingClientRect(),g=Ye(v),x=b.left+(v.clientLeft+parseFloat(g.paddingLeft))*w.x,S=b.top+(v.clientTop+parseFloat(g.paddingTop))*w.y;c*=w.x,u*=w.y,d*=w.x,f*=w.y,c+=x,u+=S,m=Ve(v),v=Fo(m)}}return cn({width:d,height:f,x:c,y:u})}function Go(e,t){const n=Lr(e).scrollLeft;return t?t.left+n:qt(st(e)).left+n}function Wa(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),o=r.left+t.scrollLeft-(n?0:Go(e,r)),i=r.top+t.scrollTop;return{x:o,y:i}}function nd(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const i=o==="fixed",s=st(r),l=t?jr(t.floating):!1;if(r===s||l&&i)return n;let c={scrollLeft:0,scrollTop:0},u=ct(1);const d=ct(0),f=De(r);if((f||!f&&!i)&&((Ct(r)!=="body"||Fn(s))&&(c=Lr(r)),De(r))){const h=qt(r);u=un(r),d.x=h.x+r.clientLeft,d.y=h.y+r.clientTop}const p=s&&!f&&!i?Wa(s,c,!0):ct(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-c.scrollLeft*u.x+d.x+p.x,y:n.y*u.y-c.scrollTop*u.y+d.y+p.y}}function rd(e){return Array.from(e.getClientRects())}function od(e){const t=st(e),n=Lr(e),r=e.ownerDocument.body,o=lt(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=lt(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+Go(e);const l=-n.scrollTop;return Ye(r).direction==="rtl"&&(s+=lt(t.clientWidth,r.clientWidth)-o),{width:o,height:i,x:s,y:l}}function id(e,t){const n=Ve(e),r=st(e),o=n.visualViewport;let i=r.clientWidth,s=r.clientHeight,l=0,c=0;if(o){i=o.width,s=o.height;const u=Nr();(!u||u&&t==="fixed")&&(l=o.offsetLeft,c=o.offsetTop)}return{width:i,height:s,x:l,y:c}}function ad(e,t){const n=qt(e,!0,t==="fixed"),r=n.top+e.clientTop,o=n.left+e.clientLeft,i=De(e)?un(e):ct(1),s=e.clientWidth*i.x,l=e.clientHeight*i.y,c=o*i.x,u=r*i.y;return{width:s,height:l,x:c,y:u}}function Ka(e,t,n){let r;if(t==="viewport")r=id(e,n);else if(t==="document")r=od(st(e));else if(xe(t))r=ad(t,n);else{const o=Ha(e);r={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return cn(r)}function Xa(e,t){const n=bt(e);return n===t||!xe(n)||yt(n)?!1:Ye(n).position==="fixed"||Xa(n,t)}function sd(e,t){const n=t.get(e);if(n)return n;let r=kt(e,[],!1).filter(l=>xe(l)&&Ct(l)!=="body"),o=null;const i=Ye(e).position==="fixed";let s=i?bt(e):e;for(;xe(s)&&!yt(s);){const l=Ye(s),c=Mo(s);!c&&l.position==="fixed"&&(o=null),(i?!c&&!o:!c&&l.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||Fn(s)&&!c&&Xa(e,s))?r=r.filter(d=>d!==s):o=l,s=bt(s)}return t.set(e,r),r}function ld(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const s=[...n==="clippingAncestors"?jr(t)?[]:sd(t,this._c):[].concat(n),r],l=s[0],c=s.reduce((u,d)=>{const f=Ka(t,d,o);return u.top=lt(f.top,u.top),u.right=wt(f.right,u.right),u.bottom=wt(f.bottom,u.bottom),u.left=lt(f.left,u.left),u},Ka(t,l,o));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function cd(e){const{width:t,height:n}=Ya(e);return{width:t,height:n}}function ud(e,t,n){const r=De(t),o=st(t),i=n==="fixed",s=qt(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=ct(0);if(r||!r&&!i)if((Ct(t)!=="body"||Fn(o))&&(l=Lr(t)),r){const p=qt(t,!0,i,t);c.x=p.x+t.clientLeft,c.y=p.y+t.clientTop}else o&&(c.x=Go(o));const u=o&&!r&&!i?Wa(o,l):ct(0),d=s.left+l.scrollLeft-c.x-u.x,f=s.top+l.scrollTop-c.y-u.y;return{x:d,y:f,width:s.width,height:s.height}}function Jo(e){return Ye(e).position==="static"}function za(e,t){if(!De(e)||Ye(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return st(e)===n&&(n=n.ownerDocument.body),n}function qa(e,t){const n=Ve(e);if(jr(e))return n;if(!De(e)){let o=bt(e);for(;o&&!yt(o);){if(xe(o)&&!Jo(o))return o;o=bt(o)}return n}let r=za(e,t);for(;r&&lf(r)&&Jo(r);)r=za(r,t);return r&&yt(r)&&Jo(r)&&!Mo(r)?n:r||cf(e)||n}const fd=async function(e){const t=this.getOffsetParent||qa,n=this.getDimensions,r=await n(e.floating);return{reference:ud(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function dd(e){return Ye(e).direction==="rtl"}const pd={convertOffsetParentRelativeRectToViewportRelativeRect:nd,getDocumentElement:st,getClippingRect:ld,getOffsetParent:qa,getElementRects:fd,getClientRects:rd,getDimensions:cd,getScale:un,isElement:xe,isRTL:dd};function hd(e,t){let n=null,r;const o=st(e);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function s(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const{left:u,top:d,width:f,height:p}=e.getBoundingClientRect();if(l||t(),!f||!p)return;const h=Ur(d),m=Ur(o.clientWidth-(u+f)),v=Ur(o.clientHeight-(d+p)),w=Ur(u),g={rootMargin:-h+"px "+-m+"px "+-v+"px "+-w+"px",threshold:lt(0,wt(1,c))||1};let x=!0;function S(A){const P=A[0].intersectionRatio;if(P!==c){if(!x)return s();P?s(!1,P):r=setTimeout(()=>{s(!1,1e-7)},1e3)}x=!1}try{n=new IntersectionObserver(S,{...g,root:o.ownerDocument})}catch{n=new IntersectionObserver(S,g)}n.observe(e)}return s(!0),i}function gd(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=qo(e),d=o||i?[...u?kt(u):[],...kt(t)]:[];d.forEach(b=>{o&&b.addEventListener("scroll",n,{passive:!0}),i&&b.addEventListener("resize",n)});const f=u&&l?hd(u,n):null;let p=-1,h=null;s&&(h=new ResizeObserver(b=>{let[g]=b;g&&g.target===u&&h&&(h.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var x;(x=h)==null||x.observe(t)})),n()}),u&&!c&&h.observe(u),h.observe(t));let m,v=c?qt(e):null;c&&w();function w(){const b=qt(e);v&&(b.x!==v.x||b.y!==v.y||b.width!==v.width||b.height!==v.height)&&n(),v=b,m=requestAnimationFrame(w)}return n(),()=>{var b;d.forEach(g=>{o&&g.removeEventListener("scroll",n),i&&g.removeEventListener("resize",n)}),f==null||f(),(b=h)==null||b.disconnect(),h=null,c&&cancelAnimationFrame(m)}}const md=Zf,vd=Qf,yd=zf,Ga=Xf,bd=Gf,wd=(e,t,n)=>{const r=new Map,o={platform:pd,...n},i={...o.platform,_c:r};return Kf(e,t,{...o,platform:i})};var Yr=typeof document<"u"?W.useLayoutEffect:W.useEffect;function Hr(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Hr(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;r--!==0;){const i=o[r];if(!(i==="_owner"&&e.$$typeof)&&!Hr(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function Ja(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Za(e,t){const n=Ja(e);return Math.round(t*n)/n}function Zo(e){const t=D.useRef(e);return Yr(()=>{t.current=e}),t}function xd(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:i,floating:s}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,f]=D.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,h]=D.useState(r);Hr(p,r)||h(r);const[m,v]=D.useState(null),[w,b]=D.useState(null),g=D.useCallback(X=>{X!==P.current&&(P.current=X,v(X))},[]),x=D.useCallback(X=>{X!==_.current&&(_.current=X,b(X))},[]),S=i||m,A=s||w,P=D.useRef(null),_=D.useRef(null),C=D.useRef(d),M=c!=null,R=Zo(c),O=Zo(o),$=Zo(u),T=D.useCallback(()=>{if(!P.current||!_.current)return;const X={placement:t,strategy:n,middleware:p};O.current&&(X.platform=O.current),wd(P.current,_.current,X).then(K=>{const ne={...K,isPositioned:$.current!==!1};j.current&&!Hr(C.current,ne)&&(C.current=ne,li.flushSync(()=>{f(ne)}))})},[p,t,n,O,$]);Yr(()=>{u===!1&&C.current.isPositioned&&(C.current.isPositioned=!1,f(X=>({...X,isPositioned:!1})))},[u]);const j=D.useRef(!1);Yr(()=>(j.current=!0,()=>{j.current=!1}),[]),Yr(()=>{if(S&&(P.current=S),A&&(_.current=A),S&&A){if(R.current)return R.current(S,A,T);T()}},[S,A,T,R,M]);const L=D.useMemo(()=>({reference:P,floating:_,setReference:g,setFloating:x}),[g,x]),Y=D.useMemo(()=>({reference:S,floating:A}),[S,A]),q=D.useMemo(()=>{const X={position:n,left:0,top:0};if(!Y.floating)return X;const K=Za(Y.floating,d.x),ne=Za(Y.floating,d.y);return l?{...X,transform:"translate("+K+"px, "+ne+"px)",...Ja(Y.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:K,top:ne}},[n,l,Y.floating,d.x,d.y]);return D.useMemo(()=>({...d,update:T,refs:L,elements:Y,floatingStyles:q}),[d,T,L,Y,q])}const Ed=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:o}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Ga({element:r.current,padding:o}).fn(n):{}:r?Ga({element:r,padding:o}).fn(n):{}}}},Ad=(e,t)=>({...md(e),options:[e,t]}),Sd=(e,t)=>({...vd(e),options:[e,t]}),Od=(e,t)=>({...yd(e),options:[e,t]}),Rd=(e,t)=>({...bd(e),options:[e,t]}),Td=(e,t)=>({...Ed(e),options:[e,t]});function Qa(e){return D.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})},e)}const es={...D},Cd=es.useInsertionEffect||(e=>e());function $t(e){const t=D.useRef(()=>{if(process.env.NODE_ENV!=="production")throw new Error("Cannot call an event handler while rendering.")});return Cd(()=>{t.current=e}),D.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}var We=typeof document<"u"?W.useLayoutEffect:W.useEffect;function Un(){return Un=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Un.apply(this,arguments)}let ts=!1,kd=0;const ns=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+kd++;function $d(){const[e,t]=D.useState(()=>ts?ns():void 0);return We(()=>{e==null&&t(ns())},[]),D.useEffect(()=>{ts=!0},[]),e}const Wr=es.useId||$d;let Vn;process.env.NODE_ENV!=="production"&&(Vn=new Set);function _d(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const o="Floating UI: "+n.join(" ");if(!((e=Vn)!=null&&e.has(o))){var i;(i=Vn)==null||i.add(o),console.warn(o)}}function Pd(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const o="Floating UI: "+n.join(" ");if(!((e=Vn)!=null&&e.has(o))){var i;(i=Vn)==null||i.add(o),console.error(o)}}const jd=D.forwardRef(function(t,n){const{context:{placement:r,elements:{floating:o},middlewareData:{arrow:i,shift:s}},width:l=14,height:c=7,tipRadius:u=0,strokeWidth:d=0,staticOffset:f,stroke:p,d:h,style:{transform:m,...v}={},...w}=t;process.env.NODE_ENV!=="production"&&(n||_d("The `ref` prop is required for `FloatingArrow`."));const b=Wr(),[g,x]=D.useState(!1);if(We(()=>{if(!o)return;Ye(o).direction==="rtl"&&x(!0)},[o]),!o)return null;const[S,A]=r.split("-"),P=S==="top"||S==="bottom";let _=f;(P&&s!=null&&s.x||!P&&s!=null&&s.y)&&(_=null);const C=d*2,M=C/2,R=l/2*(u/-8+1),O=c/2*u/4,$=!!h,T=_&&A==="end"?"bottom":"top";let j=_&&A==="end"?"right":"left";_&&g&&(j=A==="end"?"left":"right");const L=(i==null?void 0:i.x)!=null?_||i.x:"",Y=(i==null?void 0:i.y)!=null?_||i.y:"",q=h||"M0,0"+(" H"+l)+(" L"+(l-R)+","+(c-O))+(" Q"+l/2+","+c+" "+R+","+(c-O))+" Z",X={top:$?"rotate(180deg)":"",left:$?"rotate(90deg)":"rotate(-90deg)",bottom:$?"":"rotate(180deg)",right:$?"rotate(-90deg)":"rotate(90deg)"}[S];return D.createElement("svg",Un({},w,{"aria-hidden":!0,ref:n,width:$?l:l+C,height:l,viewBox:"0 0 "+l+" "+(c>l?c:l),style:{position:"absolute",pointerEvents:"none",[j]:L,[T]:Y,[S]:P||$?"100%":"calc(100% - "+C/2+"px)",transform:[X,m].filter(K=>!!K).join(" "),...v}}),C>0&&D.createElement("path",{clipPath:"url(#"+b+")",fill:"none",stroke:p,strokeWidth:C+(h?0:1),d:q}),D.createElement("path",{stroke:C&&!h?w.fill:"none",d:q}),D.createElement("clipPath",{id:b},D.createElement("rect",{x:-M,y:M*($?-1:1),width:l+C,height:l})))});function Nd(){const e=new Map;return{emit(t,n){var r;(r=e.get(t))==null||r.forEach(o=>o(n))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var r;e.set(t,((r=e.get(t))==null?void 0:r.filter(o=>o!==n))||[])}}}const Ld=D.createContext(null),Id=D.createContext(null),rs=()=>{var e;return((e=D.useContext(Ld))==null?void 0:e.id)||null},Qo=()=>D.useContext(Id);function Yn(e){return"data-floating-ui-"+e}function ei(e){const t=W.useRef(e);return We(()=>{t.current=e}),t}let os=0;function fn(e,t){t===void 0&&(t={});const{preventScroll:n=!1,cancelPrevious:r=!0,sync:o=!1}=t;r&&cancelAnimationFrame(os);const i=()=>e==null?void 0:e.focus({preventScroll:n});o?i():os=requestAnimationFrame(i)}function is(e,t){var n;let r=[],o=(n=e.find(i=>i.id===t))==null?void 0:n.parentId;for(;o;){const i=e.find(s=>s.id===o);o=i==null?void 0:i.parentId,i&&(r=r.concat(i))}return r}function Hn(e,t){let n=e.filter(o=>{var i;return o.parentId===t&&((i=o.context)==null?void 0:i.open)}),r=n;for(;r.length;)r=e.filter(o=>{var i;return(i=r)==null?void 0:i.some(s=>{var l;return o.parentId===s.id&&((l=o.context)==null?void 0:l.open)})}),n=n.concat(r);return n}let dn=new WeakMap,Kr=new WeakSet,Xr={},ti=0;const Dd=()=>typeof HTMLElement<"u"&&"inert"in HTMLElement.prototype,as=e=>e&&(e.host||as(e.parentNode)),Md=(e,t)=>t.map(n=>{if(e.contains(n))return n;const r=as(n);return e.contains(r)?r:null}).filter(n=>n!=null);function Fd(e,t,n,r){const o="data-floating-ui-inert",i=r?"inert":n?"aria-hidden":null,s=Md(t,e),l=new Set,c=new Set(s),u=[];Xr[o]||(Xr[o]=new WeakMap);const d=Xr[o];s.forEach(f),p(t),l.clear();function f(h){!h||l.has(h)||(l.add(h),h.parentNode&&f(h.parentNode))}function p(h){!h||c.has(h)||[].forEach.call(h.children,m=>{if(Ct(m)!=="script")if(l.has(m))p(m);else{const v=i?m.getAttribute(i):null,w=v!==null&&v!=="false",b=(dn.get(m)||0)+1,g=(d.get(m)||0)+1;dn.set(m,b),d.set(m,g),u.push(m),b===1&&w&&Kr.add(m),g===1&&m.setAttribute(o,""),!w&&i&&m.setAttribute(i,"true")}})}return ti++,()=>{u.forEach(h=>{const m=(dn.get(h)||0)-1,v=(d.get(h)||0)-1;dn.set(h,m),d.set(h,v),m||(!Kr.has(h)&&i&&h.removeAttribute(i),Kr.delete(h)),v||h.removeAttribute(o)}),ti--,ti||(dn=new WeakMap,dn=new WeakMap,Kr=new WeakSet,Xr={})}}function ss(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);const r=Ze(e[0]).body;return Fd(e.concat(Array.from(r.querySelectorAll("[aria-live]"))),r,t,n)}const zr=()=>({getShadowRoot:!0,displayCheck:typeof ResizeObserver=="function"&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function ls(e,t){const n=Fr(e,zr());t==="prev"&&n.reverse();const r=n.indexOf(Kt(Ze(e)));return n.slice(r+1)[0]}function cs(){return ls(document.body,"next")}function us(){return ls(document.body,"prev")}function Wn(e,t){const n=t||e.currentTarget,r=e.relatedTarget;return!r||!He(n,r)}function Bd(e){Fr(e,zr()).forEach(n=>{n.dataset.tabindex=n.getAttribute("tabindex")||"",n.setAttribute("tabindex","-1")})}function fs(e){e.querySelectorAll("[data-tabindex]").forEach(n=>{const r=n.dataset.tabindex;delete n.dataset.tabindex,r?n.setAttribute("tabindex",r):n.removeAttribute("tabindex")})}const qr={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};let Ud;function ds(e){e.key==="Tab"&&(e.target,clearTimeout(Ud))}const Gr=D.forwardRef(function(t,n){const[r,o]=D.useState();We(()=>(pf()&&o("button"),document.addEventListener("keydown",ds),()=>{document.removeEventListener("keydown",ds)}),[]);const i={ref:n,tabIndex:0,role:r,"aria-hidden":r?void 0:!0,[Yn("focus-guard")]:"",style:qr};return D.createElement("span",Un({},t,i))}),ps=D.createContext(null),hs=Yn("portal");function Vd(e){e===void 0&&(e={});const{id:t,root:n}=e,r=Wr(),o=gs(),[i,s]=D.useState(null),l=D.useRef(null);return We(()=>()=>{i==null||i.remove(),queueMicrotask(()=>{l.current=null})},[i]),We(()=>{if(!r||l.current)return;const c=t?document.getElementById(t):null;if(!c)return;const u=document.createElement("div");u.id=r,u.setAttribute(hs,""),c.appendChild(u),l.current=u,s(u)},[t,r]),We(()=>{if(n===null||!r||l.current)return;let c=n||(o==null?void 0:o.portalNode);c&&!xe(c)&&(c=c.current),c=c||document.body;let u=null;t&&(u=document.createElement("div"),u.id=t,c.appendChild(u));const d=document.createElement("div");d.id=r,d.setAttribute(hs,""),c=u||c,c.appendChild(d),l.current=d,s(d)},[t,n,r,o]),i}function Yd(e){const{children:t,id:n,root:r,preserveTabOrder:o=!0}=e,i=Vd({id:n,root:r}),[s,l]=D.useState(null),c=D.useRef(null),u=D.useRef(null),d=D.useRef(null),f=D.useRef(null),p=s==null?void 0:s.modal,h=s==null?void 0:s.open,m=!!s&&!s.modal&&s.open&&o&&!!(r||i);return D.useEffect(()=>{if(!i||!o||p)return;function v(w){i&&Wn(w)&&(w.type==="focusin"?fs:Bd)(i)}return i.addEventListener("focusin",v,!0),i.addEventListener("focusout",v,!0),()=>{i.removeEventListener("focusin",v,!0),i.removeEventListener("focusout",v,!0)}},[i,o,p]),D.useEffect(()=>{i&&(h||fs(i))},[h,i]),D.createElement(ps.Provider,{value:D.useMemo(()=>({preserveTabOrder:o,beforeOutsideRef:c,afterOutsideRef:u,beforeInsideRef:d,afterInsideRef:f,portalNode:i,setFocusManagerState:l}),[o,i])},m&&i&&D.createElement(Gr,{"data-type":"outside",ref:c,onFocus:v=>{if(Wn(v,i)){var w;(w=d.current)==null||w.focus()}else{const b=us()||(s==null?void 0:s.refs.domReference.current);b==null||b.focus()}}}),m&&i&&D.createElement("span",{"aria-owns":i.id,style:qr}),i&&li.createPortal(t,i),m&&i&&D.createElement(Gr,{"data-type":"outside",ref:u,onFocus:v=>{if(Wn(v,i)){var w;(w=f.current)==null||w.focus()}else{const b=cs()||(s==null?void 0:s.refs.domReference.current);b==null||b.focus(),s!=null&&s.closeOnFocusOut&&(s==null||s.onOpenChange(!1,v.nativeEvent,"focus-out"))}}}))}const gs=()=>D.useContext(ps),ni="data-floating-ui-focusable";function ms(e){return e?e.hasAttribute(ni)?e:e.querySelector("["+ni+"]")||e:null}const vs=20;let Gt=[];function ri(e){Gt=Gt.filter(t=>t.isConnected),e&&Ct(e)!=="body"&&(Gt.push(e),Gt.length>vs&&(Gt=Gt.slice(-vs)))}function ys(){return Gt.slice().reverse().find(e=>e.isConnected)}function Hd(e){const t=zr();return Mf(e,t)?e:Fr(e,t)[0]||e}const Wd=D.forwardRef(function(t,n){return D.createElement("button",Un({},t,{type:"button",ref:n,tabIndex:-1,style:qr}))});function Kd(e){const{context:t,children:n,disabled:r=!1,order:o=["content"],guards:i=!0,initialFocus:s=0,returnFocus:l=!0,restoreFocus:c=!1,modal:u=!0,visuallyHiddenDismiss:d=!1,closeOnFocusOut:f=!0,outsideElementsInert:p=!1}=e,{open:h,refs:m,nodeId:v,onOpenChange:w,events:b,dataRef:g,elements:{domReference:x,floating:S}}=t,A=typeof s=="number"&&s<0,P=bf(x)&&A,_=Dd(),C=_?i:!0,M=!C||_&&p,R=ei(o),O=ei(s),$=ei(l),T=Qo(),j=gs(),L=D.useRef(null),Y=D.useRef(null),q=D.useRef(!1),X=D.useRef(!1),K=D.useRef(-1),ne=j!=null,Z=ms(S),ue=$t(function(Q){return Q===void 0&&(Q=Z),Q?Fr(Q,zr()):[]}),Ae=$t(Q=>{const re=ue(Q);return R.current.map(ee=>x&&ee==="reference"?x:Z&&ee==="floating"?Z:re).filter(Boolean).flat()});D.useEffect(()=>{if(r||!u)return;function Q(ee){if(ee.key==="Tab"){He(Z,Kt(Ze(Z)))&&ue().length===0&&!P&&Vo(ee);const ie=Ae(),pe=Xt(ee);R.current[0]==="reference"&&pe===x&&(Vo(ee),ee.shiftKey?fn(ie[ie.length-1]):fn(ie[1])),R.current[1]==="floating"&&pe===Z&&ee.shiftKey&&(Vo(ee),fn(ie[0]))}}const re=Ze(Z);return re.addEventListener("keydown",Q),()=>{re.removeEventListener("keydown",Q)}},[r,x,Z,u,R,P,ue,Ae]),D.useEffect(()=>{if(r||!S)return;function Q(re){const ee=Xt(re),pe=ue().indexOf(ee);pe!==-1&&(K.current=pe)}return S.addEventListener("focusin",Q),()=>{S.removeEventListener("focusin",Q)}},[r,S,ue]),D.useEffect(()=>{if(r||!f)return;function Q(){X.current=!0,setTimeout(()=>{X.current=!1})}function re(ee){const ie=ee.relatedTarget;queueMicrotask(()=>{const pe=!(He(x,ie)||He(S,ie)||He(ie,S)||He(j==null?void 0:j.portalNode,ie)||ie!=null&&ie.hasAttribute(Yn("focus-guard"))||T&&(Hn(T.nodesRef.current,v).find(ce=>{var se,Te;return He((se=ce.context)==null?void 0:se.elements.floating,ie)||He((Te=ce.context)==null?void 0:Te.elements.domReference,ie)})||is(T.nodesRef.current,v).find(ce=>{var se,Te,_e;return[(se=ce.context)==null?void 0:se.elements.floating,ms((Te=ce.context)==null?void 0:Te.elements.floating)].includes(ie)||((_e=ce.context)==null?void 0:_e.elements.domReference)===ie})));if(c&&pe&&Kt(Ze(Z))===Ze(Z).body){De(Z)&&Z.focus();const ce=K.current,se=ue(),Te=se[ce]||se[se.length-1]||Z;De(Te)&&Te.focus()}(P||!u)&&ie&&pe&&!X.current&&ie!==ys()&&(q.current=!0,w(!1,ee,"focus-out"))})}if(S&&De(x))return x.addEventListener("focusout",re),x.addEventListener("pointerdown",Q),S.addEventListener("focusout",re),()=>{x.removeEventListener("focusout",re),x.removeEventListener("pointerdown",Q),S.removeEventListener("focusout",re)}},[r,x,S,Z,u,v,T,j,w,f,c,ue,P]);const Re=D.useRef(null),ae=D.useRef(null),fe=Qa([Re,j==null?void 0:j.beforeInsideRef]),he=Qa([ae,j==null?void 0:j.afterInsideRef]);D.useEffect(()=>{var Q;if(r||!S)return;const re=Array.from((j==null||(Q=j.portalNode)==null?void 0:Q.querySelectorAll("["+Yn("portal")+"]"))||[]),ee=T&&!u?is(T==null?void 0:T.nodesRef.current,v).map(ce=>{var se;return(se=ce.context)==null?void 0:se.elements.floating}):[],ie=[S,...re,...ee,L.current,Y.current,Re.current,ae.current,j==null?void 0:j.beforeOutsideRef.current,j==null?void 0:j.afterOutsideRef.current,R.current.includes("reference")||P?x:null].filter(ce=>ce!=null),pe=u||P?ss(ie,!M,M):ss(ie);return()=>{pe()}},[r,x,S,u,R,j,P,C,M,T,v]),We(()=>{if(r||!De(Z))return;const Q=Ze(Z),re=Kt(Q);queueMicrotask(()=>{const ee=Ae(Z),ie=O.current,pe=(typeof ie=="number"?ee[ie]:ie.current)||Z,ce=He(Z,re);!A&&!ce&&h&&fn(pe,{preventScroll:pe===Z})})},[r,h,Z,A,Ae,O]),We(()=>{if(r||!Z)return;let Q=!1;const re=Ze(Z),ee=Kt(re);let pe=g.current.openEvent;ri(ee);function ce(_e){let{open:Ce,reason:ut,event:qe,nested:ke}=_e;Ce&&(pe=qe),ut==="escape-key"&&m.domReference.current&&ri(m.domReference.current),["hover","safe-polygon"].includes(ut)&&qe.type==="mouseleave"&&(q.current=!0),ut==="outside-press"&&(ke?(q.current=!1,Q=!0):q.current=!(ff(qe)||df(qe)))}b.on("openchange",ce);const se=re.createElement("span");se.setAttribute("tabindex","-1"),se.setAttribute("aria-hidden","true"),Object.assign(se.style,qr),ne&&x&&x.insertAdjacentElement("afterend",se);function Te(){return typeof $.current=="boolean"?ys()||se:$.current.current||se}return()=>{b.off("openchange",ce);const _e=Kt(re),Ce=He(S,_e)||T&&Hn(T.nodesRef.current,v).some(ke=>{var _t;return He((_t=ke.context)==null?void 0:_t.elements.floating,_e)});(Ce||pe&&["click","mousedown"].includes(pe.type))&&m.domReference.current&&ri(m.domReference.current);const qe=Te();queueMicrotask(()=>{const ke=Hd(qe);$.current&&!q.current&&De(ke)&&(!(ke!==_e&&_e!==re.body)||Ce)&&ke.focus({preventScroll:Q}),se.remove()})}},[r,S,Z,$,g,m,b,T,v,ne,x]),D.useEffect(()=>{queueMicrotask(()=>{q.current=!1})},[r]),We(()=>{if(!r&&j)return j.setFocusManagerState({modal:u,closeOnFocusOut:f,open:h,onOpenChange:w,refs:m}),()=>{j.setFocusManagerState(null)}},[r,j,u,h,w,m,f]),We(()=>{if(r||!Z||typeof MutationObserver!="function"||A)return;const Q=()=>{const ee=Z.getAttribute("tabindex"),ie=ue(),pe=Kt(Ze(S)),ce=ie.indexOf(pe);ce!==-1&&(K.current=ce),R.current.includes("floating")||pe!==m.domReference.current&&ie.length===0?ee!=="0"&&Z.setAttribute("tabindex","0"):ee!=="-1"&&Z.setAttribute("tabindex","-1")};Q();const re=new MutationObserver(Q);return re.observe(Z,{childList:!0,subtree:!0,attributes:!0}),()=>{re.disconnect()}},[r,S,Z,m,R,ue,A]);function J(Q){return r||!d||!u?null:D.createElement(Wd,{ref:Q==="start"?L:Y,onClick:re=>w(!1,re.nativeEvent)},typeof d=="string"?d:"Dismiss")}const H=!r&&C&&(u?!P:!0)&&(ne||u);return D.createElement(D.Fragment,null,H&&D.createElement(Gr,{"data-type":"inside",ref:fe,onFocus:Q=>{if(u){const ee=Ae();fn(o[0]==="reference"?ee[0]:ee[ee.length-1])}else if(j!=null&&j.preserveTabOrder&&j.portalNode)if(q.current=!1,Wn(Q,j.portalNode)){const ee=cs()||x;ee==null||ee.focus()}else{var re;(re=j.beforeOutsideRef.current)==null||re.focus()}}}),!P&&J("start"),n,J("end"),H&&D.createElement(Gr,{"data-type":"inside",ref:he,onFocus:Q=>{if(u)fn(Ae()[0]);else if(j!=null&&j.preserveTabOrder&&j.portalNode)if(f&&(q.current=!0),Wn(Q,j.portalNode)){const ee=us()||x;ee==null||ee.focus()}else{var re;(re=j.afterOutsideRef.current)==null||re.focus()}}}))}const Xd={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},zd={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},bs=e=>{var t,n;return{escapeKey:typeof e=="boolean"?e:(t=e==null?void 0:e.escapeKey)!=null?t:!1,outsidePress:typeof e=="boolean"?e:(n=e==null?void 0:e.outsidePress)!=null?n:!0}};function qd(e,t){t===void 0&&(t={});const{open:n,onOpenChange:r,elements:o,dataRef:i}=e,{enabled:s=!0,escapeKey:l=!0,outsidePress:c=!0,outsidePressEvent:u="pointerdown",referencePress:d=!1,referencePressEvent:f="pointerdown",ancestorScroll:p=!1,bubbles:h,capture:m}=t,v=Qo(),w=$t(typeof c=="function"?c:()=>!1),b=typeof c=="function"?w:c,g=D.useRef(!1),x=D.useRef(!1),{escapeKey:S,outsidePress:A}=bs(h),{escapeKey:P,outsidePress:_}=bs(m),C=D.useRef(!1),M=$t(L=>{var Y;if(!n||!s||!l||L.key!=="Escape"||C.current)return;const q=(Y=i.current.floatingContext)==null?void 0:Y.nodeId,X=v?Hn(v.nodesRef.current,q):[];if(!S&&(L.stopPropagation(),X.length>0)){let K=!0;if(X.forEach(ne=>{var Z;if((Z=ne.context)!=null&&Z.open&&!ne.context.dataRef.current.__escapeKeyBubbles){K=!1;return}}),!K)return}r(!1,gf(L)?L.nativeEvent:L,"escape-key")}),R=$t(L=>{var Y;const q=()=>{var X;M(L),(X=Xt(L))==null||X.removeEventListener("keydown",q)};(Y=Xt(L))==null||Y.addEventListener("keydown",q)}),O=$t(L=>{var Y;const q=g.current;g.current=!1;const X=x.current;if(x.current=!1,u==="click"&&X||q||typeof b=="function"&&!b(L))return;const K=Xt(L),ne="["+Yn("inert")+"]",Z=Ze(o.floating).querySelectorAll(ne);let ue=xe(K)?K:null;for(;ue&&!yt(ue);){const fe=bt(ue);if(yt(fe)||!xe(fe))break;ue=fe}if(Z.length&&xe(K)&&!mf(K)&&!He(K,o.floating)&&Array.from(Z).every(fe=>!He(ue,fe)))return;if(De(K)&&j){const fe=yt(K),he=Ye(K),J=/auto|scroll/,H=fe||J.test(he.overflowX),Q=fe||J.test(he.overflowY),re=H&&K.clientWidth>0&&K.scrollWidth>K.clientWidth,ee=Q&&K.clientHeight>0&&K.scrollHeight>K.clientHeight,ie=he.direction==="rtl",pe=ee&&(ie?L.offsetX<=K.offsetWidth-K.clientWidth:L.offsetX>K.clientWidth),ce=re&&L.offsetY>K.clientHeight;if(pe||ce)return}const Ae=(Y=i.current.floatingContext)==null?void 0:Y.nodeId,Re=v&&Hn(v.nodesRef.current,Ae).some(fe=>{var he;return Uo(L,(he=fe.context)==null?void 0:he.elements.floating)});if(Uo(L,o.floating)||Uo(L,o.domReference)||Re)return;const ae=v?Hn(v.nodesRef.current,Ae):[];if(ae.length>0){let fe=!0;if(ae.forEach(he=>{var J;if((J=he.context)!=null&&J.open&&!he.context.dataRef.current.__outsidePressBubbles){fe=!1;return}}),!fe)return}r(!1,L,"outside-press")}),$=$t(L=>{var Y;const q=()=>{var X;O(L),(X=Xt(L))==null||X.removeEventListener(u,q)};(Y=Xt(L))==null||Y.addEventListener(u,q)});D.useEffect(()=>{if(!n||!s)return;i.current.__escapeKeyBubbles=S,i.current.__outsidePressBubbles=A;let L=-1;function Y(Z){r(!1,Z,"ancestor-scroll")}function q(){window.clearTimeout(L),C.current=!0}function X(){L=window.setTimeout(()=>{C.current=!1},Nr()?5:0)}const K=Ze(o.floating);l&&(K.addEventListener("keydown",P?R:M,P),K.addEventListener("compositionstart",q),K.addEventListener("compositionend",X)),b&&K.addEventListener(u,_?$:O,_);let ne=[];return p&&(xe(o.domReference)&&(ne=kt(o.domReference)),xe(o.floating)&&(ne=ne.concat(kt(o.floating))),!xe(o.reference)&&o.reference&&o.reference.contextElement&&(ne=ne.concat(kt(o.reference.contextElement)))),ne=ne.filter(Z=>{var ue;return Z!==((ue=K.defaultView)==null?void 0:ue.visualViewport)}),ne.forEach(Z=>{Z.addEventListener("scroll",Y,{passive:!0})}),()=>{l&&(K.removeEventListener("keydown",P?R:M,P),K.removeEventListener("compositionstart",q),K.removeEventListener("compositionend",X)),b&&K.removeEventListener(u,_?$:O,_),ne.forEach(Z=>{Z.removeEventListener("scroll",Y)}),window.clearTimeout(L)}},[i,o,l,b,u,n,r,p,s,S,A,M,P,R,O,_,$]),D.useEffect(()=>{g.current=!1},[b,u]);const T=D.useMemo(()=>({onKeyDown:M,...d&&{[Xd[f]]:L=>{r(!1,L.nativeEvent,"reference-press")},...f!=="click"&&{onClick(L){r(!1,L.nativeEvent,"reference-press")}}}}),[M,r,d,f]),j=D.useMemo(()=>({onKeyDown:M,onMouseDown(){x.current=!0},onMouseUp(){x.current=!0},[zd[u]]:()=>{g.current=!0}}),[M,u]);return D.useMemo(()=>s?{reference:T,floating:j}:{},[s,T,j])}function Gd(e){const{open:t=!1,onOpenChange:n,elements:r}=e,o=Wr(),i=D.useRef({}),[s]=D.useState(()=>Nd()),l=rs()!=null;if(process.env.NODE_ENV!=="production"){const h=r.reference;h&&!xe(h)&&Pd("Cannot pass a virtual element to the `elements.reference` option,","as it must be a real DOM element. Use `refs.setPositionReference()`","instead.")}const[c,u]=D.useState(r.reference),d=$t((h,m,v)=>{i.current.openEvent=h?m:void 0,s.emit("openchange",{open:h,event:m,reason:v,nested:l}),n==null||n(h,m,v)}),f=D.useMemo(()=>({setPositionReference:u}),[]),p=D.useMemo(()=>({reference:c||r.reference||null,floating:r.floating||null,domReference:r.reference}),[c,r.reference,r.floating]);return D.useMemo(()=>({dataRef:i,open:t,onOpenChange:d,elements:p,events:s,floatingId:o,refs:f}),[t,d,p,s,o,f])}function Jd(e){e===void 0&&(e={});const{nodeId:t}=e,n=Gd({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||n,o=r.elements,[i,s]=D.useState(null),[l,c]=D.useState(null),d=(o==null?void 0:o.domReference)||i,f=D.useRef(null),p=Qo();We(()=>{d&&(f.current=d)},[d]);const h=xd({...e,elements:{...o,...l&&{reference:l}}}),m=D.useCallback(x=>{const S=xe(x)?{getBoundingClientRect:()=>x.getBoundingClientRect(),contextElement:x}:x;c(S),h.refs.setReference(S)},[h.refs]),v=D.useCallback(x=>{(xe(x)||x===null)&&(f.current=x,s(x)),(xe(h.refs.reference.current)||h.refs.reference.current===null||x!==null&&!xe(x))&&h.refs.setReference(x)},[h.refs]),w=D.useMemo(()=>({...h.refs,setReference:v,setPositionReference:m,domReference:f}),[h.refs,v,m]),b=D.useMemo(()=>({...h.elements,domReference:d}),[h.elements,d]),g=D.useMemo(()=>({...h,...r,refs:w,elements:b,nodeId:t}),[h,w,b,t,r]);return We(()=>{r.dataRef.current.floatingContext=g;const x=p==null?void 0:p.nodesRef.current.find(S=>S.id===t);x&&(x.context=g)}),D.useMemo(()=>({...h,context:g,refs:w,elements:b}),[h,w,b,g])}const ws="active",xs="selected";function oi(e,t,n){const r=new Map,o=n==="item";let i=e;if(o&&e){const{[ws]:s,[xs]:l,...c}=e;i=c}return{...n==="floating"&&{tabIndex:-1,[ni]:""},...i,...t.map(s=>{const l=s?s[n]:null;return typeof l=="function"?e?l(e):null:l}).concat(e).reduce((s,l)=>(l&&Object.entries(l).forEach(c=>{let[u,d]=c;if(!(o&&[ws,xs].includes(u)))if(u.indexOf("on")===0){if(r.has(u)||r.set(u,[]),typeof d=="function"){var f;(f=r.get(u))==null||f.push(d),s[u]=function(){for(var p,h=arguments.length,m=new Array(h),v=0;v<h;v++)m[v]=arguments[v];return(p=r.get(u))==null?void 0:p.map(w=>w(...m)).find(w=>w!==void 0)}}}else s[u]=d}),s),{})}}function Zd(e){e===void 0&&(e=[]);const t=e.map(l=>l==null?void 0:l.reference),n=e.map(l=>l==null?void 0:l.floating),r=e.map(l=>l==null?void 0:l.item),o=D.useCallback(l=>oi(l,e,"reference"),t),i=D.useCallback(l=>oi(l,e,"floating"),n),s=D.useCallback(l=>oi(l,e,"item"),r);return D.useMemo(()=>({getReferenceProps:o,getFloatingProps:i,getItemProps:s}),[o,i,s])}const Qd=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]);function ep(e,t){var n;t===void 0&&(t={});const{open:r,floatingId:o}=e,{enabled:i=!0,role:s="dialog"}=t,l=(n=Qd.get(s))!=null?n:s,c=Wr(),d=rs()!=null,f=D.useMemo(()=>l==="tooltip"||s==="label"?{["aria-"+(s==="label"?"labelledby":"describedby")]:r?o:void 0}:{"aria-expanded":r?"true":"false","aria-haspopup":l==="alertdialog"?"dialog":l,"aria-controls":r?o:void 0,...l==="listbox"&&{role:"combobox"},...l==="menu"&&{id:c},...l==="menu"&&d&&{role:"menuitem"},...s==="select"&&{"aria-autocomplete":"none"},...s==="combobox"&&{"aria-autocomplete":"list"}},[l,o,d,r,c,s]),p=D.useMemo(()=>{const m={id:o,...l&&{role:l}};return l==="tooltip"||s==="label"?m:{...m,...l==="menu"&&{"aria-labelledby":c}}},[l,o,c,s]),h=D.useCallback(m=>{let{active:v,selected:w}=m;const b={role:"option",...v&&{id:o+"-option"}};switch(s){case"select":return{...b,"aria-selected":v&&w};case"combobox":return{...b,...v&&{"aria-selected":!0}}}return{}},[o,s]);return D.useMemo(()=>i?{reference:f,floating:p,item:h}:{},[i,f,p,h])}const Es=(e,t)=>{const{left:n,top:r,right:o,bottom:i}=e,s=t.getBoundingClientRect();return new DOMRect(n+s.left,r+s.top,o-n,i-r)},tp=e=>{var t;const n=pi(),{selected:r,event:o}=hi(),i=(t=r[0])==null?void 0:t.annotation,[s,l]=W.useState((r==null?void 0:r.length)>0),c=W.useRef(null),{refs:u,floatingStyles:d,update:f,context:p}=Jd({placement:$a()?"bottom":"top",open:s,onOpenChange:(g,x,S)=>{!g&&(S==="escape-key"||S==="focus-out")&&(l(g),n==null||n.cancelSelected())},middleware:[Rd(),Ad(10),Od({crossAxis:!0}),Sd({crossAxis:!0,padding:10}),Td({element:c})],whileElementsMounted:gd}),h=qd(p),m=ep(p,{role:"dialog"}),{getFloatingProps:v}=Zd([h,m]);W.useEffect(()=>{if(i!=null&&i.id){const g=n==null?void 0:n.state.store.getAnnotationBounds(i.id);l(!!g)}else l(!1)},[i==null?void 0:i.id,n==null?void 0:n.state.store]),W.useEffect(()=>{n&&(s&&(i!=null&&i.id)?u.setPositionReference({getBoundingClientRect:()=>{const g=n.state.store.getAnnotationBounds(i.id);return g?Es(g,n.element):new DOMRect},getClientRects:()=>{const x=n.state.store.getAnnotationRects(i.id).map(S=>Es(S,n.element));return $c(x)}}):u.setPositionReference(null))},[s,i==null?void 0:i.id,i==null?void 0:i.target,n]),W.useEffect(()=>{const g={attributes:!0,childList:!0,subtree:!0},x=new MutationObserver(()=>f());return x.observe(document.body,g),window.document.addEventListener("scroll",f,!0),()=>{x.disconnect(),window.document.removeEventListener("scroll",f,!0)}},[f]);const w=W.useMemo(()=>(o==null?void 0:o.type)==="keyup"||(o==null?void 0:o.type)==="contextmenu"||$a()?-1:0,[o]),b=()=>n==null?void 0:n.cancelSelected();return s&&i?pt.jsx(Yd,{children:pt.jsx(Kd,{context:p,modal:!1,closeOnFocusOut:!0,returnFocus:!1,initialFocus:w,children:pt.jsxs("div",{className:`a9s-popup r6o-popup annotation-popup r6o-text-popup ${mo}`,ref:u.setFloating,style:d,...v(np()),children:[e.popup({annotation:r[0].annotation,editable:r[0].editable,event:o}),e.arrow&&pt.jsx(jd,{ref:c,context:p,...e.arrowProps||{}}),pt.jsx("button",{className:"r6o-popup-sr-only","aria-live":"assertive",onClick:b,children:e.ariaCloseWarning||"Click or leave this dialog to close it."})]})})}):null},np=()=>({onPointerUp:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation()}),rp=e=>(W.useEffect(()=>{console.warn("TextAnnotatorPopup is deprecated and will be removed in a future version. Please use TextAnnotationPopup instead.")},[]),pt.jsx(tp,{...e}));for(var Me=[],ii=0;ii<256;++ii)Me.push((ii+256).toString(16).slice(1));function op(e,t=0){return(Me[e[t+0]]+Me[e[t+1]]+Me[e[t+2]]+Me[e[t+3]]+"-"+Me[e[t+4]]+Me[e[t+5]]+"-"+Me[e[t+6]]+Me[e[t+7]]+"-"+Me[e[t+8]]+Me[e[t+9]]+"-"+Me[e[t+10]]+Me[e[t+11]]+Me[e[t+12]]+Me[e[t+13]]+Me[e[t+14]]+Me[e[t+15]]).toLowerCase()}var Jr,ip=new Uint8Array(16);function ap(){if(!Jr&&(Jr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Jr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Jr(ip)}var sp=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const As={randomUUID:sp};function Ss(e,t,n){if(As.randomUUID&&!t&&!e)return As.randomUUID();e=e||{};var r=e.random||(e.rng||ap)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,op(r)}const Os=e=>e!=null&&e.startsWith("#")?e.substring(1):e,lp=e=>e?new Date(e):void 0,cp=e=>{const[t,n]=W.useState([]);W.useEffect(()=>{if(!e)return;const l=new DOMParser().parseFromString(e,"text/xml").querySelectorAll("TEI > standOff"),c=Array.from(l).reduce((u,d,f)=>{const p=l.length>1?`tei_standoff_${f+1}`:"tei_standoff",h={id:p,name:l.length>1?`TEI Standoff ${f+1}`:"TEI Standoff"},m=d.querySelectorAll("listAnnotation > annotation"),w=Array.from(m).map(b=>{const g=b.getAttribute("xml:id"),x=Array.from(b.querySelectorAll("revisionDesc > change")).map(O=>({who:Os(O.getAttribute("who")),when:lp(O.getAttribute("when")),status:O.getAttribute("status")})),S=Array.from(b.querySelectorAll("respStmt")).map(O=>({id:O.getAttribute("xml:id"),name:O.textContent})),A=Array.from(b.querySelectorAll("note")).map(O=>({text:O.textContent,responsible:S.find($=>$.id===Os(O.getAttribute("resp")))})),P=Array.from(b.querySelectorAll("rs[ana]")).reduce((O,$)=>[...O,...$.getAttribute("ana").split(" ")],[]),_=x.find(O=>O.status==="created"),C=x.find(O=>O.status==="modified"),[M,R]=b.getAttribute("target")?b.getAttribute("target").split(" "):[void 0,void 0];return{id:g,layer_id:p,target:{annotation:g,creator:_?S.find(O=>O.id===_.who):void 0,created:_==null?void 0:_.when,updatedBy:C?S.find(O=>O.id===C.who):void 0,updated:C==null?void 0:C.when,selector:M&&R?[{startSelector:{type:"XPathSelector",value:M},endSelector:{type:"XPathSelector",value:R}}]:void 0},bodies:[...A.map(O=>({id:Ss(),annotation:g,value:O.text,creator:O.responsible})),...P.map(O=>({id:Ss(),annotation:g,purpose:"tagging",value:O,creator:_?S.find($=>$.id===_.who):void 0}))]}}).filter(b=>b.target.selector);return[...u,{layer:h,annotations:w}]},[]);n(c)},[e]);const r=W.useMemo(()=>t.reduce((i,s)=>[...i,...s.annotations],[]),[t]);return{layers:W.useMemo(()=>t.map(i=>i.layer),[t]),annotations:r}};var Rs={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Ts=W.createContext&&W.createContext(Rs),up=["attr","size","title"];function fp(e,t){if(e==null)return{};var n=dp(e,t),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dp(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Zr(){return Zr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zr.apply(this,arguments)}function Cs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Qr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Cs(Object(n),!0).forEach(function(r){pp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cs(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function pp(e,t,n){return t=hp(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hp(e){var t=gp(e,"string");return typeof t=="symbol"?t:t+""}function gp(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ks(e){return e&&e.map((t,n)=>W.createElement(t.tag,Qr({key:n},t.attr),ks(t.child)))}function Et(e){return t=>W.createElement(mp,Zr({attr:Qr({},e.attr)},t),ks(e.child))}function mp(e){var t=n=>{var{attr:r,size:o,title:i}=e,s=fp(e,up),l=o||n.size||"1em",c;return n.className&&(c=n.className),e.className&&(c=(c?c+" ":"")+e.className),W.createElement("svg",Zr({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:c,style:Qr(Qr({color:e.color||n.color},n.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&W.createElement("title",null,i),e.children)};return Ts!==void 0?W.createElement(Ts.Consumer,null,n=>t(n)):t(Rs)}function vp(e){return Et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"},child:[]}]})(e)}function yp(e){return Et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"},child:[]}]})(e)}function eo(e){return Et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 80V229.5c0 17 6.7 33.3 18.7 45.3l176 176c25 25 65.5 25 90.5 0L418.7 317.3c25-25 25-65.5 0-90.5l-176-176c-12-12-28.3-18.7-45.3-18.7H48C21.5 32 0 53.5 0 80zm112 32a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"},child:[]}]})(e)}function Kn(e){return Et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"},child:[]}]})(e)}const bp=e=>{const[t,n]=W.useState([]),[r,o]=W.useState([]);return W.useEffect(()=>{const i=[],s=[];e.annotation.bodies.forEach(l=>{var c,u,d,f,p;if(l.purpose==="tagging")s.push({id:l.id,name:l.value||"Unknown",color:"green",quote:e.annotation.target.selector[0].quote,author:((c=l.creator)==null?void 0:c.name)||((u=e.annotation.target.creator)==null?void 0:u.name)||"Anonymous",annotation:"_no_annotation_"});else{const h=(d=l.value)==null?void 0:d.split(`
`);i.push({id:l.id,quote:e.annotation.target.selector[0].quote,annotation:h||[l.value||""],author:((f=l.creator)==null?void 0:f.name)||((p=e.annotation.target.creator)==null?void 0:p.name)||"Anonymous"})}}),n(i),o(s)},[e.annotation]),t.length>0||r.length>0?F.jsx("div",{className:"popover-wrapper",onClick:e.onClick,children:t.map((i,s)=>F.jsx("div",{className:"popover-content",children:F.jsx("table",{children:F.jsxs("tbody",{children:[s===0&&F.jsx("tr",{children:F.jsx("td",{className:"popover-annotated-text popover-truncate",colSpan:2,children:`...${i.quote}`})}),F.jsx("tr",{children:F.jsxs("td",{className:"popover-person-option",children:[F.jsx(Kn,{color:"#1e95e5"}),i.author]})}),F.jsx("tr",{children:F.jsx("div",{className:"popover-tag-row",children:r.map((l,c)=>F.jsxs("td",{className:"popover-category-option",children:[c===0&&F.jsx(eo,{color:l.color}),F.jsx("div",{className:"popover-tag",children:l.name})]},c))})}),F.jsx("tr",{children:F.jsx("td",{className:"popover-teaser",children:F.jsx("div",{className:"popover-annotation",children:i.annotation[0]==="_no_annotation_"?"":i.annotation.map((l,c)=>l.startsWith("http")&&[".jpg",".png"].includes(l.slice(-4))?F.jsx("img",{src:l,className:"popover-annotation-img",alt:"image in annotation"},c):l.startsWith("http")?F.jsx("a",{href:l,children:l},c):F.jsx("div",{className:"popover-annotation-line",children:l}))})})})]})})},i.id))}):F.jsx("div",{})};function wp(e){return Et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"},child:[]}]})(e)}function ai(e){return Et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zM124 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H124z"},child:[]}]})(e)}function $s(e){return Et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"},child:[]}]})(e)}function xp(e){return Et({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 64H192C85.961 64 0 149.961 0 256s85.961 192 192 192h192c106.039 0 192-85.961 192-192S490.039 64 384 64zM64 256c0-70.741 57.249-128 128-128 70.741 0 128 57.249 128 128 0 70.741-57.249 128-128 128-70.741 0-128-57.249-128-128zm320 128h-48.905c65.217-72.858 65.236-183.12 0-256H384c70.741 0 128 57.249 128 128 0 70.74-57.249 128-128 128z"},child:[]}]})(e)}function Ep(e){return Et({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 64H192C86 64 0 150 0 256s86 192 192 192h192c106 0 192-86 192-192S490 64 384 64zm0 320c-70.8 0-128-57.3-128-128 0-70.8 57.3-128 128-128 70.8 0 128 57.3 128 128 0 70.8-57.3 128-128 128z"},child:[]}]})(e)}const Ap=e=>F.jsx("div",{className:"header-tabs",children:F.jsxs("ul",{children:[F.jsx("li",{className:"header-adjust active",onClick:()=>e.onAdjust(!e.adjust),children:F.jsx(wp,{size:20,color:e.adjust?"#1b6c7a":void 0})}),F.jsx("li",{className:e.activeTab==="annotations"?"active":void 0,onClick:()=>e.onSetActiveTab("annotations"),children:"Annotations"}),F.jsx("li",{className:e.activeTab==="filters"?"active":void 0,onClick:()=>e.onSetActiveTab("filters"),children:"Filters"})]})}),Sp=({opened:e,annotation:t,adjust:n,filtered:r,filters:o,onClickClose:i,onClickOpen:s,onAdjust:l,onToggleTagFilter:c,onToggleAuthorFilter:u})=>{var x,S;const[d,f]=W.useState("annotations"),[p,h]=W.useState(),[m,v]=W.useState();W.useEffect(()=>{v(void 0),h(void 0)},[r]);const w=A=>{l(A)},b=[];t==null||t.bodies.forEach(A=>{A.purpose==="tagging"&&b.push(A.value||"Unknown")});const g=r.authors.length>0||r.tags.length>0;return F.jsx("div",{className:`wrapper ${e?"visible":""}`,children:F.jsxs("aside",{className:`sidebar ${e?"opened":""}`,children:[F.jsx(Ap,{activeTab:d,adjust:n,onSetActiveTab:f,onAdjust:w}),F.jsxs("div",{className:"sidebar-background",children:[F.jsx("div",{className:"sidebar-handle",onClick:e?()=>i():()=>s(),children:e?F.jsx(yp,{size:35}):F.jsx(vp,{size:35})}),d==="annotations"?F.jsxs(F.Fragment,{children:[F.jsxs("div",{className:"sidebar-header",children:[t?F.jsxs("div",{className:b.length>0?"sidebar-author third":"sidebar-author",children:[F.jsx(Kn,{color:"#1e95e5"}),((x=t.bodies[0].creator)==null?void 0:x.name)||((S=t.target.creator)==null?void 0:S.name)]}):F.jsx("div",{className:"sidebar-header-spacer"}),b.length>0&&F.jsx("div",{className:"sidebar-tag-container",children:b.map((A,P)=>F.jsxs("div",{className:"sidebar-tag-sub-container",children:[P===0&&F.jsx(eo,{color:"green",style:{paddingRight:5}}),F.jsx("div",{className:"sidebar-tag",children:A})]},P))})]}),F.jsxs("div",{className:"sidebar-content",children:[t?F.jsx("div",{className:"sidebar-quote",children:`"${t.target.selector[0].quote}"`}):F.jsx("div",{className:"sidebar-content-empty",children:"Annotation Details"}),F.jsx("div",{className:"sidebar-annotation",children:t&&t.bodies[0]?t.bodies.map((A,P)=>{var _,C,M;if(A.purpose!=="tagging"){const R=(_=A.value)==null?void 0:_.split(`
`);return F.jsxs("div",{children:[P!==0&&F.jsxs("div",{className:"sidebar-annotation-extra-author",children:[F.jsx(Kn,{color:"#1e95e5"}),F.jsx("div",{children:((C=A.creator)==null?void 0:C.name)||((M=t.target.creator)==null?void 0:M.name)})]}),(R||[]).map((O,$)=>O.startsWith("http")&&[".jpg",".png"].includes(O.slice(-4))?F.jsx("img",{src:O,className:"popover-annotation-img",alt:"image in annotation"},$):O.startsWith("http")?F.jsx("a",{href:O,children:O},P):F.jsx("div",{className:"sidebar-annotation-anno",children:O},$))]},A.id)}else return F.jsx("div",{},A.id)}):"Select an annotation, or click the 'filters' tab above to filter the document."})]})]}):F.jsxs("div",{className:"sidebar-filters",children:[F.jsxs("div",{className:g?"sidebar-filter-header":"sidebar-filter-header sidebar-filter-header-active",children:[F.jsxs("div",{className:"sidebar-filter-header-toggle",children:[g?F.jsx(Ep,{size:24}):F.jsx(xp,{size:24}),F.jsx("div",{className:"sidebar-filter-toggle-text",children:g?"Filter: ON":"Filter: OFF"})]}),F.jsx("div",{className:"sidebar-filter-header-divider"}),r.tags.map(A=>F.jsxs("div",{className:"sidebar-filter-option",onClick:()=>c(A),onMouseEnter:()=>h(A),onMouseLeave:()=>h(void 0),children:[p===A?F.jsx(ai,{color:"red",style:{paddingRight:5}}):F.jsx(eo,{color:"green",style:{paddingRight:5}}),A]},A)),r.authors.map(A=>F.jsxs("div",{className:"sidebar-filter-option",onClick:()=>u(A),onMouseEnter:()=>v(A),onMouseLeave:()=>v(void 0),children:[m===A?F.jsx(ai,{color:"red",style:{paddingRight:5}}):F.jsx(Kn,{color:"#1e95e5",style:{paddingRight:5}}),A]},A))]}),F.jsxs("div",{className:"sidebar-filter-tag-set",children:["Tags:",F.jsx("div",{className:"sidebar-filter-tags",children:o.tags.map(A=>r.tags.includes(A)?F.jsx("div",{}):F.jsxs("div",{className:"sidebar-filter-option",onClick:()=>c(A),onMouseEnter:()=>h(A),onMouseLeave:()=>h(void 0),children:[p===A?r.tags.includes(A)?F.jsx(ai,{color:"red",style:{paddingRight:5}}):F.jsx($s,{color:"green",style:{paddingRight:5}}):F.jsx(eo,{color:"green",style:{paddingRight:5}}),A]},A))})]}),F.jsxs("div",{className:"sidebar-filter-tag-set",children:["People:",F.jsx("div",{className:"sidebar-filter-tags",children:o.authors.map(A=>r.authors.includes(A)?F.jsx("div",{}):F.jsxs("div",{className:"sidebar-filter-option",onClick:()=>u(A),onMouseEnter:()=>v(A),onMouseLeave:()=>v(void 0),children:[m===A?F.jsx($s,{color:"green",style:{paddingRight:5}}):F.jsx(Kn,{color:"#1e95e5",style:{paddingRight:5}}),A]},A))})]})]})]})]})})},Op=()=>{const e="0123456789ABCDEF";let t="#";for(let n=0;n<6;n++)t+=e[Math.floor(Math.random()*16)];return t},Rp=e=>{const{annotation:t}=e;return t.bodies.length>0?F.jsx("div",{className:"popup popup-overrides",children:t.bodies.length>0&&F.jsx(bp,{annotation:e.selection,onClick:e.onClick})}):F.jsx("div",{})},Tp=e=>{const[t,n]=W.useState(),[r,o]=W.useState(!1),[i,s]=W.useState(!1),[l,c]=W.useState(),[u,d]=W.useState({tags:[],authors:[]}),f=pi(),p=hi(),{annotations:h}=cp(t||""),m=W.useMemo(()=>{const P={tags:[],authors:[]};return l&&(P.tags=Object.keys(l.tags),P.authors=Object.keys(l.annotationAuthors)),P},[l]);W.useEffect(()=>{const P=()=>{const _={tags:{},annotationAuthors:{},annotationTags:{},tagAnnotations:{},annotations:{}};return e.config.tagVocabulary.forEach(C=>{_.tags[C.tagName]=C.tagColor}),h.forEach(C=>{_.annotations[C.id]=C,C.bodies.forEach(M=>{var R,O,$,T;(R=M.creator)!=null&&R.name&&(_.annotationAuthors[(O=M.creator)==null?void 0:O.name]||(_.annotationAuthors[($=M.creator)==null?void 0:$.name]=[]),_.annotationAuthors[(T=M.creator)==null?void 0:T.name].push(C.id)),M.purpose==="tagging"&&M.value&&(_.annotationTags[M.value]||(_.annotationTags[M.value]=[]),_.tagAnnotations[C.id]||(_.tagAnnotations[C.id]=[]),_.annotationTags[M.value].push(C.id),_.tagAnnotations[C.id].push(M.value),_.tags[M.value]||(_.tags[M.value]=Op()))})}),_};f&&h.length>0&&(f.setAnnotations(h,!0),c(P()))},[f,h,e.config]),W.useEffect(()=>{if(f&&h.length>0&&l)if(u.authors.length===0&&u.tags.length===0)f.setAnnotations(h,!0);else{let P=[];if(u.authors.length===0?Object.keys(l.annotationAuthors).forEach(_=>{l.annotationAuthors[_]&&(P=[...P,...l.annotationAuthors[_]])}):u.authors.forEach(_=>{l.annotationAuthors[_]&&(P=[...P,...l.annotationAuthors[_]])}),u.tags.length>0){let _=[];u.tags.forEach(C=>{l.annotationTags[C]&&(_=[..._,...l.annotationTags[C]])}),P=P.filter(C=>_.includes(C))}f.setAnnotations(h.filter(_=>P.includes(_.id)),!0)}},[u,f,h,l]),W.useEffect(()=>{fetch(e.config.teiUrl).then(P=>P.text()).then(P=>{n(P)})},[e.config.teiUrl]);const v=(P,_)=>{let C="#feef3d";if(l){const M=l.tagAnnotations[P.id];M&&(C=l.tags[M[0]])}return{fill:i?"#AAAAAA33":C,fillOpacity:_!=null&&_.selected?.75:.5}},w=()=>{o(!0)},b=()=>{o(!0)},g=()=>{o(!1)},x=P=>{s(P)},S=P=>{const _=JSON.parse(JSON.stringify(u)),C=_.tags.findIndex(M=>M===P);C>-1?_.tags.splice(C,1):_.tags.push(P),d(_)},A=P=>{const _=JSON.parse(JSON.stringify(u)),C=_.authors.findIndex(M=>M===P);C>-1?_.authors.splice(C,1):_.authors.push(P),d(_)};return F.jsxs("div",{className:"anno-view",children:[F.jsx("div",{className:"anno-desktop ",children:F.jsxs("div",{className:"content-wrapper-2",children:[F.jsx(sf,{annotatingEnabled:!1,style:v,children:F.jsx(Kl,{tei:t})}),F.jsx(rp,{popup:P=>F.jsx(Rp,{onClick:w,selection:p.selected[0].annotation,...P})})]})}),F.jsx(Sp,{opened:r,adjust:i,filtered:u,filters:m,onClickClose:g,onClickOpen:b,annotation:p.selected[0]?p.selected[0].annotation:void 0,onAdjust:x,onToggleTagFilter:S,onToggleAuthorFilter:A})]})},Cp=e=>F.jsx(Fs,{children:F.jsx(Tp,{config:e.config})});At.CoveEdition=Cp,Object.defineProperty(At,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.umd.js.map

{"version":3,"file":"react-text-annotator.es2.js","sources":["../src/tei/CETEIcean.tsx"],"sourcesContent":["import { useEffect, useRef } from 'react';\nimport CETEI from 'CETEIcean';\n\ninterface CETEIceanProps {\n\n  initArgs?: any;\n\n  tei?: string;\n\n  onLoad?(element: Element): void;\n\n  behaviors?: any;\n\n}\n\n// Override default list, note, table, and ref behaviors \n// so they don't introduce text into the DOM that interferes\n// with annotation. Apply a patch to graphics for robustness.\nconst PRESET_BEHAVIORS = {\n  tei: {\n    ref: (elem: Element) => {\n      const a = document.createElement('a');\n\n      while(elem.firstChild) {\n        a.appendChild(elem.removeChild(elem.firstChild));\n      }\n\n      a.setAttribute('href', elem.getAttribute('target'));\n\n      elem.appendChild(a);\n    },\n    // Cf. https://github.com/TEIC/CETEIcean/issues/67\n    graphic: (elem: Element) => {\n      const content = new Image();\n      content.src = elem.getAttribute('url')?.trim();\n\n      if (elem.hasAttribute('width'))\n        content.setAttribute('width', elem.getAttribute('width'));\n\n      if (elem.hasAttribute('height'))\n        content.setAttribute('height', elem.getAttribute('height'));\n\n      elem.appendChild(content);\n    },\n    list: null,\n    note: null,\n    table: null,\n    teiHeader: (elem: HTMLElement) => {\n      elem.hidden = true;\n    }\n  }\n}\n\nexport const CETEIcean = (props: CETEIceanProps) => {\n\n  const el = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (props.tei) {\n      const ceteicean = new CETEI(props.initArgs);\n\n      ceteicean.addBehaviors({\n        ...PRESET_BEHAVIORS,\n        ...(props.behaviors || {}),\n        tei: {\n          ...PRESET_BEHAVIORS.tei,\n          ...(props.behaviors?.tei || {})\n        }\n      });\n\n      ceteicean.makeHTML5(props.tei, (data: Element) => {\n        el.current.appendChild(data);\n        props.onLoad(el.current);\n      });\n    }\n\n    return () => {\n      el.current.innerHTML = '';\n    }\n  }, [props.tei, JSON.stringify(props.initArgs), props.onLoad]);\n\n  return (\n    <div \n      ref={el}\n      className=\"tei-container\" />\n  )\n\n}"],"names":["jsx"],"mappings":";;;AAkBA,MAAM,mBAAmB;AAAA,EACvB,KAAK;AAAA,IACH,KAAK,CAAC,SAAkB;AAChB,YAAA,IAAI,SAAS,cAAc,GAAG;AAEpC,aAAM,KAAK,YAAY;AACrB,UAAE,YAAY,KAAK,YAAY,KAAK,UAAU,CAAC;AAAA,MAAA;AAGjD,QAAE,aAAa,QAAQ,KAAK,aAAa,QAAQ,CAAC;AAElD,WAAK,YAAY,CAAC;AAAA,IACpB;AAAA;AAAA,IAEA,SAAS,CAAC,SAAkB;;AACpB,YAAA,UAAU,IAAI,MAAM;AAC1B,cAAQ,OAAM,UAAK,aAAa,KAAK,MAAvB,mBAA0B;AAEpC,UAAA,KAAK,aAAa,OAAO;AAC3B,gBAAQ,aAAa,SAAS,KAAK,aAAa,OAAO,CAAC;AAEtD,UAAA,KAAK,aAAa,QAAQ;AAC5B,gBAAQ,aAAa,UAAU,KAAK,aAAa,QAAQ,CAAC;AAE5D,WAAK,YAAY,OAAO;AAAA,IAC1B;AAAA,IACA,MAAM;AAAA,IACN,MAAM;AAAA,IACN,OAAO;AAAA,IACP,WAAW,CAAC,SAAsB;AAChC,WAAK,SAAS;AAAA,IAAA;AAAA,EAChB;AAEJ;AAEa,MAAA,YAAY,CAAC,UAA0B;AAE5C,QAAA,KAAK,OAAuB,IAAI;AAEtC,YAAU,MAAM;;AACd,QAAI,MAAM,KAAK;AACb,YAAM,YAAY,IAAI,MAAM,MAAM,QAAQ;AAE1C,gBAAU,aAAa;AAAA,QACrB,GAAG;AAAA,QACH,GAAI,MAAM,aAAa,CAAC;AAAA,QACxB,KAAK;AAAA,UACH,GAAG,iBAAiB;AAAA,UACpB,KAAI,WAAM,cAAN,mBAAiB,QAAO,CAAA;AAAA,QAAC;AAAA,MAC/B,CACD;AAED,gBAAU,UAAU,MAAM,KAAK,CAAC,SAAkB;AAC7C,WAAA,QAAQ,YAAY,IAAI;AACrB,cAAA,OAAO,GAAG,OAAO;AAAA,MAAA,CACxB;AAAA,IAAA;AAGH,WAAO,MAAM;AACX,SAAG,QAAQ,YAAY;AAAA,IACzB;AAAA,EAAA,GACC,CAAC,MAAM,KAAK,KAAK,UAAU,MAAM,QAAQ,GAAG,MAAM,MAAM,CAAC;AAG1D,SAAAA,kCAAA;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAK;AAAA,MACL,WAAU;AAAA,IAAA;AAAA,EAAgB;AAGhC;"}
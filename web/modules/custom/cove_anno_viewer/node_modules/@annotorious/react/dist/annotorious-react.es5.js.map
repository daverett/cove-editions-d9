{"version":3,"file":"annotorious-react.es5.js","sources":["../src/ImageAnnotator.tsx"],"sourcesContent":["import { Children, ReactElement, cloneElement, useContext, useEffect } from 'react';\nimport { AnnotoriousOpts, createImageAnnotator } from '@annotorious/annotorious';\nimport type { DrawingTool, Filter, ImageAnnotation } from '@annotorious/annotorious';\nimport { AnnotoriousContext } from './Annotorious';\n\nexport interface ImageAnnotatorProps<E extends unknown> extends AnnotoriousOpts<ImageAnnotation, E> {\n\n  children: ReactElement<HTMLImageElement>;\n\n  containerClassName?: string;\n\n  filter?: Filter<ImageAnnotation>;\n\n  tool?: DrawingTool;\n\n}\n\nexport const ImageAnnotator = <E extends unknown>(props: ImageAnnotatorProps<E>) => {\n\n  const { children, tool, ...opts } = props;\n\n  const child = Children.only(children);\n\n  const { anno, setAnno } = useContext(AnnotoriousContext);\n\n  const onLoad = (evt: Event) => {\n    if (!anno) {\n      const img = evt.target as HTMLImageElement;\n\n      const next = createImageAnnotator(img, opts);\n      setAnno(next); \n    }\n  };\n\n  useEffect(() => {\n    if (!anno || !props.containerClassName) return;\n    anno.element.className = props.containerClassName;\n  }, [props.containerClassName, anno]);\n\n  useEffect(() => {\n    if (anno) anno.setDrawingEnabled(props.drawingEnabled);\n  }, [props.drawingEnabled]);\n\n  useEffect(() => {\n    if (anno) anno.setFilter(props.filter);\n  }, [props.filter]);\n\n  useEffect(() => {\n    if (anno) anno.setStyle(props.style);\n  }, [props.style]);\n\n  useEffect(() => {\n    if (tool && anno) anno.setDrawingTool(props.tool);\n  }, [tool, anno]);\n\n  useEffect(() => {\n    if (anno) anno.setUserSelectAction(props.userSelectAction);\n  }, [props.userSelectAction]);\n \n  return <>{cloneElement(child, { onLoad }  as Partial<HTMLImageElement>)}</>\n\n}\n"],"names":["ImageAnnotator","props","children","tool","opts","child","Children","anno","setAnno","useContext","AnnotoriousContext","onLoad","evt","img","next","createImageAnnotator","useEffect","cloneElement"],"mappings":";;;;AAiBa,MAAAA,IAAiB,CAAoBC,MAAkC;AAElF,QAAM,EAAE,UAAAC,GAAU,MAAAC,GAAM,GAAGC,EAAS,IAAAH,GAE9BI,IAAQC,EAAS,KAAKJ,CAAQ,GAE9B,EAAE,MAAAK,GAAM,SAAAC,MAAYC,EAAWC,CAAkB,GAEjDC,IAAS,CAACC,MAAe;AAC7B,QAAI,CAACL,GAAM;AACT,YAAMM,IAAMD,EAAI,QAEVE,IAAOC,EAAqBF,GAAKT,CAAI;AAC3C,MAAAI,EAAQM,CAAI;AAAA,IAAA;AAAA,EAEhB;AAEA,SAAAE,EAAU,MAAM;AACd,IAAI,CAACT,KAAQ,CAACN,EAAM,uBACfM,EAAA,QAAQ,YAAYN,EAAM;AAAA,EAC9B,GAAA,CAACA,EAAM,oBAAoBM,CAAI,CAAC,GAEnCS,EAAU,MAAM;AACd,IAAIT,KAAMA,EAAK,kBAAkBN,EAAM,cAAc;AAAA,EAAA,GACpD,CAACA,EAAM,cAAc,CAAC,GAEzBe,EAAU,MAAM;AACd,IAAIT,KAAMA,EAAK,UAAUN,EAAM,MAAM;AAAA,EAAA,GACpC,CAACA,EAAM,MAAM,CAAC,GAEjBe,EAAU,MAAM;AACd,IAAIT,KAAMA,EAAK,SAASN,EAAM,KAAK;AAAA,EAAA,GAClC,CAACA,EAAM,KAAK,CAAC,GAEhBe,EAAU,MAAM;AACd,IAAIb,KAAQI,KAAWA,EAAA,eAAeN,EAAM,IAAI;AAAA,EAAA,GAC/C,CAACE,GAAMI,CAAI,CAAC,GAEfS,EAAU,MAAM;AACd,IAAIT,KAAMA,EAAK,oBAAoBN,EAAM,gBAAgB;AAAA,EAAA,GACxD,CAACA,EAAM,gBAAgB,CAAC,uCAEjB,UAAagB,EAAAZ,GAAO,EAAE,QAAAM,EAAsC,CAAA,GAAE;AAE1E;"}